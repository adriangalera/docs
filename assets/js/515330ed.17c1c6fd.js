"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[403],{8453:(e,n,i)=>{i.d(n,{R:()=>a,x:()=>o});var s=i(6540);const t={},r=s.createContext(t);function a(e){const n=s.useContext(r);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:a(e.components),s.createElement(r.Provider,{value:n},e.children)}},9251:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>a,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"Hacking/HTB Academy/Web fuzzing","title":"Web fuzzing","description":"Web fuzzing is a critical technique in web application security to identify vulnerabilities by testing various inputs","source":"@site/docs/Hacking/HTB Academy/Web fuzzing.md","sourceDirName":"Hacking/HTB Academy","slug":"/Hacking/HTB Academy/Web fuzzing","permalink":"/docs/Hacking/HTB Academy/Web fuzzing","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"SQL injections","permalink":"/docs/Hacking/HTB Academy/SQL injections"},"next":{"title":"Windows fundamentals","permalink":"/docs/Hacking/HTB Academy/Windows fundamentals"}}');var t=i(4848),r=i(8453);const a={},o="Web fuzzing",l={},c=[{value:"Fuzzing files and directories",id:"fuzzing-files-and-directories",level:2},{value:"Fuzzing recursively",id:"fuzzing-recursively",level:2},{value:"Parameter and value fuzzing",id:"parameter-and-value-fuzzing",level:2},{value:"Fuzzing virtual host and subdomains.",id:"fuzzing-virtual-host-and-subdomains",level:2},{value:"Filtering results",id:"filtering-results",level:2},{value:"Validate your findings",id:"validate-your-findings",level:2},{value:"Fuzzing Web APIs",id:"fuzzing-web-apis",level:2},{value:"Representational State Transfer (REST)",id:"representational-state-transfer-rest",level:3},{value:"Simple Object Access Protocol (SOAP)",id:"simple-object-access-protocol-soap",level:3},{value:"GraphQL",id:"graphql",level:3},{value:"Identifying endpoints",id:"identifying-endpoints",level:2},{value:"API Fuzzing",id:"api-fuzzing",level:2},{value:"Skills assessment",id:"skills-assessment",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"web-fuzzing",children:"Web fuzzing"})}),"\n",(0,t.jsx)(n.p,{children:"Web fuzzing is a critical technique in web application security to identify vulnerabilities by testing various inputs"}),"\n",(0,t.jsx)(n.p,{children:"Fuzzing casts a wider net. It involves feeding the web application with unexpected inputs, including malformed data, invalid characters, and nonsensical combinations. Brute-forcing, on the other hand, is a more targeted approach. It focuses on systematically trying out many possibilities for a specific value, such as a password or an ID number."}),"\n",(0,t.jsx)(n.p,{children:"Let's define some concepts first:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Wordlist: A dictionary or list of words, phrases, file names, directory names, or parameter values used as input during fuzzing."}),"\n",(0,t.jsx)(n.li,{children:"Payload: The actual data sent to the web application during fuzzing. Can be a simple string, numerical value, or complex data structure."}),"\n",(0,t.jsx)(n.li,{children:"Response analysis: Examining the web application's responses (e.g., response codes, error messages) to the fuzzer's payloads to identify anomalies that might indicate vulnerabilities."}),"\n",(0,t.jsx)(n.li,{children:"Fuzzer: A software tool that automates generating and sending payloads to a web application and analyzing the responses."}),"\n",(0,t.jsx)(n.li,{children:"False positive: result incorrectly labeled as vulnerability."}),"\n",(0,t.jsx)(n.li,{children:"False negative: A vulnerability that exists in the web application but is not detected by the fuzzer."}),"\n",(0,t.jsx)(n.li,{children:"Fuzzing Scope: the part of the application under the fuzzing effort."}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Some tools:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["FFUF (Fuzz Faster U Fool). Use cases:","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Directory and File Enumeration"}),"\n",(0,t.jsx)(n.li,{children:"Parameter Discovery"}),"\n",(0,t.jsx)(n.li,{children:"Brute-Force Attack"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["Gobuster. Use cases:","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Content Discovery"}),"\n",(0,t.jsx)(n.li,{children:"DNS Subdomain enumeration"}),"\n",(0,t.jsx)(n.li,{children:"Wordpress content detection"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:['FeroxBuster. Designed for brute-force discovery of unlinked content in web applications, making it particularly useful for identifying hidden directories and files. It\'s more of a "forced browsing" tool than a fuzzer like ffuf. Use cases:',"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Recursive Scanning"}),"\n",(0,t.jsx)(n.li,{children:"Unlinked Content Discovery"}),"\n",(0,t.jsx)(n.li,{children:"High-Performance Scans"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["wfuzz/wenum. Use cases:","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Directory and File Enumeration"}),"\n",(0,t.jsx)(n.li,{children:"Parameter Discovery"}),"\n",(0,t.jsx)(n.li,{children:"Brute-Force Attack"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"fuzzing-files-and-directories",children:"Fuzzing files and directories"}),"\n",(0,t.jsx)(n.p,{children:"You can use a wordlist and try to make requests to the server and see if some is positive (200 OK) or any other desired state. The key here is to find a related wordlist."}),"\n",(0,t.jsx)(n.p,{children:"See some examples:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'ffuf -ic -w /opt/github/SecLists/Discovery/Web-Content/DirBuster-2007_directory-list-lowercase-2.3-small.txt:FUFF -u "http://94.237.59.213:58567/FUFF"\n'})}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"FUFF"})," keyword is where the word from the word list will be injected."]}),"\n",(0,t.jsxs)(n.p,{children:["If you want to use ",(0,t.jsx)(n.code,{children:"-e"})," flag to setup the extension, you don't need to place the ",(0,t.jsx)(n.code,{children:"FUFF"})," in the word list, e.g:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'ffuf -c -ic -w /opt/github/SecLists/Discovery/Web-Content/common.txt -u "http://94.237.59.213:58567/webfuzzing_hidden_path/flag/FUZZ" -e .html\n'})}),"\n",(0,t.jsx)(n.h2,{id:"fuzzing-recursively",children:"Fuzzing recursively"}),"\n",(0,t.jsx)(n.p,{children:"What if our target has a complex structure with multiple nested directories? Manually fuzzing each level would be tedious and time-consuming. This is where recursive fuzzing comes in handy."}),"\n",(0,t.jsx)(n.p,{children:"Recursive fuzzing consist in 3 steps:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"Initial fuzzing: same as we've seen so far."}),"\n",(0,t.jsx)(n.li,{children:"For each discovered directory, the fuzzer adds the discovered URL to the queue."}),"\n",(0,t.jsx)(n.li,{children:"Iterative depth: the processes is repeated for each directory until a specified depth has been scanned."}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"fuff"})," example:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"ffuf -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -ic -v -u http://IP:PORT/FUZZ -e .html -recursion \n"})}),"\n",(0,t.jsx)(n.p,{children:"When fuzzing recursively, it is wise to set up some limits:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"-recursion-depth"}),": This flag allows you to set a maximum depth for recursive exploration. For example, -recursion-depth 2 limits fuzzing to two levels deep (the starting directory and its immediate subdirectories)."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"-rate"}),": You can control the rate at which ffuf sends requests per second, preventing the server from being overloaded."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"-timeout"}),": This option sets the timeout for individual requests, helping to prevent the fuzzer from hanging on unresponsive targets."]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"e.g:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'ffuf -c -ic -w /opt/github/SecLists/Discovery/Web-Content/DirBuster-2007_directory-list-2.3-small.txt:FUZZ -u "http://94.237.59.213:45870/recursive_fuzz/FUZZ" -recursion -recursion-depth 4\n'})}),"\n",(0,t.jsx)(n.h2,{id:"parameter-and-value-fuzzing",children:"Parameter and value fuzzing"}),"\n",(0,t.jsx)(n.p,{children:"This technique focuses on manipulating the parameters and their values within web requests to uncover vulnerabilities in how the application processes input."}),"\n",(0,t.jsx)(n.p,{children:"Parameters are the gateways through which you can interact with a web application. By manipulating their values, you can test how the application responds to different inputs, potentially uncovering vulnerabilities. For instance:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Altering a product ID in a shopping cart URL could reveal pricing errors or unauthorized access to other users' orders."}),"\n",(0,t.jsx)(n.li,{children:"Modifying a hidden parameter in a request might unlock hidden features or administrative functions."}),"\n",(0,t.jsx)(n.li,{children:"Injecting malicious code into a search query could expose vulnerabilities like Cross-Site Scripting (XSS) or SQL Injection (SQLi)."}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"We can fuzz the existence of the parameter itself and the value of the parameters. For example, we make a request with curl:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"adriangalera@htb[/htb]$ curl http://IP:PORT/get.php\n\nInvalid parameter value\nx:\n"})}),"\n",(0,t.jsxs)(n.p,{children:["We have discovered that this application need a parameter ",(0,t.jsx)(n.code,{children:"x"}),". If we set it manually to 1:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"adriangalera@htb[/htb]$ curl http://IP:PORT/get.php?x=1\n\nInvalid parameter value\nx: 1\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Now, we can use ",(0,t.jsx)(n.code,{children:"wenum"})," to discover the correct values:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'wenum -w /usr/share/seclists/Discovery/Web-Content/common.txt --hc 404 -u "http://IP:PORT/get.php?x=FUZZ"\n'})}),"\n",(0,t.jsx)(n.p,{children:"The same technique can be applied to POST requests:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'curl -d "" http://IP:PORT/post.php\n\nInvalid parameter value\ny: \n'})}),"\n",(0,t.jsxs)(n.p,{children:["And we can fuzz the valid values with ",(0,t.jsx)(n.code,{children:"fuff"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'ffuf -u http://IP:PORT/post.php -X POST -H "Content-Type: application/x-www-form-urlencoded" -d "y=FUZZ" -w /usr/share/seclists/Discovery/Web-Content/common.txt -mc 200 -v\n'})}),"\n",(0,t.jsx)(n.p,{children:"For the exercise, we can get the correct GET parameter value calling:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'ffuf -ic -w /opt/github/SecLists/Discovery/Web-Content/big.txt:FUZZ -u "http://94.237.54.192:53037/get.php?x=FUZZ"\n'})}),"\n",(0,t.jsx)(n.p,{children:"and POST calling:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'ffuf -u http://94.237.54.192:53037/post.php -X POST -H "Content-Type: application/x-www-form-urlencoded" -d "y=FUZZ" -w /opt/github/SecLists/Discovery/Web-Content/common.txt:FUZZ  -mc 200 -v\n'})}),"\n",(0,t.jsx)(n.h2,{id:"fuzzing-virtual-host-and-subdomains",children:"Fuzzing virtual host and subdomains."}),"\n",(0,t.jsx)(n.p,{children:"Virtual hosting enables multiple websites or domains to be served from a single server or IP address. Each vhost is associated with a unique domain name or hostname. When a client sends an HTTP request, the web server examines the Host header to determine which vhost's content to deliver."}),"\n",(0,t.jsx)(n.p,{children:"Subdomains, on the other hand, are extensions of a primary domain name, creating a hierarchical structure within the domain. They are used to organize different sections or services within a website. For example, blog.example.com and shop.example.com are subdomains of the main domain example.com. Unlike vhosts, subdomains are resolved to specific IP addresses through DNS (Domain Name System) records."}),"\n",(0,t.jsxs)(n.p,{children:["We can use ",(0,t.jsx)(n.code,{children:"gobuster"})," to perform vhost fuzzing:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"gobuster vhost -u http://inlanefreight.htb:81 -w /usr/share/seclists/Discovery/Web-Content/common.txt --append-domain\n"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"--append-domain"}),": This crucial flag instructs Gobuster to append the base domain (inlanefreight.htb) to each word in the wordlist. This ensures that the Host header in each request includes a complete domain name (e.g., admin.inlanefreight.htb), which is essential for vhost discovery."]}),"\n",(0,t.jsxs)(n.p,{children:["To perform sub-domain fuzzing is very similar, but you need to change the mode of ",(0,t.jsx)(n.code,{children:"gobuster"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"gobuster dns -do inlanefreight.com -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt\n"})}),"\n",(0,t.jsx)(n.p,{children:"Under the hood, Gobuster works by generating subdomain names based on the wordlist, appending them to the target domain, and then attempting to resolve those subdomains using DNS queries. If a subdomain resolves to an IP address, it is considered valid and included in the output."}),"\n",(0,t.jsx)(n.h2,{id:"filtering-results",children:"Filtering results"}),"\n",(0,t.jsx)(n.p,{children:"Most of the fuzzing attemps will lead to nowhere and we'll need to filter out that noise. Each tool has its own filter mechanism."}),"\n",(0,t.jsx)(n.p,{children:"The idea is that you can filter by:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Response HTTP status code"}),"\n",(0,t.jsx)(n.li,{children:"Response content length"}),"\n",(0,t.jsx)(n.li,{children:"Response line counts"}),"\n",(0,t.jsx)(n.li,{children:"Response word counts"}),"\n",(0,t.jsx)(n.li,{children:"Response time (TTFB)"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"validate-your-findings",children:"Validate your findings"}),"\n",(0,t.jsx)(n.p,{children:"Once you found out a file, a directory, a vhost, etc... The fact that you found it, it doesn't matter it's a vulnerability automatically."}),"\n",(0,t.jsx)(n.p,{children:"For example, if you suspect a SQL injection vulnerability, you could craft a harmless SQL query that returns the SQL server version string rather than trying to extract or modify sensitive data."}),"\n",(0,t.jsxs)(n.p,{children:["Or you can use ",(0,t.jsx)(n.code,{children:"curl"})," to verify the request of the response, see if there's data and what kind of data will come in the answer."]}),"\n",(0,t.jsx)(n.h2,{id:"fuzzing-web-apis",children:"Fuzzing Web APIs"}),"\n",(0,t.jsx)(n.p,{children:"Essentially, a Web API serves as a bridge between a server (hosting the data and functionality) and a client (such as a web browser, mobile app, or another server) that wants to access or utilize that data or functionality."}),"\n",(0,t.jsx)(n.h3,{id:"representational-state-transfer-rest",children:"Representational State Transfer (REST)"}),"\n",(0,t.jsx)(n.p,{children:"REST APIs utilize standard HTTP methods (GET, POST, PUT, DELETE) to perform CRUD (Create, Read, Update, Delete) operations on resources identified by unique URLs. They typically exchange data in lightweight formats like JSON or XML, making them easy to integrate with various applications and platforms."}),"\n",(0,t.jsx)(n.p,{children:"GET /users/123"}),"\n",(0,t.jsx)(n.h3,{id:"simple-object-access-protocol-soap",children:"Simple Object Access Protocol (SOAP)"}),"\n",(0,t.jsx)(n.p,{children:"SOAP APIs follow a more formal and standardized protocol for exchanging structured information. They use XML to define messages, which are then encapsulated in SOAP envelopes and transmitted over network protocols like HTTP."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-xml",children:'<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:tem="http://tempuri.org/">\n   <soapenv:Header/>\n   <soapenv:Body>\n      <tem:GetStockPrice>\n         <tem:StockName>AAPL</tem:StockName>\n      </tem:GetStockPrice>\n   </soapenv:Body>\n</soapenv:Envelope>\n'})}),"\n",(0,t.jsx)(n.h3,{id:"graphql",children:"GraphQL"}),"\n",(0,t.jsx)(n.p,{children:"GraphQL provides a single endpoint where clients can request the data they need using a flexible query language."}),"\n",(0,t.jsx)(n.p,{children:"The query language is very flexible and allow to query for the exact data we're interested:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-graphql",children:"query {\n  user(id: 123) {\n    name\n    email\n    posts(limit: 5) {\n      title\n      body\n    }\n  }\n}\n"})}),"\n",(0,t.jsx)(n.p,{children:"We can also modify data, not only query it:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-graphql",children:'mutation {\n  createPost(title: "New Post", body: "This is the content of the new post") {\n    id\n    title\n  }\n}\n'})}),"\n",(0,t.jsx)(n.h2,{id:"identifying-endpoints",children:"Identifying endpoints"}),"\n",(0,t.jsx)(n.p,{children:"You must know where to look before you can start fuzzing Web APIs. Identifying the endpoints that the API exposes is the first crucial step in this process"}),"\n",(0,t.jsx)(n.p,{children:"In REST APIs, the endpoints can look like this:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"/users - Represents a collection of user resources."}),"\n",(0,t.jsx)(n.li,{children:"/users/123 - Represents a specific user with the ID 123."}),"\n",(0,t.jsx)(n.li,{children:"/products - Represents a collection of product resources."}),"\n",(0,t.jsx)(n.li,{children:"/products/456 - Represents a specific product with the ID 456."}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"And accept a series of parameters:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Query parameters: ",(0,t.jsx)(n.code,{children:"/users?limit=10&sort=name"})]}),"\n",(0,t.jsxs)(n.li,{children:["Path parameters: ",(0,t.jsx)(n.code,{children:"/products/{id}pen_spark"})]}),"\n",(0,t.jsxs)(n.li,{children:["Request body parameters: ",(0,t.jsx)(n.code,{children:'{ "name": "New Product", "price": 99.99 }'})]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"To discover the endpoints and their parameters you can:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Search for the official documentations: swagger, openAPI."}),"\n",(0,t.jsx)(n.li,{children:"Network Traffic Analysis: Burp Suite or Developer tools"}),"\n",(0,t.jsx)(n.li,{children:"Parameter name fuzzing: the same technique we have seen before."}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"For SOAP, it's a bit different. They rely on XML-based messages and Web Services Description Language (WSDL) files to define their interfaces and operations. They expose a single endpoint which is a URL where the SOAP server listens for incoming requests. The content of the SOAP message itself determines the specific operation you want to perform."}),"\n",(0,t.jsx)(n.p,{children:"Every operation in the API is defined in the Web Services Description Language (WSDL) file, an XML-based document that describes the web service's interface, operations, and message formats."}),"\n",(0,t.jsx)(n.p,{children:"So, to identify the endpoints:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"Check the WSDL file"}),"\n",(0,t.jsx)(n.li,{children:"Network analysis: Burp or Developer tools"}),"\n",(0,t.jsx)(n.li,{children:"Parameter fuzzing"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"In GraphQL, APIs typically have a single endpoint. This endpoint is usually a URL like /graphql and serves as the entry point for all queries and mutations sent to the API."}),"\n",(0,t.jsx)(n.p,{children:"To do the discovery of the internals of the API, you can use:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Introspection: GraphQL's introspection system is a powerful tool for discovery. By sending an introspection query to the GraphQL endpoint, you can retrieve a complete schema describing the API's capabilities. This includes available types, fields, queries, mutations, and arguments. Tools and IDEs can leverage this information to offer auto-completion, validation, and documentation for your GraphQL queries."}),"\n",(0,t.jsx)(n.li,{children:"API documentation: Well-documented GraphQL APIs provide comprehensive guides and references alongside introspection. These typically explain the purpose and usage of different queries and mutations, offer examples of valid structures, and detail input arguments and response formats. Tools like GraphiQL or GraphQL Playground, often bundled with GraphQL servers, provide an interactive environment for exploring the schema and experimenting with queries."}),"\n",(0,t.jsx)(n.li,{children:"Network traffic analysis: same as REST and SOAP."}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"api-fuzzing",children:"API Fuzzing"}),"\n",(0,t.jsx)(n.p,{children:"When it comes to API Fuzzing, there are primary types:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Parameter Fuzzing"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"One of the primary techniques in API fuzzing, parameter fuzzing focuses on systematically testing different values for API parameters. This includes query parameters (appended to the API endpoint URL), headers (containing metadata about the request), and request bodies (carrying the data payload)."}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Data format Fuzzing"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Web APIs frequently exchange data in structured formats like JSON or XML. Data format fuzzing specifically targets these formats by manipulating the structure, content, or encoding of the data. This can reveal vulnerabilities related to parsing errors, buffer overflows, or improper handling of special characters."}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Sequence Fuzzing"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"APIs often involve multiple interconnected endpoints, where the order and timing of requests are crucial. Sequence fuzzing examines how an API responds to sequences of requests, uncovering vulnerabilities like race conditions, insecure direct object references (IDOR), or authorization bypasses. By manipulating the order, timing, or parameters of API calls, fuzzers can expose weaknesses in the API's logic and state management."}),"\n",(0,t.jsxs)(n.p,{children:["We can use ",(0,t.jsx)(n.a,{href:"https://github.com/PandaSt0rm/webfuzz_api",children:"https://github.com/PandaSt0rm/webfuzz_api"})," to perform API fuzzing:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"python3 api_fuzzer.py http://IP:PORT\n\n[-] Invalid endpoint: http://localhost:8000/~webmaster (Status code: 404)\n[-] Invalid endpoint: http://localhost:8000/~www (Status code: 404)\n\nFuzzing completed.\nTotal requests: 4730\nFailed requests: 0\nRetries: 0\nStatus code counts:\n404: 4727\n200: 2\n405: 1\nFound valid endpoints:\n- http://localhost:8000/cz...\n- http://localhost:8000/docs\nUnusual status codes:\n405: http://localhost:8000/items\n"})}),"\n",(0,t.jsx)(n.p,{children:"The fuzzer identifies numerous invalid endpoints (returning 404 Not Found errors).\nTwo valid endpoints are discovered:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"/cz...: This is an undocumented endpoint as it doesn't appear in the API documentation."}),"\n",(0,t.jsx)(n.li,{children:"/docs: This is the documented Swagger UI endpoint."}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"The 405 Method Not Allowed response for /items suggests that an incorrect HTTP method was used to access this endpoint (e.g., trying a GET request instead of a POST)."}),"\n",(0,t.jsx)(n.h2,{id:"skills-assessment",children:"Skills assessment"}),"\n",(0,t.jsxs)(n.p,{children:["We're just given the server address and the ",(0,t.jsx)(n.code,{children:"common"})," wordlist. Our task is to find the flag."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"ffuf -ic -c -u http://94.237.59.213:37986/FUZZ -w /opt/github/SecLists/Discovery/Web-Content/common.txt:FUZZ -recursion -recursion-depth 2\n"})}),"\n",(0,t.jsxs)(n.p,{children:["We discover ",(0,t.jsx)(n.code,{children:"admin/index.php"})," which we might fuzz parameters there."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'ffuf -ic -c -u http://94.237.59.213:37986/admin/FUZZ -w /opt/github/SecLists/Discovery/Web-Content/common.txt -e ".php" -mc 200\n'})}),"\n",(0,t.jsxs)(n.p,{children:["We discover ",(0,t.jsx)(n.code,{children:"admin/panel.php"})," which asks for a parameter named ",(0,t.jsx)(n.code,{children:"accessID"}),". Let's fuzz the correct value:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'ffuf -ic -c -u "http://94.237.59.213:37986/admin/panel.php?accessID=FUZZ" -w /opt/github/SecLists/Discovery/Web-Content/common.txt -fs 58\n'})}),"\n",(0,t.jsx)(n.p,{children:"Once the value is found, we go to the page and it tells to do vhost fuzzing of the specified domain. We can do that with gobuster:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"\u2514\u2500$ gobuster vhost -u http://fuzzing_fun.htb:37986 -w /opt/github/SecLists/Discovery/Web-Content/common.txt --append-domain -xs 400,403\n"})}),"\n",(0,t.jsx)(n.p,{children:"We discover a hidden subdomain, a the page suggest us to do recursive fuzzing:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"ffuf -ic -c -u http://hidden.fuzzing_fun.htb:37986/godeep/FUZZ -w /opt/github/SecLists/Discovery/Web-Content/common.txt:FUZZ -recursion -recursion-depth 4\n"})}),"\n",(0,t.jsx)(n.p,{children:"And we discover the flag in the last found page."})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}}}]);