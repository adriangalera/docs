"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[9719],{7247:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>c,contentTitle:()=>o,default:()=>p,frontMatter:()=>a,metadata:()=>s,toc:()=>h});const s=JSON.parse('{"id":"Hacking/Write-ups/Hack the box/Sherlocks/Campfire1","title":"Campfire 1","description":"https://app.hackthebox.com/sherlocks/737","source":"@site/docs/Hacking/Write-ups/Hack the box/Sherlocks/Campfire1.md","sourceDirName":"Hacking/Write-ups/Hack the box/Sherlocks","slug":"/write-up/htb/sherlocks/campfire1","permalink":"/docs/write-up/htb/sherlocks/campfire1","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"slug":"/write-up/htb/sherlocks/campfire1","pagination_next":null,"pagination_prev":null},"sidebar":"tutorialSidebar"}');var n=i(4848),r=i(8453);const a={slug:"/write-up/htb/sherlocks/campfire1",pagination_next:null,pagination_prev:null},o="Campfire 1",c={},h=[];function l(e){const t={a:"a",code:"code",h1:"h1",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.header,{children:(0,n.jsx)(t.h1,{id:"campfire-1",children:"Campfire 1"})}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.a,{href:"https://app.hackthebox.com/sherlocks/737",children:"https://app.hackthebox.com/sherlocks/737"})}),"\n",(0,n.jsx)(t.p,{children:"Alonzo Spotted Weird files on his computer and informed the newly assembled SOC Team. Assessing the situation it is believed a Kerberoasting attack may have occurred in the network. It is your job to confirm the findings by analyzing the provided evidence. You are provided with: 1- Security Logs from the Domain Controller 2- PowerShell-Operational Logs from the affected workstation 3- Prefetch Files from the affected workstation"}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.a,{href:"https://www.crowdstrike.com/en-us/cybersecurity-101/cyberattacks/kerberoasting/",children:"https://www.crowdstrike.com/en-us/cybersecurity-101/cyberattacks/kerberoasting/"}),"\n",(0,n.jsx)(t.a,{href:"https://www.hackthebox.com/blog/kerberoasting-attack-detection",children:"https://www.hackthebox.com/blog/kerberoasting-attack-detection"}),"\n",(0,n.jsx)(t.a,{href:"https://techantidote.com/dfir-analyze-windows-event-logs-evtx-from-a-linux-machine-using-sigma-rules-chainsaw-and-evtx-dump/",children:"https://techantidote.com/dfir-analyze-windows-event-logs-evtx-from-a-linux-machine-using-sigma-rules-chainsaw-and-evtx-dump/"}),"\n",(0,n.jsx)(t.a,{href:"https://www.hackingarticles.in/forensic-investigation-prefetch-file/",children:"https://www.hackingarticles.in/forensic-investigation-prefetch-file/"}),"\n",(0,n.jsx)(t.a,{href:"https://ericzimmerman.github.io/#!index.md",children:"https://ericzimmerman.github.io/#!index.md"})]}),"\n",(0,n.jsx)(t.p,{children:"Install:"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.a,{href:"https://github.com/WithSecureLabs/chainsaw",children:"https://github.com/WithSecureLabs/chainsaw"})," a tool to search what happened inside Windows Forensic artifacts"]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.a,{href:"https://github.com/SigmaHQ/sigma",children:"https://github.com/SigmaHQ/sigma"})," rules to detect threats"]}),"\n",(0,n.jsx)(t.li,{children:(0,n.jsx)(t.a,{href:"https://ericzimmerman.github.io/#!index.md",children:"https://ericzimmerman.github.io/#!index.md"})}),"\n"]}),"\n",(0,n.jsx)(t.p,{children:"And execute chainsaw to analyze the event logs:"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-bash",children:"./chainsaw hunt ~/workspace/gal/htb/Sherlocks/Campfire-1/Triage/Domain\\ Controller -s ~/workspace/tools/sigma --mapping mappings/sigma-event-logs-all.yml -r ~/workspace/tools/sigma/rules --csv --output ~/workspace/gal/htb/Sherlocks/Campfire-1/Triage/Domain\\ Controller/chainsaw\n"})}),"\n",(0,n.jsx)(t.p,{children:"To analyze prefetch files, we'll move to a Windows VM."}),"\n",(0,n.jsxs)(t.p,{children:["There use ",(0,n.jsx)(t.code,{children:"pecmd"})," application (from ",(0,n.jsx)(t.a,{href:"https://ericzimmerman.github.io/#!index.md",children:"https://ericzimmerman.github.io/#!index.md"}),") to generate the CSV:"]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-powershell",children:".\\PECmd.exe -d C:\\Users\\gal\\Desktop\\campfire1\\Workstation\\2024-05-21T033012_triage_asset\\ --csv . --csvf C:\\Users\\gal\\Desktop\\prefetch.csv\n"})}),"\n",(0,n.jsxs)(t.p,{children:["Now, we'll use the Timeline explorer tool (from ",(0,n.jsx)(t.a,{href:"https://ericzimmerman.github.io/#!index.md",children:"https://ericzimmerman.github.io/#!index.md"}),") to analyze the csv"]})]})}function p(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(l,{...e})}):l(e)}},8453:(e,t,i)=>{i.d(t,{R:()=>a,x:()=>o});var s=i(6540);const n={},r=s.createContext(n);function a(e){const t=s.useContext(r);return s.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:a(e.components),s.createElement(r.Provider,{value:t},e.children)}}}]);