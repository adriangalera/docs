"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[8573],{3811:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>o,contentTitle:()=>c,default:()=>d,frontMatter:()=>l,metadata:()=>s,toc:()=>r});const s=JSON.parse('{"id":"Hacking/Write-ups/Hack the box/Challenges/Flag command","title":"Flag command","description":"https://app.hackthebox.com/challenges/Flag%20Command","source":"@site/docs/Hacking/Write-ups/Hack the box/Challenges/Flag command.md","sourceDirName":"Hacking/Write-ups/Hack the box/Challenges","slug":"/write-up/htb/challenges/flag-command","permalink":"/docs/write-up/htb/challenges/flag-command","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"slug":"/write-up/htb/challenges/flag-command","pagination_next":null,"pagination_prev":null},"sidebar":"tutorialSidebar"}');var t=a(4848),i=a(8453);const l={slug:"/write-up/htb/challenges/flag-command",pagination_next:null,pagination_prev:null},c="Flag command",o={},r=[];function h(e){const n={a:"a",code:"code",h1:"h1",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"flag-command",children:"Flag command"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.a,{href:"https://app.hackthebox.com/challenges/Flag%20Command",children:"https://app.hackthebox.com/challenges/Flag%20Command"})}),"\n",(0,t.jsx)(n.p,{children:'Embark on the "Dimensional Escape Quest" where you wake up in a mysterious forest maze that\'s not quite of this world. Navigate singing squirrels, mischievous nymphs, and grumpy wizards in a whimsical labyrinth that may lead to otherworldly surprises. Will you conquer the enchanted maze or find yourself lost in a different dimension of magical challenges? The journey unfolds in this mystical escape!'}),"\n",(0,t.jsx)(n.p,{children:"We're given an IP and port, this is some sort of a web role game. We can inspect the JS code to see the correct decission we need to take. There are three files:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["commands.js: The definition of the commands, there's the ",(0,t.jsx)(n.code,{children:"GAME_WON"})," command which probably will reveal the flag."]}),"\n",(0,t.jsx)(n.li,{children:"game.js"}),"\n",(0,t.jsx)(n.li,{children:"main.js"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"In main.js we see calls to an API. The response to display the possible commands is this:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "allPossibleCommands": {\n    "1": [\n      "HEAD NORTH",\n      "HEAD WEST",\n      "HEAD EAST",\n      "HEAD SOUTH"\n    ],\n    "2": [\n      "GO DEEPER INTO THE FOREST",\n      "FOLLOW A MYSTERIOUS PATH",\n      "CLIMB A TREE",\n      "TURN BACK"\n    ],\n    "3": [\n      "EXPLORE A CAVE",\n      "CROSS A RICKETY BRIDGE",\n      "FOLLOW A GLOWING BUTTERFLY",\n      "SET UP CAMP"\n    ],\n    "4": [\n      "ENTER A MAGICAL PORTAL",\n      "SWIM ACROSS A MYSTERIOUS LAKE",\n      "FOLLOW A SINGING SQUIRREL",\n      "BUILD A RAFT AND SAIL DOWNSTREAM"\n    ],\n    "secret": [\n      "Blip-blop, in a pickle with a hiccup! Shmiggity-shmack"\n    ]\n  }\n}\n'})}),"\n",(0,t.jsxs)(n.p,{children:["Using Firefox developer tools, we can place a breakpoint in the ",(0,t.jsx)(n.code,{children:"CheckMessage"})," function which is only called when the game is started."]}),"\n",(0,t.jsxs)(n.p,{children:["In the ",(0,t.jsx)(n.code,{children:"CheckMessage"})," there's this line:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:"    if (availableOptions[currentStep].includes(currentCommand) || availableOptions['secret'].includes(currentCommand)) {\n"})}),"\n",(0,t.jsx)(n.p,{children:"If we provide the secret, the frontend will make the call to the API and it will return the secret!"}),"\n",(0,t.jsx)(n.p,{children:"Easy!"})]})}function d(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(h,{...e})}):h(e)}},8453:(e,n,a)=>{a.d(n,{R:()=>l,x:()=>c});var s=a(6540);const t={},i=s.createContext(t);function l(e){const n=s.useContext(i);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),s.createElement(i.Provider,{value:n},e.children)}}}]);