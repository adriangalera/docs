"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[6900],{8453:(e,s,t)=>{t.d(s,{R:()=>r,x:()=>o});var n=t(6540);const i={},a=n.createContext(i);function r(e){const s=n.useContext(a);return n.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function o(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),n.createElement(a.Provider,{value:s},e.children)}},9581:(e,s,t)=>{t.r(s),t.d(s,{assets:()=>d,contentTitle:()=>o,default:()=>h,frontMatter:()=>r,metadata:()=>n,toc:()=>l});const n=JSON.parse('{"id":"Hacking/HTB Academy/ffuf","title":"Fuzzing with ffuf","description":"Tools such as ffuf provide us with a handy automated way to fuzz the web application\'s individual components or a web page. This means, for example, that we use a list that is used to send requests to the webserver if the page with the name from our list exists on the webserver. If we get a response code 200, then we know that this page exists on the webserver, and we can look at it manually.","source":"@site/docs/Hacking/HTB Academy/ffuf.md","sourceDirName":"Hacking/HTB Academy","slug":"/Hacking/HTB Academy/ffuf","permalink":"/docs/Hacking/HTB Academy/ffuf","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Windows fundamentals","permalink":"/docs/Hacking/HTB Academy/Windows fundamentals"},"next":{"title":"Bash","permalink":"/docs/languages/bash"}}');var i=t(4848),a=t(8453);const r={},o="Fuzzing with ffuf",d={},l=[{value:"Directory fuzzing",id:"directory-fuzzing",level:2},{value:"Extension fuzzing",id:"extension-fuzzing",level:2},{value:"Page fuzzing",id:"page-fuzzing",level:2},{value:"Recursive fuzzing",id:"recursive-fuzzing",level:2},{value:"Sub-domain fuzzing",id:"sub-domain-fuzzing",level:2},{value:"Virtual host fuzzing",id:"virtual-host-fuzzing",level:2},{value:"Filtering",id:"filtering",level:2},{value:"Parameter Fuzzing - GET",id:"parameter-fuzzing---get",level:2},{value:"Parameter Fuzzing - POST",id:"parameter-fuzzing---post",level:2},{value:"Value fuzzing",id:"value-fuzzing",level:2}];function c(e){const s={code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.header,{children:(0,i.jsx)(s.h1,{id:"fuzzing-with-ffuf",children:"Fuzzing with ffuf"})}),"\n",(0,i.jsxs)(s.p,{children:["Tools such as ",(0,i.jsx)(s.code,{children:"ffuf"})," provide us with a handy automated way to fuzz the web application's individual components or a web page. This means, for example, that we use a list that is used to send requests to the webserver if the page with the name from our list exists on the webserver. If we get a response code 200, then we know that this page exists on the webserver, and we can look at it manually."]}),"\n",(0,i.jsx)(s.p,{children:"The term fuzzing refers to a testing technique that sends various types of user input to a certain interface to study how it would react."}),"\n",(0,i.jsx)(s.p,{children:"We usually utilize pre-defined wordlists of commonly used terms for each type of test for web fuzzing to see if the webserver would accept them. We will not have to reinvent the wheel by manually creating these wordlists, as great efforts have been made to search the web and determine the most commonly used words for each type of fuzzing. Some of the most commonly used wordlists can be found under the GitHub SecLists repository, which categorizes wordlists under various types of fuzzing,"}),"\n",(0,i.jsx)(s.h2,{id:"directory-fuzzing",children:"Directory fuzzing"}),"\n",(0,i.jsxs)(s.p,{children:["This type of fuzzing tries to reveal accessible directories in a web server. In order to do so, we need to place the keyword ",(0,i.jsx)(s.code,{children:"FUZZ"})," in the part of the URL we want to fuzz:"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"ffuf -w <SNIP> -u http://SERVER_IP:PORT/FUZZ\n"})}),"\n",(0,i.jsx)(s.p,{children:"e.g:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"ffuf -w /opt/useful/seclists/Discovery/Web-Content/directory-list-2.3-small.txt:FUZZ -u http://SERVER_IP:PORT/FUZZ\n"})}),"\n",(0,i.jsxs)(s.p,{children:["In general, all usages of ",(0,i.jsx)(s.code,{children:"fuff"})," will be like this. ",(0,i.jsx)(s.code,{children:"FUZZ"}),' keyword needs to be specified in the wordlist so that the variable is populated from the wordlist and in the part that needs to be "fuzzed"']}),"\n",(0,i.jsx)(s.h2,{id:"extension-fuzzing",children:"Extension fuzzing"}),"\n",(0,i.jsx)(s.p,{children:"We can try to find the technology of the web server by fuzzing the extensions of the webpages:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"ffuf -w /opt/useful/seclists/Discovery/Web-Content/web-extensions.txt:FUZZ -u http://SERVER_IP:PORT/blog/indexFUZZ\n"})}),"\n",(0,i.jsxs)(s.p,{children:["This will try with: ",(0,i.jsx)(s.code,{children:".php"}),", ",(0,i.jsx)(s.code,{children:".asp"}),", etc.."]}),"\n",(0,i.jsx)(s.h2,{id:"page-fuzzing",children:"Page fuzzing"}),"\n",(0,i.jsx)(s.p,{children:"Once we know the extension, we now can fuzz what pages are available with that extension:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"ffuf -w /opt/useful/seclists/Discovery/Web-Content/directory-list-2.3-small.txt:FUZZ -u http://SERVER_IP:PORT/blog/FUZZ.php\n"})}),"\n",(0,i.jsx)(s.h2,{id:"recursive-fuzzing",children:"Recursive fuzzing"}),"\n",(0,i.jsx)(s.p,{children:"We might have multiple directories and in each directory multiple pages. In order to fuzz all of those, we can fuzz recursively."}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"ffuf -w /opt/useful/seclists/Discovery/Web-Content/directory-list-2.3-small.txt:FUZZ -u http://SERVER_IP:PORT/FUZZ -recursion -recursion-depth 1 -e .php -v\n"})}),"\n",(0,i.jsx)(s.p,{children:"Note that we can specify the depth of the recursion. For each directory, it will restart the wordlist and fuzz the whole directory."}),"\n",(0,i.jsx)(s.h2,{id:"sub-domain-fuzzing",children:"Sub-domain fuzzing"}),"\n",(0,i.jsxs)(s.p,{children:["Sub-domains can be fuzzed in the same as other components of the website, think of examples such as ",(0,i.jsx)(s.code,{children:"photos.google.com"}),", etc..."]}),"\n",(0,i.jsx)(s.p,{children:"Similarly to other fuzzing attacks, we just need a word list and where to inject the fuzzed word. For example:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"ffuf -w /opt/useful/seclists/Discovery/DNS/subdomains-top1million-5000.txt:FUZZ -u https://FUZZ.inlanefreight.com/\n"})}),"\n",(0,i.jsx)(s.h2,{id:"virtual-host-fuzzing",children:"Virtual host fuzzing"}),"\n",(0,i.jsx)(s.p,{children:"The key difference between VHosts and sub-domains is that a VHost is basically a 'sub-domain' served on the same server and has the same IP, such that a single IP could be serving two or more different websites. VHosts may or may not have public DNS records."}),"\n",(0,i.jsxs)(s.p,{children:["To fuzz virtual hosts, you need to specify the host using the HTTP Header ",(0,i.jsx)(s.code,{children:"Host"}),". For example:"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"ffuf -w /opt/useful/seclists/Discovery/DNS/subdomains-top1million-5000.txt:FUZZ -u http://academy.htb:PORT/ -H 'Host: FUZZ.academy.htb'\n"})}),"\n",(0,i.jsx)(s.h2,{id:"filtering",children:"Filtering"}),"\n",(0,i.jsxs)(s.p,{children:["The results automatically discard ",(0,i.jsx)(s.code,{children:"404 Not found"})," and keeps the rest."]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"FILTER OPTIONS:\n  -fc              Filter HTTP status codes from response. Comma separated list of codes and ranges\n  -fl              Filter by amount of lines in response. Comma separated list of line counts and ranges\n  -fr              Filter regexp\n  -fs              Filter HTTP response size. Comma separated list of sizes and ranges\n  -fw              Filter by amount of words in response. Comma separated list of word counts and ranges\n"})}),"\n",(0,i.jsxs)(s.p,{children:["Sometimes, the response is 200 OK, but just showing an error or a not found. In this case, let's say the size of the page is 900 bytes. So, in this case, we'll set the ",(0,i.jsx)(s.code,{children:"-fs"})," parameter specify we only want to see results whose size is bigger than 900 Bytes:"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"ffuf -w /opt/useful/seclists/Discovery/DNS/subdomains-top1million-5000.txt:FUZZ -u http://academy.htb:PORT/ -H 'Host: FUZZ.academy.htb' -fs 900\n"})}),"\n",(0,i.jsx)(s.h2,{id:"parameter-fuzzing---get",children:"Parameter Fuzzing - GET"}),"\n",(0,i.jsx)(s.p,{children:"Fuzzing parameters may expose unpublished parameters that are publicly accessible. Such parameters tend to be less tested and less secured."}),"\n",(0,i.jsx)(s.p,{children:"GET Parameters are passed in the URL, e.g:"}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.code,{children:"http://admin.academy.htb:PORT/admin/admin.php?param1=value"})}),"\n",(0,i.jsxs)(s.p,{children:["So, we need to place the ",(0,i.jsx)(s.code,{children:"FUZZ"})," keyword in the URL:"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"ffuf -w /opt/useful/seclists/Discovery/Web-Content/burp-parameter-names.txt:FUZZ -u http://admin.academy.htb:PORT/admin/admin.php?FUZZ=value\n"})}),"\n",(0,i.jsx)(s.h2,{id:"parameter-fuzzing---post",children:"Parameter Fuzzing - POST"}),"\n",(0,i.jsx)(s.p,{children:"The main difference between POST requests and GET requests is that POST requests are not passed with the URL and cannot simply be appended after a ? symbol. POST requests are passed in the data field within the HTTP request."}),"\n",(0,i.jsxs)(s.p,{children:["Now, in ",(0,i.jsx)(s.code,{children:"fuff"})," we can add the ",(0,i.jsx)(s.code,{children:"FUZZ"})," parameter in the post data:"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"ffuf -w /opt/useful/seclists/Discovery/Web-Content/burp-parameter-names.txt:FUZZ -u http://admin.academy.htb:PORT/admin/admin.php -X POST -d 'FUZZ=key' -H 'Content-Type: application/x-www-form-urlencoded'\n"})}),"\n",(0,i.jsx)(s.h2,{id:"value-fuzzing",children:"Value fuzzing"}),"\n",(0,i.jsx)(s.p,{children:"Once we discovered GET or POST parameters, we can fuzz if there's a special value or something interesting. Since every application is a different word, we might need to build our own word list."}),"\n",(0,i.jsxs)(s.p,{children:["Let's imagine that in our case, we spotted ",(0,i.jsx)(s.code,{children:"id"})," parameter and can accept a number input of some sort. These ids can be in a custom format, or can be sequential, like from 1-1000 or 1-1000000, and so on. We'll start with a wordlist containing all numbers from 1-1000:"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"for i in $(seq 1 1000); do echo $i >> ids.txt; done\n"})}),"\n",(0,i.jsx)(s.p,{children:"Now we can use this wordlist in fuff:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"ffuf -w ids.txt:FUZZ -u http://admin.academy.htb:PORT/admin/admin.php -X POST -d 'id=FUZZ' -H 'Content-Type: application/x-www-form-urlencoded'\n"})})]})}function h(e={}){const{wrapper:s}={...(0,a.R)(),...e.components};return s?(0,i.jsx)(s,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}}}]);