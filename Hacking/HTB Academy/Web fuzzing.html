<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-Hacking/HTB Academy/Web fuzzing" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">Web fuzzing | agalera.eu</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://www.agalera.eu/docs/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://www.agalera.eu/docs/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://www.agalera.eu/docs/Hacking/HTB Academy/Web fuzzing"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Web fuzzing | agalera.eu"><meta data-rh="true" name="description" content="Web fuzzing is a critical technique in web application security to identify vulnerabilities by testing various inputs"><meta data-rh="true" property="og:description" content="Web fuzzing is a critical technique in web application security to identify vulnerabilities by testing various inputs"><link data-rh="true" rel="canonical" href="https://www.agalera.eu/docs/Hacking/HTB Academy/Web fuzzing"><link data-rh="true" rel="alternate" href="https://www.agalera.eu/docs/Hacking/HTB Academy/Web fuzzing" hreflang="en"><link data-rh="true" rel="alternate" href="https://www.agalera.eu/docs/Hacking/HTB Academy/Web fuzzing" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Web fuzzing","item":"https://www.agalera.eu/docs/Hacking/HTB Academy/Web fuzzing"}]}</script><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-S8VGYBN25C"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-S8VGYBN25C",{anonymize_ip:!0})</script><link rel="stylesheet" href="/docs/assets/css/styles.f96ca0f1.css">
<script src="/docs/assets/js/runtime~main.248eae46.js" defer="defer"></script>
<script src="/docs/assets/js/main.c91d5377.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><a class="navbar__brand" href="/docs/"><div class="navbar__logo"><img src="/docs/img/logo.svg" alt="agalera.eu" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/docs/img/logo.svg" alt="agalera.eu" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">agalera.eu</b></a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input id="search_input_react" type="search" placeholder="Loading..." aria-label="Search" class="navbar__search-input search-bar" disabled=""></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/flight-sim/dcs/f5e">Flight Simulators</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/docs/Hacking/HTB Academy/File inclusion">Hacking</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/docs/Hacking/HTB Academy/File inclusion">HTB Academy</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Hacking/HTB Academy/File inclusion">File inclusion</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Hacking/HTB Academy/File transfers">File transfer</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Hacking/HTB Academy/Introduction to Active Directory">Introduction to Active Directory</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Hacking/HTB Academy/Linux fundamentals">Linux fundamentals</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Hacking/HTB Academy/Pentest In a Nutshell">Pentest in a nutshell</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Hacking/HTB Academy/SQL injections">SQL injections</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/Hacking/HTB Academy/Web fuzzing">Web fuzzing</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Hacking/HTB Academy/Windows fundamentals">Windows fundamentals</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Hacking/HTB Academy/ffuf">Fuzzing with ffuf</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/languages/bash">Language security</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/playbooks/active-directory">Playbooks</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/tooling/crackmapexec">Tooling</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/useful-links">Useful links</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/write-up/htb/challenges/critical-ops">Write-ups</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/linux-useful-commands">Linux</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/Shortcuts/Chrome">Shortcuts</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/">Welcome</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/docs/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Hacking</span></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">HTB Academy</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Web fuzzing</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Web fuzzing</h1></header>
<p>Web fuzzing is a critical technique in web application security to identify vulnerabilities by testing various inputs</p>
<p>Fuzzing casts a wider net. It involves feeding the web application with unexpected inputs, including malformed data, invalid characters, and nonsensical combinations. Brute-forcing, on the other hand, is a more targeted approach. It focuses on systematically trying out many possibilities for a specific value, such as a password or an ID number.</p>
<p>Let&#x27;s define some concepts first:</p>
<ul>
<li>Wordlist: A dictionary or list of words, phrases, file names, directory names, or parameter values used as input during fuzzing.</li>
<li>Payload: The actual data sent to the web application during fuzzing. Can be a simple string, numerical value, or complex data structure.</li>
<li>Response analysis: Examining the web application&#x27;s responses (e.g., response codes, error messages) to the fuzzer&#x27;s payloads to identify anomalies that might indicate vulnerabilities.</li>
<li>Fuzzer: A software tool that automates generating and sending payloads to a web application and analyzing the responses.</li>
<li>False positive: result incorrectly labeled as vulnerability.</li>
<li>False negative: A vulnerability that exists in the web application but is not detected by the fuzzer.</li>
<li>Fuzzing Scope: the part of the application under the fuzzing effort.</li>
</ul>
<p>Some tools:</p>
<ul>
<li>FFUF (Fuzz Faster U Fool). Use cases:<!-- -->
<ul>
<li>Directory and File Enumeration</li>
<li>Parameter Discovery</li>
<li>Brute-Force Attack</li>
</ul>
</li>
<li>Gobuster. Use cases:<!-- -->
<ul>
<li>Content Discovery</li>
<li>DNS Subdomain enumeration</li>
<li>Wordpress content detection</li>
</ul>
</li>
<li>FeroxBuster. Designed for brute-force discovery of unlinked content in web applications, making it particularly useful for identifying hidden directories and files. It&#x27;s more of a &quot;forced browsing&quot; tool than a fuzzer like ffuf. Use cases:<!-- -->
<ul>
<li>Recursive Scanning</li>
<li>Unlinked Content Discovery</li>
<li>High-Performance Scans</li>
</ul>
</li>
<li>wfuzz/wenum. Use cases:<!-- -->
<ul>
<li>Directory and File Enumeration</li>
<li>Parameter Discovery</li>
<li>Brute-Force Attack</li>
</ul>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="fuzzing-files-and-directories">Fuzzing files and directories<a href="#fuzzing-files-and-directories" class="hash-link" aria-label="Direct link to Fuzzing files and directories" title="Direct link to Fuzzing files and directories">​</a></h2>
<p>You can use a wordlist and try to make requests to the server and see if some is positive (200 OK) or any other desired state. The key here is to find a related wordlist.</p>
<p>See some examples:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ffuf -ic -w /opt/github/SecLists/Discovery/Web-Content/DirBuster-2007_directory-list-lowercase-2.3-small.txt:FUFF -u &quot;http://94.237.59.213:58567/FUFF&quot;</span><br></span></code></pre></div></div>
<p>The <code>FUFF</code> keyword is where the word from the word list will be injected.</p>
<p>If you want to use <code>-e</code> flag to setup the extension, you don&#x27;t need to place the <code>FUFF</code> in the word list, e.g:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ffuf -c -ic -w /opt/github/SecLists/Discovery/Web-Content/common.txt -u &quot;http://94.237.59.213:58567/webfuzzing_hidden_path/flag/FUZZ&quot; -e .html</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="fuzzing-recursively">Fuzzing recursively<a href="#fuzzing-recursively" class="hash-link" aria-label="Direct link to Fuzzing recursively" title="Direct link to Fuzzing recursively">​</a></h2>
<p>What if our target has a complex structure with multiple nested directories? Manually fuzzing each level would be tedious and time-consuming. This is where recursive fuzzing comes in handy.</p>
<p>Recursive fuzzing consist in 3 steps:</p>
<ol>
<li>Initial fuzzing: same as we&#x27;ve seen so far.</li>
<li>For each discovered directory, the fuzzer adds the discovered URL to the queue.</li>
<li>Iterative depth: the processes is repeated for each directory until a specified depth has been scanned.</li>
</ol>
<p><code>fuff</code> example:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ffuf -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -ic -v -u http://IP:PORT/FUZZ -e .html -recursion </span><br></span></code></pre></div></div>
<p>When fuzzing recursively, it is wise to set up some limits:</p>
<ul>
<li>
<p><code>-recursion-depth</code>: This flag allows you to set a maximum depth for recursive exploration. For example, -recursion-depth 2 limits fuzzing to two levels deep (the starting directory and its immediate subdirectories).</p>
</li>
<li>
<p><code>-rate</code>: You can control the rate at which ffuf sends requests per second, preventing the server from being overloaded.</p>
</li>
<li>
<p><code>-timeout</code>: This option sets the timeout for individual requests, helping to prevent the fuzzer from hanging on unresponsive targets.</p>
</li>
</ul>
<p>e.g:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ffuf -c -ic -w /opt/github/SecLists/Discovery/Web-Content/DirBuster-2007_directory-list-2.3-small.txt:FUZZ -u &quot;http://94.237.59.213:45870/recursive_fuzz/FUZZ&quot; -recursion -recursion-depth 4</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="parameter-and-value-fuzzing">Parameter and value fuzzing<a href="#parameter-and-value-fuzzing" class="hash-link" aria-label="Direct link to Parameter and value fuzzing" title="Direct link to Parameter and value fuzzing">​</a></h2>
<p>This technique focuses on manipulating the parameters and their values within web requests to uncover vulnerabilities in how the application processes input.</p>
<p>Parameters are the gateways through which you can interact with a web application. By manipulating their values, you can test how the application responds to different inputs, potentially uncovering vulnerabilities. For instance:</p>
<ul>
<li>Altering a product ID in a shopping cart URL could reveal pricing errors or unauthorized access to other users&#x27; orders.</li>
<li>Modifying a hidden parameter in a request might unlock hidden features or administrative functions.</li>
<li>Injecting malicious code into a search query could expose vulnerabilities like Cross-Site Scripting (XSS) or SQL Injection (SQLi).</li>
</ul>
<p>We can fuzz the existence of the parameter itself and the value of the parameters. For example, we make a request with curl:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">adriangalera@htb[/htb]$ curl http://IP:PORT/get.php</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Invalid parameter value</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">x:</span><br></span></code></pre></div></div>
<p>We have discovered that this application need a parameter <code>x</code>. If we set it manually to 1:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">adriangalera@htb[/htb]$ curl http://IP:PORT/get.php?x=1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Invalid parameter value</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">x: 1</span><br></span></code></pre></div></div>
<p>Now, we can use <code>wenum</code> to discover the correct values:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">wenum -w /usr/share/seclists/Discovery/Web-Content/common.txt --hc 404 -u &quot;http://IP:PORT/get.php?x=FUZZ&quot;</span><br></span></code></pre></div></div>
<p>The same technique can be applied to POST requests:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">curl -d &quot;&quot; http://IP:PORT/post.php</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Invalid parameter value</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">y: </span><br></span></code></pre></div></div>
<p>And we can fuzz the valid values with <code>fuff</code>:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ffuf -u http://IP:PORT/post.php -X POST -H &quot;Content-Type: application/x-www-form-urlencoded&quot; -d &quot;y=FUZZ&quot; -w /usr/share/seclists/Discovery/Web-Content/common.txt -mc 200 -v</span><br></span></code></pre></div></div>
<p>For the exercise, we can get the correct GET parameter value calling:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ffuf -ic -w /opt/github/SecLists/Discovery/Web-Content/big.txt:FUZZ -u &quot;http://94.237.54.192:53037/get.php?x=FUZZ&quot;</span><br></span></code></pre></div></div>
<p>and POST calling:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ffuf -u http://94.237.54.192:53037/post.php -X POST -H &quot;Content-Type: application/x-www-form-urlencoded&quot; -d &quot;y=FUZZ&quot; -w /opt/github/SecLists/Discovery/Web-Content/common.txt:FUZZ  -mc 200 -v</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="fuzzing-virtual-host-and-subdomains">Fuzzing virtual host and subdomains.<a href="#fuzzing-virtual-host-and-subdomains" class="hash-link" aria-label="Direct link to Fuzzing virtual host and subdomains." title="Direct link to Fuzzing virtual host and subdomains.">​</a></h2>
<p>Virtual hosting enables multiple websites or domains to be served from a single server or IP address. Each vhost is associated with a unique domain name or hostname. When a client sends an HTTP request, the web server examines the Host header to determine which vhost&#x27;s content to deliver.</p>
<p>Subdomains, on the other hand, are extensions of a primary domain name, creating a hierarchical structure within the domain. They are used to organize different sections or services within a website. For example, blog.example.com and shop.example.com are subdomains of the main domain example.com. Unlike vhosts, subdomains are resolved to specific IP addresses through DNS (Domain Name System) records.</p>
<p>We can use <code>gobuster</code> to perform vhost fuzzing:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">gobuster vhost -u http://inlanefreight.htb:81 -w /usr/share/seclists/Discovery/Web-Content/common.txt --append-domain</span><br></span></code></pre></div></div>
<p><code>--append-domain</code>: This crucial flag instructs Gobuster to append the base domain (inlanefreight.htb) to each word in the wordlist. This ensures that the Host header in each request includes a complete domain name (e.g., admin.inlanefreight.htb), which is essential for vhost discovery.</p>
<p>To perform sub-domain fuzzing is very similar, but you need to change the mode of <code>gobuster</code>:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">gobuster dns -do inlanefreight.com -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt</span><br></span></code></pre></div></div>
<p>Under the hood, Gobuster works by generating subdomain names based on the wordlist, appending them to the target domain, and then attempting to resolve those subdomains using DNS queries. If a subdomain resolves to an IP address, it is considered valid and included in the output.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="filtering-results">Filtering results<a href="#filtering-results" class="hash-link" aria-label="Direct link to Filtering results" title="Direct link to Filtering results">​</a></h2>
<p>Most of the fuzzing attemps will lead to nowhere and we&#x27;ll need to filter out that noise. Each tool has its own filter mechanism.</p>
<p>The idea is that you can filter by:</p>
<ul>
<li>Response HTTP status code</li>
<li>Response content length</li>
<li>Response line counts</li>
<li>Response word counts</li>
<li>Response time (TTFB)</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="validate-your-findings">Validate your findings<a href="#validate-your-findings" class="hash-link" aria-label="Direct link to Validate your findings" title="Direct link to Validate your findings">​</a></h2>
<p>Once you found out a file, a directory, a vhost, etc... The fact that you found it, it doesn&#x27;t matter it&#x27;s a vulnerability automatically.</p>
<p>For example, if you suspect a SQL injection vulnerability, you could craft a harmless SQL query that returns the SQL server version string rather than trying to extract or modify sensitive data.</p>
<p>Or you can use <code>curl</code> to verify the request of the response, see if there&#x27;s data and what kind of data will come in the answer.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="fuzzing-web-apis">Fuzzing Web APIs<a href="#fuzzing-web-apis" class="hash-link" aria-label="Direct link to Fuzzing Web APIs" title="Direct link to Fuzzing Web APIs">​</a></h2>
<p>Essentially, a Web API serves as a bridge between a server (hosting the data and functionality) and a client (such as a web browser, mobile app, or another server) that wants to access or utilize that data or functionality.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="representational-state-transfer-rest">Representational State Transfer (REST)<a href="#representational-state-transfer-rest" class="hash-link" aria-label="Direct link to Representational State Transfer (REST)" title="Direct link to Representational State Transfer (REST)">​</a></h3>
<p>REST APIs utilize standard HTTP methods (GET, POST, PUT, DELETE) to perform CRUD (Create, Read, Update, Delete) operations on resources identified by unique URLs. They typically exchange data in lightweight formats like JSON or XML, making them easy to integrate with various applications and platforms.</p>
<p>GET /users/123</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="simple-object-access-protocol-soap">Simple Object Access Protocol (SOAP)<a href="#simple-object-access-protocol-soap" class="hash-link" aria-label="Direct link to Simple Object Access Protocol (SOAP)" title="Direct link to Simple Object Access Protocol (SOAP)">​</a></h3>
<p>SOAP APIs follow a more formal and standardized protocol for exchanging structured information. They use XML to define messages, which are then encapsulated in SOAP envelopes and transmitted over network protocols like HTTP.</p>
<div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag namespace" style="color:#00009f;opacity:0.7">soapenv:</span><span class="token tag" style="color:#00009f">Envelope</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name namespace" style="color:#00a4db;opacity:0.7">xmlns:</span><span class="token tag attr-name" style="color:#00a4db">soapenv</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">http://schemas.xmlsoap.org/soap/envelope/</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name namespace" style="color:#00a4db;opacity:0.7">xmlns:</span><span class="token tag attr-name" style="color:#00a4db">tem</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">http://tempuri.org/</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag namespace" style="color:#00009f;opacity:0.7">soapenv:</span><span class="token tag" style="color:#00009f">Header</span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag namespace" style="color:#00009f;opacity:0.7">soapenv:</span><span class="token tag" style="color:#00009f">Body</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag namespace" style="color:#00009f;opacity:0.7">tem:</span><span class="token tag" style="color:#00009f">GetStockPrice</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag namespace" style="color:#00009f;opacity:0.7">tem:</span><span class="token tag" style="color:#00009f">StockName</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">AAPL</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag namespace" style="color:#00009f;opacity:0.7">tem:</span><span class="token tag" style="color:#00009f">StockName</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag namespace" style="color:#00009f;opacity:0.7">tem:</span><span class="token tag" style="color:#00009f">GetStockPrice</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag namespace" style="color:#00009f;opacity:0.7">soapenv:</span><span class="token tag" style="color:#00009f">Body</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag namespace" style="color:#00009f;opacity:0.7">soapenv:</span><span class="token tag" style="color:#00009f">Envelope</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="graphql">GraphQL<a href="#graphql" class="hash-link" aria-label="Direct link to GraphQL" title="Direct link to GraphQL">​</a></h3>
<p>GraphQL provides a single endpoint where clients can request the data they need using a flexible query language.</p>
<p>The query language is very flexible and allow to query for the exact data we&#x27;re interested:</p>
<div class="language-graphql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-graphql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">query</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property-query">user</span><span class="token punctuation" style="color:#393A34">(</span><span class="token attr-name" style="color:#00a4db">id</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">123</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">name</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">email</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property-query">posts</span><span class="token punctuation" style="color:#393A34">(</span><span class="token attr-name" style="color:#00a4db">limit</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">title</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">body</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p>We can also modify data, not only query it:</p>
<div class="language-graphql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-graphql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">mutation</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property-query property-mutation">createPost</span><span class="token punctuation" style="color:#393A34">(</span><span class="token attr-name" style="color:#00a4db">title</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;New Post&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token attr-name" style="color:#00a4db">body</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;This is the content of the new post&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">id</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">title</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="identifying-endpoints">Identifying endpoints<a href="#identifying-endpoints" class="hash-link" aria-label="Direct link to Identifying endpoints" title="Direct link to Identifying endpoints">​</a></h2>
<p>You must know where to look before you can start fuzzing Web APIs. Identifying the endpoints that the API exposes is the first crucial step in this process</p>
<p>In REST APIs, the endpoints can look like this:</p>
<ul>
<li>/users - Represents a collection of user resources.</li>
<li>/users/123 - Represents a specific user with the ID 123.</li>
<li>/products - Represents a collection of product resources.</li>
<li>/products/456 - Represents a specific product with the ID 456.</li>
</ul>
<p>And accept a series of parameters:</p>
<ul>
<li>Query parameters: <code>/users?limit=10&amp;sort=name</code></li>
<li>Path parameters: <code>/products/{id}pen_spark</code></li>
<li>Request body parameters: <code>{ &quot;name&quot;: &quot;New Product&quot;, &quot;price&quot;: 99.99 }</code></li>
</ul>
<p>To discover the endpoints and their parameters you can:</p>
<ul>
<li>Search for the official documentations: swagger, openAPI.</li>
<li>Network Traffic Analysis: Burp Suite or Developer tools</li>
<li>Parameter name fuzzing: the same technique we have seen before.</li>
</ul>
<p>For SOAP, it&#x27;s a bit different. They rely on XML-based messages and Web Services Description Language (WSDL) files to define their interfaces and operations. They expose a single endpoint which is a URL where the SOAP server listens for incoming requests. The content of the SOAP message itself determines the specific operation you want to perform.</p>
<p>Every operation in the API is defined in the Web Services Description Language (WSDL) file, an XML-based document that describes the web service&#x27;s interface, operations, and message formats.</p>
<p>So, to identify the endpoints:</p>
<ol>
<li>Check the WSDL file</li>
<li>Network analysis: Burp or Developer tools</li>
<li>Parameter fuzzing</li>
</ol>
<p>In GraphQL, APIs typically have a single endpoint. This endpoint is usually a URL like /graphql and serves as the entry point for all queries and mutations sent to the API.</p>
<p>To do the discovery of the internals of the API, you can use:</p>
<ul>
<li>Introspection: GraphQL&#x27;s introspection system is a powerful tool for discovery. By sending an introspection query to the GraphQL endpoint, you can retrieve a complete schema describing the API&#x27;s capabilities. This includes available types, fields, queries, mutations, and arguments. Tools and IDEs can leverage this information to offer auto-completion, validation, and documentation for your GraphQL queries.</li>
<li>API documentation: Well-documented GraphQL APIs provide comprehensive guides and references alongside introspection. These typically explain the purpose and usage of different queries and mutations, offer examples of valid structures, and detail input arguments and response formats. Tools like GraphiQL or GraphQL Playground, often bundled with GraphQL servers, provide an interactive environment for exploring the schema and experimenting with queries.</li>
<li>Network traffic analysis: same as REST and SOAP.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="api-fuzzing">API Fuzzing<a href="#api-fuzzing" class="hash-link" aria-label="Direct link to API Fuzzing" title="Direct link to API Fuzzing">​</a></h2>
<p>When it comes to API Fuzzing, there are primary types:</p>
<ul>
<li>Parameter Fuzzing</li>
</ul>
<p>One of the primary techniques in API fuzzing, parameter fuzzing focuses on systematically testing different values for API parameters. This includes query parameters (appended to the API endpoint URL), headers (containing metadata about the request), and request bodies (carrying the data payload).</p>
<ul>
<li>Data format Fuzzing</li>
</ul>
<p>Web APIs frequently exchange data in structured formats like JSON or XML. Data format fuzzing specifically targets these formats by manipulating the structure, content, or encoding of the data. This can reveal vulnerabilities related to parsing errors, buffer overflows, or improper handling of special characters.</p>
<ul>
<li>Sequence Fuzzing</li>
</ul>
<p>APIs often involve multiple interconnected endpoints, where the order and timing of requests are crucial. Sequence fuzzing examines how an API responds to sequences of requests, uncovering vulnerabilities like race conditions, insecure direct object references (IDOR), or authorization bypasses. By manipulating the order, timing, or parameters of API calls, fuzzers can expose weaknesses in the API&#x27;s logic and state management.</p>
<p>We can use <a href="https://github.com/PandaSt0rm/webfuzz_api" target="_blank" rel="noopener noreferrer">https://github.com/PandaSt0rm/webfuzz_api</a> to perform API fuzzing:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">python3 api_fuzzer.py http://IP:PORT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[-] Invalid endpoint: http://localhost:8000/~webmaster (Status code: 404)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[-] Invalid endpoint: http://localhost:8000/~www (Status code: 404)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Fuzzing completed.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Total requests: 4730</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Failed requests: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Retries: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Status code counts:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">404: 4727</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">200: 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">405: 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Found valid endpoints:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- http://localhost:8000/cz...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- http://localhost:8000/docs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Unusual status codes:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">405: http://localhost:8000/items</span><br></span></code></pre></div></div>
<p>The fuzzer identifies numerous invalid endpoints (returning 404 Not Found errors).
Two valid endpoints are discovered:</p>
<ul>
<li>/cz...: This is an undocumented endpoint as it doesn&#x27;t appear in the API documentation.</li>
<li>/docs: This is the documented Swagger UI endpoint.</li>
</ul>
<p>The 405 Method Not Allowed response for /items suggests that an incorrect HTTP method was used to access this endpoint (e.g., trying a GET request instead of a POST).</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="skills-assessment">Skills assessment<a href="#skills-assessment" class="hash-link" aria-label="Direct link to Skills assessment" title="Direct link to Skills assessment">​</a></h2>
<p>We&#x27;re just given the server address and the <code>common</code> wordlist. Our task is to find the flag.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ffuf -ic -c -u http://94.237.59.213:37986/FUZZ -w /opt/github/SecLists/Discovery/Web-Content/common.txt:FUZZ -recursion -recursion-depth 2</span><br></span></code></pre></div></div>
<p>We discover <code>admin/index.php</code> which we might fuzz parameters there.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ffuf -ic -c -u http://94.237.59.213:37986/admin/FUZZ -w /opt/github/SecLists/Discovery/Web-Content/common.txt -e &quot;.php&quot; -mc 200</span><br></span></code></pre></div></div>
<p>We discover <code>admin/panel.php</code> which asks for a parameter named <code>accessID</code>. Let&#x27;s fuzz the correct value:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ffuf -ic -c -u &quot;http://94.237.59.213:37986/admin/panel.php?accessID=FUZZ&quot; -w /opt/github/SecLists/Discovery/Web-Content/common.txt -fs 58</span><br></span></code></pre></div></div>
<p>Once the value is found, we go to the page and it tells to do vhost fuzzing of the specified domain. We can do that with gobuster:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">└─$ gobuster vhost -u http://fuzzing_fun.htb:37986 -w /opt/github/SecLists/Discovery/Web-Content/common.txt --append-domain -xs 400,403</span><br></span></code></pre></div></div>
<p>We discover a hidden subdomain, a the page suggest us to do recursive fuzzing:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ffuf -ic -c -u http://hidden.fuzzing_fun.htb:37986/godeep/FUZZ -w /opt/github/SecLists/Discovery/Web-Content/common.txt:FUZZ -recursion -recursion-depth 4</span><br></span></code></pre></div></div>
<p>And we discover the flag in the last found page.</p></div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/Hacking/HTB Academy/SQL injections"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">SQL injections</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/Hacking/HTB Academy/Windows fundamentals"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Windows fundamentals</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#fuzzing-files-and-directories" class="table-of-contents__link toc-highlight">Fuzzing files and directories</a></li><li><a href="#fuzzing-recursively" class="table-of-contents__link toc-highlight">Fuzzing recursively</a></li><li><a href="#parameter-and-value-fuzzing" class="table-of-contents__link toc-highlight">Parameter and value fuzzing</a></li><li><a href="#fuzzing-virtual-host-and-subdomains" class="table-of-contents__link toc-highlight">Fuzzing virtual host and subdomains.</a></li><li><a href="#filtering-results" class="table-of-contents__link toc-highlight">Filtering results</a></li><li><a href="#validate-your-findings" class="table-of-contents__link toc-highlight">Validate your findings</a></li><li><a href="#fuzzing-web-apis" class="table-of-contents__link toc-highlight">Fuzzing Web APIs</a><ul><li><a href="#representational-state-transfer-rest" class="table-of-contents__link toc-highlight">Representational State Transfer (REST)</a></li><li><a href="#simple-object-access-protocol-soap" class="table-of-contents__link toc-highlight">Simple Object Access Protocol (SOAP)</a></li><li><a href="#graphql" class="table-of-contents__link toc-highlight">GraphQL</a></li></ul></li><li><a href="#identifying-endpoints" class="table-of-contents__link toc-highlight">Identifying endpoints</a></li><li><a href="#api-fuzzing" class="table-of-contents__link toc-highlight">API Fuzzing</a></li><li><a href="#skills-assessment" class="table-of-contents__link toc-highlight">Skills assessment</a></li></ul></div></div></div></div></main></div></div></div></div>
</body>
</html>