<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-Hacking/HTB Academy/Introduction to Purple team" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">Introduction to Purple team | agalera.eu</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://www.agalera.eu/docs/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://www.agalera.eu/docs/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://www.agalera.eu/docs/Hacking/HTB Academy/Introduction to Purple team"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Introduction to Purple team | agalera.eu"><meta data-rh="true" name="description" content="Purple team is a mix of Red team (offensive) and Blue team (defensive) security teams."><meta data-rh="true" property="og:description" content="Purple team is a mix of Red team (offensive) and Blue team (defensive) security teams."><link data-rh="true" rel="canonical" href="https://www.agalera.eu/docs/Hacking/HTB Academy/Introduction to Purple team"><link data-rh="true" rel="alternate" href="https://www.agalera.eu/docs/Hacking/HTB Academy/Introduction to Purple team" hreflang="en"><link data-rh="true" rel="alternate" href="https://www.agalera.eu/docs/Hacking/HTB Academy/Introduction to Purple team" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Introduction to Purple team","item":"https://www.agalera.eu/docs/Hacking/HTB Academy/Introduction to Purple team"}]}</script><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-S8VGYBN25C"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-S8VGYBN25C",{anonymize_ip:!0})</script><link rel="stylesheet" href="/docs/assets/css/styles.f96ca0f1.css">
<script src="/docs/assets/js/runtime~main.3cd40d96.js" defer="defer"></script>
<script src="/docs/assets/js/main.4c217ef9.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><a class="navbar__brand" href="/docs/"><div class="navbar__logo"><img src="/docs/img/logo.svg" alt="agalera.eu" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/docs/img/logo.svg" alt="agalera.eu" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">agalera.eu</b></a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input id="search_input_react" type="search" placeholder="Loading..." aria-label="Search" class="navbar__search-input search-bar" disabled=""></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/flight-sim/dcs/f5e">Flight Simulators</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/docs/Hacking/HTB Academy/Android Fundamentals">Hacking</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/docs/Hacking/HTB Academy/Android Fundamentals">HTB Academy</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Hacking/HTB Academy/Android Fundamentals">Android Fundamentals</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Hacking/HTB Academy/File inclusion">File inclusion</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Hacking/HTB Academy/File transfers">File transfer</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Hacking/HTB Academy/Introduction to Active Directory">Introduction to Active Directory</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Hacking/HTB Academy/Introduction to Hardware attacks">Introduction to hardware attacks</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/Hacking/HTB Academy/Introduction to Purple team">Introduction to Purple team</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Hacking/HTB Academy/Javascript deobfuscation">Javascript deobfuscation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Hacking/HTB Academy/Linux fundamentals">Linux fundamentals</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Hacking/HTB Academy/Pentest In a Nutshell">Pentest in a nutshell</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Hacking/HTB Academy/SQL injections">SQL injections</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Hacking/HTB Academy/Web fuzzing">Web fuzzing</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Hacking/HTB Academy/Windows fundamentals">Windows fundamentals</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Hacking/HTB Academy/ffuf">Fuzzing with ffuf</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/languages/bash">Language security</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/playbooks/active-directory">Playbooks</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/tooling/crackmapexec">Tooling</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/useful-links">Useful links</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/write-up/htb/challenges/critical-ops">Write-ups</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/linux-useful-commands">Linux</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/Shortcuts/Chrome">Shortcuts</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/">Welcome</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/docs/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Hacking</span></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">HTB Academy</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Introduction to Purple team</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Introduction to Purple team</h1></header>
<p>Purple team is a mix of Red team (offensive) and Blue team (defensive) security teams.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="windows-tooling">Windows tooling<a href="#windows-tooling" class="hash-link" aria-label="Direct link to Windows tooling" title="Direct link to Windows tooling">​</a></h2>
<p>System monitoring, event logging</p>
<table><thead><tr><th>Name</th><th>Description</th></tr></thead><tbody><tr><td>Sysmon</td><td>Provides detailed event logging and detection</td></tr></tbody></table>
<p>Log analysis</p>
<table><thead><tr><th>Name</th><th>Description</th></tr></thead><tbody><tr><td>Eric Zimmerman Tools</td><td>Forensic utilities for analyzing digital evidence, such as registry hives and event logs.</td></tr></tbody></table>
<p>Threat detection &amp; Monitoring</p>
<table><thead><tr><th>Name</th><th>Description</th></tr></thead><tbody><tr><td>Yara</td><td>Signature-based file scanning tool.</td></tr><tr><td>Chainsaw</td><td>Command-line tool for parsing and hunting through Windows Event Logs.</td></tr><tr><td>Sigma</td><td>Generic signature format for SIEM rule creation.</td></tr><tr><td>Zircolite</td><td>Sigma-based EVTX log analysis.</td></tr><tr><td>Osquery</td><td>Endpoint monitoring using SQL-like queries.</td></tr><tr><td>Velociraptor</td><td>Endpoint monitoring, collection, and response.</td></tr><tr><td>Velociraptor</td><td>Endpoint monitoring, collection, and response.</td></tr></tbody></table>
<p>Traffic Capturing</p>
<table><thead><tr><th>Name</th><th>Description</th></tr></thead><tbody><tr><td>Wireshark</td><td>Packet capture tool for network analysis.</td></tr></tbody></table>
<p>Memory dumping</p>
<table><thead><tr><th>Name</th><th>Description</th></tr></thead><tbody><tr><td>DumpIt</td><td>Memory dumping utility for memory forensics.</td></tr><tr><td>WinPmem</td><td>Memory dumping utility for memory forensics.</td></tr></tbody></table>
<p>Memory Forensics</p>
<table><thead><tr><th>Name</th><th>Description</th></tr></thead><tbody><tr><td>Volatility v2</td><td>Memory forensics tool for analyzing memory dumps.</td></tr><tr><td>Volatility v3</td><td>Memory forensics tool for analyzing memory dumps.</td></tr></tbody></table>
<p>Additional Telemetry</p>
<table><thead><tr><th>Name</th><th>Description</th></tr></thead><tbody><tr><td>SilkETW</td><td>C# wrappers for ETW.</td></tr><tr><td>SealighterTI</td><td>Running Microsoft-Windows-Threat-Intelligence without a driver.</td></tr><tr><td>AMSI-Monitoring-Script</td><td>Extracting script contents using the AMSI ETW provider.</td></tr><tr><td>JonMon</td><td>Collection of open-source telemetry sensors.</td></tr><tr><td>Fibratus</td><td>Adversary tradecraft detection using behavior-driven rule engine and YARA memory scanner.</td></tr></tbody></table>
<p>Adversary Simulation</p>
<table><thead><tr><th>Name</th><th>Description</th></tr></thead><tbody><tr><td>Atomic Red Team</td><td>Small and highly portable detection tests based on MITRE&#x27;s ATT&amp;CK.</td></tr></tbody></table>
<p>Malware/Process/PE Analysis</p>
<table><thead><tr><th>Name</th><th>Description</th></tr></thead><tbody><tr><td>CFF-Explorer</td><td>Examine and edit Portable Executable (PE)</td></tr><tr><td>Ghidra</td><td>Reverse engineering framework</td></tr><tr><td>x64dbg</td><td>x64/x32 debugger for windows</td></tr><tr><td>SpeakEasy</td><td>Binary emulator to emulate Windows kernel and user mode malware</td></tr><tr><td>SysInternalsSuite</td><td>Sysinternals Troubleshooting Utilities</td></tr><tr><td>Get-InjectedThread</td><td>Looks for threads that were created as a result of code injection.</td></tr><tr><td>Hollows Hunder</td><td>Scan all running processes. Recognizes and dumps a variety of implants.</td></tr><tr><td>Moneta</td><td>Live usermode memory analysis tool for Windows</td></tr><tr><td>PE-Sleve</td><td>Detects malware running on the system, as well as collects the potentially malicious material for further analysis.</td></tr><tr><td>API-Monitor</td><td>Monitors and controls API calls made by applications and services.</td></tr><tr><td>PE-Bear</td><td>Multiplatform reversing tool for PE files.</td></tr><tr><td>ProcessHacker</td><td>Monitors system resources, debugs software and detects malware.</td></tr><tr><td>ProcMonX</td><td>Extended Process Monitor-like tool based on Event Tracing for Windows.</td></tr><tr><td>Frida</td><td>Dynamic instrumentation toolkit for reverse-engineers. Helps to trace, instrument, debug and hook API functions</td></tr><tr><td>LitterBox</td><td>Malware sandbox environment for payload behavior testing.</td></tr></tbody></table>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="windows-logging">Windows logging<a href="#windows-logging" class="hash-link" aria-label="Direct link to Windows logging" title="Direct link to Windows logging">​</a></h2>
<ul>
<li>Sysmon</li>
</ul>
<p>Sysmon (System Monitor) is a powerful system activity monitoring tool within the Microsoft Sysinternals suite. Sysmon logs can be viewed in the Event Viewer by navigating to Applications and Services Logs &gt; Microsoft &gt; Windows &gt; Sysmon.</p>
<p>Sysmon logs are stored as part of the Windows Event Log system. The logs are located on disk at the following default path:</p>
<p><code>C:\Windows\System32\winevt\Logs\Microsoft-Windows-Sysmon%4Operational.evtx</code></p>
<p>Event ID 1 in sysmon logs are events for process creation.</p>
<ul>
<li>Command Line Logging</li>
</ul>
<p>Command Line Logging captures information about processes and their command-line arguments, which is useful for detecting suspicious activity, such as unauthorized execution of commands. The relevant Windows event ID is 4688 (A new process has been created). These can be seen in Windows Event Log, Sysmon and JonMon.</p>
<p>Stored in disk in <code>C:\Windows\System32\winevt\Logs\Security.evtx</code></p>
<ul>
<li>PowerShell Logging</li>
</ul>
<p>Script block logging captures the full content of scripts that are executed, including obfuscated or dynamically generated code. This is crucial for detecting sophisticated attacks. The Event ID for Script Block Logging is 4104. PowerShell logs can be viewed in the Event Viewer by navigating to Applications and Services Logs &gt; Microsoft &gt; Windows &gt; PowerShell.</p>
<p>Stored in disk in <code>C:\Windows\System32\winevt\Logs\Microsoft-Windows-PowerShell%4Operational.evtx</code></p>
<ul>
<li>Console History</li>
</ul>
<p>The console history is stored in the user&#x27;s profile directory at the following location:</p>
<p>C:\Users%username%\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadline\ConsoleHost_history.txt</p>
<ul>
<li>Audit policies</li>
</ul>
<p>Verbose auditing provides comprehensive tracking of both success and failure events across the system. Audit policy logs provide detailed insights into system access, privilege usage, and security settings modifications.</p>
<p>They are stored by default in <code>C:\Windows\System32\winevt\Logs\Security.evtx</code>.</p>
<ul>
<li>Windows Firewall Logs</li>
</ul>
<p>Windows Firewall logs provide detailed information about inbound and outbound network connections, including allowed and blocked connections.</p>
<p>Stored in <code>C:\Windows\System32\LogFiles\Firewall\pfirewall.log</code></p>
<p>here is another event (Event ID 5156) that is logged by the Windows Filtering Platform (WFP), which is responsible for processing network packets.</p>
<ul>
<li>JonMon</li>
</ul>
<p>By combining data from both the kernel-level and user-mode components, JonMon provides users with a comprehensive view of their security activity. This is installed as a service in the host. JonMon-generated logs can be viewed in the Event Viewer by navigating to Applications and Services Logs &gt; JonMon.</p>
<ul>
<li>SealighterTI</li>
</ul>
<p>The Microsoft-Windows-Threat-Intelligence Event Tracing for Windows (ETW) provider is a robust tool for detecting process injection and other types of attacks.  SealighterTI facilitates the logging of events from the Microsoft-Windows-Threat-Intelligence provider into the Windows Event Log, enhancing visibility into such activities. Runs in the background via a scheduled task.  Applications and Service Logs &gt; Sealighter</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="dumping-and-analyzing-windows-memory">Dumping and analyzing Windows Memory<a href="#dumping-and-analyzing-windows-memory" class="hash-link" aria-label="Direct link to Dumping and analyzing Windows Memory" title="Direct link to Dumping and analyzing Windows Memory">​</a></h2>
<p>Memory dumping is a vital capability in forensic investigations, enabling the capture of the current state of a system&#x27;s volatile memory for detailed post-incident analysis. This snapshot provides a wealth of information, such as active processes, loaded drivers, network connections, and potential malicious artifacts that may not be visible on disk.</p>
<p>We can use <code>DumpIt</code> or <code>WinPmem</code> to create a full memory dump.</p>
<p>To analyze the memory, we&#x27;ll use <code>Volatility v2/3</code>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="linux-toolings">Linux toolings<a href="#linux-toolings" class="hash-link" aria-label="Direct link to Linux toolings" title="Direct link to Linux toolings">​</a></h2>
<p>System monitoring and auditing</p>
<table><thead><tr><th>Tool</th><th>Path</th><th>Description</th></tr></thead><tbody><tr><td>Sysmon (Linux)</td><td>/usr/bin/sysmon</td><td>Provides detailed event logging and detection.</td></tr><tr><td>Auditd</td><td>/usr/sbin/auditd</td><td>Auditing tool to track system-level events.</td></tr></tbody></table>
<p>Threat detection and monitoring</p>
<table><thead><tr><th>Tool</th><th>Path</th><th>Description</th></tr></thead><tbody><tr><td>YARA</td><td>/usr/local/bin/yara</td><td>Signature-based file scanning tool.</td></tr><tr><td>Sigma</td><td>/usr/local/bin/sigma</td><td>Generic signature format for SIEM rule creation.</td></tr><tr><td>Suricata</td><td>/usr/bin/suricata</td><td>Open-source IDS/IPS with network monitoring capabilities.</td></tr><tr><td>osquery</td><td>/usr/bin/osqueryi</td><td>Endpoint monitoring using SQL-like queries.</td></tr><tr><td>Zircolite</td><td>/root/zircolite/zircolite.py</td><td>Sigma-based EVTX log analysis.</td></tr><tr><td>Velociraptor</td><td>/usr/local/bin/velociraptor</td><td>Endpoint monitoring, collection, and response.</td></tr><tr><td>bpftrace</td><td>/usr/bin/bpftrace</td><td>High-level tracing language for Linux</td></tr></tbody></table>
<p>Traffic capturing: tcpdump / wireshark</p>
<p>Memory extractor: LiME: <code>/root/LiME/src/lime-5.15.0-71-generic.ko</code></p>
<p>Memory dump analysis: Volatility v2: <code>/root/volatility-master/vol.py</code></p>
<p>Adversary simulation: Atomic Read team: <code>/root/AtomicRedTeam</code>. Small and highly portable detection tests based on MITRE&#x27;s ATT&amp;CK.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="linux-logging">Linux logging<a href="#linux-logging" class="hash-link" aria-label="Direct link to Linux logging" title="Direct link to Linux logging">​</a></h2>
<p>Sysmon exists in Linux as well and you can see the output in syslog:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cat /var/log/syslog | /opt/sysmon/sysmonLogView</span><br></span></code></pre></div></div>
<p><code>audit</code> is a Linux daemon that collects, processes, and records audit log events to disk.</p>
<p>The logs are stored in <code>/var/log/audit/audit.log</code>. You can use <code>aureport</code> or <code>ausearch</code> to analyze them efficiently:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ausearch -k rootcmd -i</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="dumping-memory-in-linux">Dumping memory in Linux<a href="#dumping-memory-in-linux" class="hash-link" aria-label="Direct link to Dumping memory in Linux" title="Direct link to Dumping memory in Linux">​</a></h2>
<p>We&#x27;ll use LiME (Linux Memory Extractor) kernel module to dump memory:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo insmod lime-5.15.0-71-generic.ko &quot;path=/tmp/dump.mem format=lime&quot;</span><br></span></code></pre></div></div>
<p>To analyze the dump, one can use <code>Volatily v2</code>. In this example, we are interested in knowing which active tasks are in the memory dump:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">python2.7 vol.py -f /tmp/dump.mem --profile=LinuxUbuntu_5_15_0-71-generic_profilex64 linux_pslist</span><br></span></code></pre></div></div>
<ul>
<li><code>--profile=LinuxUbuntu_5_15_0-71-generic_profilex64</code> specifies the memory format</li>
<li><code>linux_pslist</code> is a volatility plugin to retrieve the list of processes in the particular dump.</li>
</ul></div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/Hacking/HTB Academy/Introduction to Hardware attacks"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Introduction to hardware attacks</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/Hacking/HTB Academy/Javascript deobfuscation"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Javascript deobfuscation</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#windows-tooling" class="table-of-contents__link toc-highlight">Windows tooling</a></li><li><a href="#windows-logging" class="table-of-contents__link toc-highlight">Windows logging</a></li><li><a href="#dumping-and-analyzing-windows-memory" class="table-of-contents__link toc-highlight">Dumping and analyzing Windows Memory</a></li><li><a href="#linux-toolings" class="table-of-contents__link toc-highlight">Linux toolings</a></li><li><a href="#linux-logging" class="table-of-contents__link toc-highlight">Linux logging</a></li><li><a href="#dumping-memory-in-linux" class="table-of-contents__link toc-highlight">Dumping memory in Linux</a></li></ul></div></div></div></div></main></div></div></div></div>
</body>
</html>