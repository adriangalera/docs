<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-Hacking/HTB Academy/Android Fundamentals" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">Android Fundamentals | agalera.eu</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://www.agalera.eu/docs/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://www.agalera.eu/docs/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://www.agalera.eu/docs/Hacking/HTB Academy/Android Fundamentals"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Android Fundamentals | agalera.eu"><meta data-rh="true" name="description" content="Android is a mobile operating system created for touchscreen devices like phones and tablets. Based on a modified version of the Linux Kernel."><meta data-rh="true" property="og:description" content="Android is a mobile operating system created for touchscreen devices like phones and tablets. Based on a modified version of the Linux Kernel."><link data-rh="true" rel="canonical" href="https://www.agalera.eu/docs/Hacking/HTB Academy/Android Fundamentals"><link data-rh="true" rel="alternate" href="https://www.agalera.eu/docs/Hacking/HTB Academy/Android Fundamentals" hreflang="en"><link data-rh="true" rel="alternate" href="https://www.agalera.eu/docs/Hacking/HTB Academy/Android Fundamentals" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Android Fundamentals","item":"https://www.agalera.eu/docs/Hacking/HTB Academy/Android Fundamentals"}]}</script><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-S8VGYBN25C"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-S8VGYBN25C",{anonymize_ip:!0})</script><link rel="stylesheet" href="/docs/assets/css/styles.f96ca0f1.css">
<script src="/docs/assets/js/runtime~main.3cd40d96.js" defer="defer"></script>
<script src="/docs/assets/js/main.4c217ef9.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><a class="navbar__brand" href="/docs/"><div class="navbar__logo"><img src="/docs/img/logo.svg" alt="agalera.eu" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/docs/img/logo.svg" alt="agalera.eu" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">agalera.eu</b></a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input id="search_input_react" type="search" placeholder="Loading..." aria-label="Search" class="navbar__search-input search-bar" disabled=""></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/flight-sim/dcs/f5e">Flight Simulators</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/docs/Hacking/HTB Academy/Android Fundamentals">Hacking</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/docs/Hacking/HTB Academy/Android Fundamentals">HTB Academy</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/Hacking/HTB Academy/Android Fundamentals">Android Fundamentals</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Hacking/HTB Academy/File inclusion">File inclusion</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Hacking/HTB Academy/File transfers">File transfer</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Hacking/HTB Academy/Introduction to Active Directory">Introduction to Active Directory</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Hacking/HTB Academy/Introduction to Hardware attacks">Introduction to hardware attacks</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Hacking/HTB Academy/Introduction to Purple team">Introduction to Purple team</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Hacking/HTB Academy/Javascript deobfuscation">Javascript deobfuscation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Hacking/HTB Academy/Linux fundamentals">Linux fundamentals</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Hacking/HTB Academy/Pentest In a Nutshell">Pentest in a nutshell</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Hacking/HTB Academy/SQL injections">SQL injections</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Hacking/HTB Academy/Web fuzzing">Web fuzzing</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Hacking/HTB Academy/Windows fundamentals">Windows fundamentals</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Hacking/HTB Academy/ffuf">Fuzzing with ffuf</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/languages/bash">Language security</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/playbooks/active-directory">Playbooks</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/tooling/crackmapexec">Tooling</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/useful-links">Useful links</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/write-up/htb/challenges/critical-ops">Write-ups</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/linux-useful-commands">Linux</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/Shortcuts/Chrome">Shortcuts</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/">Welcome</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/docs/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Hacking</span></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">HTB Academy</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Android Fundamentals</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Android Fundamentals</h1></header>
<p>Android is a mobile operating system created for touchscreen devices like phones and tablets. Based on a modified version of the Linux Kernel.</p>
<p>As we mentioned in the previous section, Android is a Linux-Based OS, and once someone gains access to a shell on the device, Linux commands can be executed.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="software-stack">Software stack<a href="#software-stack" class="hash-link" aria-label="Direct link to Software stack" title="Direct link to Software stack">​</a></h2>
<p>From lower level to higher level:</p>
<ol>
<li>
<p>Linux kernel: managing device hardware such as the display, camera, bluetooth, wifi, audio, USB, and more. Threading and memory management. Also numerous security features (user-based permissions and process isolation).</p>
</li>
<li>
<p>Hardware Abstraction Layer (HAL): standardized interface for interacting with hardware components, such as cameras, Bluetooth, sensors, and input devices. Acting as a bridge between hardware and the higher-level software layers, HAL ensures consistency in how software accesses hardware features. Given the different amount of hardware sensors, software needs to find a common interface to interact with the hardware.</p>
</li>
<li>
<p>Android Runtime: Android Runtime (ART) is the managed runtime environment used by the Android operating system to execute applications. Application code is compiled into native machine code at install time. This is like the JVM but for Android, e.g: performs garbage collection, memory management, etc..</p>
</li>
<li>
<p>Native C/C++ libraries: Developers generally use these libraries to achieve high performance or write low-level code to interact directly with the hardware.</p>
</li>
<li>
<p>Java API Framework: This component provides software tools and interfaces for building Android applications.</p>
</li>
<li>
<p>System apps: This component includes all the pre-installed applications that come with the Android operating system.</p>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="rooting">Rooting<a href="#rooting" class="hash-link" aria-label="Direct link to Rooting" title="Direct link to Rooting">​</a></h2>
<p>Android separates the flash storage into the following two main partitions : <code>/system</code> and <code>/data</code>. The partition <code>/system/</code> is used by the operating system, and the partition <code>/data/</code> is used for user data and application installations.</p>
<p>In Android, users don&#x27;t have root access to the operating system, and some partitions (like /system/) are read-only.</p>
<p>In order to have full <code>root</code> access to the device, you need to exploit some security flaws, this process is called <code>Rooting</code>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="import-directories">Import directories<a href="#import-directories" class="hash-link" aria-label="Direct link to Import directories" title="Direct link to Import directories">​</a></h2>
<table><thead><tr><th>Directory</th><th>Description</th></tr></thead><tbody><tr><td>/data/data</td><td>Contains all the applications that are installed by the user</td></tr><tr><td>/data/user/0</td><td>Contains data that only the app can access</td></tr><tr><td>/data/app</td><td>Contains the APKs of the applications that are installed by the user</td></tr><tr><td>/system/app</td><td>Contains the pre-installed applications of the device</td></tr><tr><td>/system/bin</td><td>Contains binary files</td></tr><tr><td>/data/local/tmp</td><td>A world-writable directory</td></tr><tr><td>/data/system</td><td>Contains system configuration files</td></tr><tr><td>/etc/apns-conf.xml</td><td>Contains the default Access Point Name (APN) configurations. APN is used in order for the device to connect with the carrier</td></tr><tr><td>/data/misc/wifi</td><td>Contains WiFi configuration files</td></tr><tr><td>/data/misc/user/0/cacerts-added</td><td>User certificate store. It contains certificates added by the user</td></tr><tr><td>/etc/security/cacerts/</td><td>System certificate store. Permission to non-root users is not permitted</td></tr><tr><td>/sdcard</td><td>Contains a symbolic link to the directories DCIM, Downloads, Music, Pictures, etc.</td></tr></tbody></table>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="android-security">Android Security<a href="#android-security" class="hash-link" aria-label="Direct link to Android Security" title="Direct link to Android Security">​</a></h2>
<p>Kotlin and Java are the two primary languages used to develop Android applications. The Android SDK tools compile application source code along with resource files and assets into an Android Package (APK). An APK is an archive file with a .apk extension that contains all the components needed to install and run an Android app, including compiled bytecode (.dex), manifest metadata, resources, and native libraries.</p>
<p>Each Android application runs within its own isolated security sandbox, enforced by the underlying Linux-based architecture. This sandboxing model is supported by several core Android security features:</p>
<ul>
<li>
<p>Android is a multi-user Linux system where each application is treated as a separate user.</p>
</li>
<li>
<p>By default, the system assigns each app a unique Linux user ID (UID). This UID is used by the system for access control, but is not exposed to the app itself.</p>
</li>
<li>
<p>File system permissions ensure that only the app assigned a particular UID can access its own files.</p>
</li>
<li>
<p>Each app runs in its own process, and each process runs in a separate instance of the Android Runtime (ART) virtual machine, ensuring memory isolation.</p>
</li>
<li>
<p>The system launches the app&#x27;s process as needed and terminates it when no longer required or when reclaiming system resources.</p>
</li>
<li>
<p>Android enforces the principle of least privilege, meaning apps only receive the permissions necessary to perform their core functionality. Additional privileges must be explicitly declared in the app&#x27;s manifest and approved by the user (or system, depending on the API level).</p>
</li>
</ul>
<p>Android uses Linux’s user-based security model to isolate applications by assigning each app a unique user ID (UID) and running it in its own process. This creates a kernel-level application sandbox that enforces strict boundaries between apps and the system, preventing unauthorized data access or code execution across app boundaries.</p>
<p>Escaping this sandbox requires compromising the kernel itself, typically through a privilege escalation exploit.</p>
<p>We can see this, when we list the files:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root:/# ls -l /data/data/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">drwx------  4 system         system         4096 2022-12-28 11:47 android</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">drwx------  4 bluetooth      bluetooth      4096 2022-12-28 11:47 com.android.bluetooth</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">drwx------  5 radio          radio          4096 2022-12-28 11:48 com.android.ons</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">drwx------  5 shell          shell          4096 2022-12-28 11:49 com.android.shell</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">drwx------ 11 u0_a114        u0_a114        4096 2022-12-30 12:41 com.android.chrome</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">drwx------  5 u0_a119        u0_a119        4096 2022-12-28 11:49 com.android.camera2</span><br></span></code></pre></div></div>
<p>To install an application on a device or upload it to the Play Store, the APK file must be signed. Signing the APK is crucial for security, as it protects the package from malicious modifications.</p>
<p>The certificates that are used to sign an application are self-signed. One can sign an APK file with apksigner tool (Signature Scheme v4) using the following commands:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">echo -e &quot;password\npassword\njohn doe\ntest\ntest\ntest\ntest\ntest\nyes&quot; &gt; params.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cat params.txt | keytool -genkey -keystore key.keystore -validity 1000 -keyalg RSA -alias john</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">zipalign -p -f -v 4 myapp.apk myapp_signed.apk</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo password | apksigner sign --ks key.keystore myapp_signed.apk</span><br></span></code></pre></div></div>
<p>Verified Boot is an Android security feature that ensures the integrity of the operating system. This is achieved using a unique set of cryptographic keys to sign and verify the boot image and ensure that only the authorized parties can modify the system</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="apk-structure">APK Structure<a href="#apk-structure" class="hash-link" aria-label="Direct link to APK Structure" title="Direct link to APK Structure">​</a></h2>
<p>The Android Package Kit file—commonly known as an APK—is the file format used by the Android operating system to distribute and install applications. An APK is essentially an archive that contains all the components needed for an Android app to run. It is based on <code>zip</code>, therefore it can be unzipped:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">adriangalera@htb[/htb]$ unzip myapp.apk</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">adriangalera@htb[/htb]$ ls -l</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">total 27584</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-rw-r--r--    1 bertolis  bertolis     4220 Jan  1  1981 AndroidManifest.xml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">drwxr-xr-x   49 bertolis  bertolis     1568 May 10 13:36 META-INF</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">drwxr-xr-x    3 bertolis  bertolis       96 May 10 13:36 assets</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-rw-r--r--    1 bertolis  bertolis  8285624 Jan  1  1981 classes.dex # contains the application code</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">drwxr-xr-x    9 bertolis  bertolis      288 May 10 13:36 kotlin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">drwxr-xr-x    6 bertolis  bertolis      192 May 10 13:36 lib</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">drwxr-xr-x  545 bertolis  bertolis    17440 May 10 13:36 res</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-rw-r--r--    1 bertolis  bertolis   922940 Jan  1  1981 resources.arsc</span><br></span></code></pre></div></div>
<p>The files extracted from the APK are encoded, and neither the source code nor the configuration files are human-readable.</p>
<p>Let&#x27;s deep dive:</p>
<ul>
<li>META-INF: contains verification information</li>
<li>assets: This folder contains assets that developers bundle with the application, and can be retrieved by the AssetManager.</li>
<li>lib: This folder contains native libraries with compiled code targeting different device architectures. Android applications that use the Native Development Kit (NDK) may include components written in C or C++.</li>
<li>res: This folder contains predefined application resources that cannot be modified by the user at runtime, unlike assets. These resources include XML files defining color state lists, UI layouts, fonts, values, configurations for OS versions, screen orientations, network settings, and more.</li>
<li>AndroidManifest.xml: metadata about the application.</li>
<li>classes.dex: This file contains all compiled Java (or Kotlin) classes in DEX (Dalvik Executable) format, which are executed by the Android Runtime (ART).</li>
<li>resources.arsc: This file contains precompiled resources that are used by the app at runtime. It maps resource identifiers in the code (e.g., R.string.app_name) to their actual values, such as strings, colors, layouts, and styles.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="types-of-application">Types of application<a href="#types-of-application" class="hash-link" aria-label="Direct link to Types of application" title="Direct link to Types of application">​</a></h2>
<ul>
<li>Native: direct access to platform. Built with Kotlin or Java.</li>
<li>Web apps: developed to be responsive and accessible from mobile web browsers. They are typically built using HTML, CSS, and JavaScript.</li>
<li>Hybrid apps: Hybrid apps combine elements of both native and web apps and are designed to be cross-platform. They use WebViews to display web content within a native app container.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="android-application-components-and-ipc">Android Application Components and IPC<a href="#android-application-components-and-ipc" class="hash-link" aria-label="Direct link to Android Application Components and IPC" title="Direct link to Android Application Components and IPC">​</a></h2>
<p>Application components are the building blocks that define different parts of an Android application, such as the user interface and core functionality. These components are declared in the AndroidManifest.xml and can be used individually or in tandem with one another. Interprocess Communication (IPC) is a mechanism that allows for communication between applications or different processes within the same application.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="activities">Activities<a href="#activities" class="hash-link" aria-label="Direct link to Activities" title="Direct link to Activities">​</a></h3>
<p>Activities are a fundamental application component, representing a single screen with a user interface. An Activity is the main component that allows the interaction between the user and the app, and can be started by other Activities, apps, or system events.</p>
<p>The Android operating system maintains an Activity stack as part of the task that the app belongs to. When a new Activity is launched, it&#x27;s placed on top of the stack and becomes the active Activity. The previous Activity is paused and remains in the stack.</p>
<p>Activities are declared in AndroidManifest.xml and can be exported so that other apps can use the activity.</p>
<blockquote>
<p>The exported attribute can be set on <code>&lt;activity&gt;, &lt;service&gt;, &lt;receiver&gt;, and &lt;provider&gt;</code> elements in the AndroidManifest.xml file.</p>
</blockquote>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="services">Services<a href="#services" class="hash-link" aria-label="Direct link to Services" title="Direct link to Services">​</a></h3>
<p>A Service is an Android application component that performs long-running operations in the background without providing a user interface. Services can be used for tasks like downloading files, playing music, or communicating with a remote server, and can continue working even after the user has left the app.</p>
<p>There are:</p>
<ul>
<li>
<p>Foreground services: Foreground services perform operations that require user attention. Will generate notifications, e.g: media players or navigation apps.</p>
</li>
<li>
<p>Background services: perform operations that do not require user interaction.</p>
</li>
<li>
<p>Bound services: They provide a client-server interface that enables components—even across different processes—to interact with the service using Interprocess Communication (IPC).</p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="broadcast-receivers">Broadcast receivers<a href="#broadcast-receivers" class="hash-link" aria-label="Direct link to Broadcast receivers" title="Direct link to Broadcast receivers">​</a></h3>
<p>Broadcast Receivers can be considered as both Application Components and Interprocess Communication (IPC) mechanisms.</p>
<p>As an IPC mechanism, Broadcast Receivers enable communication between different applications by sending and receiving Intents. These Intents can be sent by the Android system, other apps, or the app itself.</p>
<p>As an Application Component, Broadcast Receivers are designed to respond to system-wide or custom events broadcasted by other applications.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="content-providers">Content Providers<a href="#content-providers" class="hash-link" aria-label="Direct link to Content Providers" title="Direct link to Content Providers">​</a></h3>
<p>As an IPC mechanism, Content Providers enable communication between applications by allowing them to access, modify, or delete data using a consistent interface through the ContentResolver class.</p>
<p>As an application component, Content Providers are responsible for managing and exposing data structures within or to other apps.</p>
<p>They allow data sharing inside or outside the application.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="intents">Intents<a href="#intents" class="hash-link" aria-label="Direct link to Intents" title="Direct link to Intents">​</a></h3>
<p>Messaging objects used by applications or the Android system to request actions from other components such as Activities, Services, and Broadcast receivers. While Intents are not primarily designed for Interprocess Communication (IPC), they may be used when an application wants to interact with a component (such as a service) that resides in a different process.</p>
<p>Typical use cases are:</p>
<ol>
<li>Starting an activity:</li>
</ol>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token class-name">Intent</span><span class="token plain"> intent </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Intent</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">ContactDetailActivity</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">class</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">intent</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">putExtra</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;contact_id&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> selectedContactId</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">startActivity</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">intent</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<ol start="2">
<li>Starting a service:</li>
</ol>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token class-name">Intent</span><span class="token plain"> intent </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Intent</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">DownloadService</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">class</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">intent</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">putExtra</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;file_url&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> fileUrl</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">startService</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">intent</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<ol start="3">
<li>Deliver a broadcast message:</li>
</ol>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token class-name">Intent</span><span class="token plain"> intent </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Intent</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;com.example.ACTION_BATTERY_LOW&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">sendBroadcast</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">intent</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<p>We can define <code>explicit</code> intents such as:</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token class-name">Intent</span><span class="token plain"> intent </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Intent</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">TargetActivity</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">class</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">startActivity</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">intent</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><br></span></code></pre></div></div>
<p>which is used to navigate inside the app. The class has to be known.</p>
<p>or <code>implicit</code> intents, where we don&#x27;t know exactly the class but we rely on the system to find a suitable actor to perform an action:</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token class-name">Intent</span><span class="token plain"> intent </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Intent</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">Intent</span><span class="token punctuation" style="color:#393A34">.</span><span class="token constant" style="color:#36acaa">ACTION_VIEW</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">intent</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">setData</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">Uri</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">parse</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;https://www.example.com&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">startActivity</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">intent</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<p>Intents can have data using the <code>putExtra</code> method:</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token class-name">Intent</span><span class="token plain"> intent </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Intent</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">TargetActivity</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">class</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">intent</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">putExtra</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;key&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;value&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">startActivity</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">intent</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="binders">Binders<a href="#binders" class="hash-link" aria-label="Direct link to Binders" title="Direct link to Binders">​</a></h3>
<p>The Binder is Android&#x27;s core Interprocess Communication (IPC) mechanism, enabling efficient and secure communication between different processes.</p>
<p>It allows a client process to invoke methods on a remote object located in another process (but owned by the same application) as if the object were local.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="deep-links">Deep links<a href="#deep-links" class="hash-link" aria-label="Direct link to Deep links" title="Direct link to Deep links">​</a></h3>
<p>A Deep Link is an Interprocess Communication (IPC) mechanism that allows users to navigate directly to specific content within an app.</p>
<p>For example, a user might receive a promotional email about a flash sale on a specific product. Instead of directing the user to the website, the link opens the corresponding app to display the product.</p>
<p>There are standard deep links:</p>
<div class="language-html codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-html codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	</span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">p</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">Buy our latest PC parts.</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">p</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	</span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">a</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">href</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">app://myapp/products/cpu</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">a</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre></div></div>
<p>If we declare an this intent-filter:</p>
<div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">data</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name namespace" style="color:#00a4db;opacity:0.7">android:</span><span class="token tag attr-name" style="color:#00a4db">scheme</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">app</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"></span><br></span><span class="token-line" style="color:#393A34"><span class="token tag" style="color:#00009f">              </span><span class="token tag attr-name namespace" style="color:#00a4db;opacity:0.7">android:</span><span class="token tag attr-name" style="color:#00a4db">host</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">myapp</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"></span><br></span><span class="token-line" style="color:#393A34"><span class="token tag" style="color:#00009f">              </span><span class="token tag attr-name namespace" style="color:#00a4db;opacity:0.7">android:</span><span class="token tag attr-name" style="color:#00a4db">pathPrefix</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">/products/</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><br></span></code></pre></div></div>
<p>When the user clicks on the link, the specific product will appear in the application.</p>
<p>Security risks may arise from improper implementation.</p>
<p>The other type of deep links are Android deeplinks. Let&#x27;s imagine this example:</p>
<div class="language-html codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-html codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	</span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">p</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">Buy our latest PC parts.</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">p</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	</span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">a</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">href</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">https://www.myapp.com/products/cpu</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">a</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre></div></div>
<p>we can define this intent-filter to capture it:</p>
<div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">data</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name namespace" style="color:#00a4db;opacity:0.7">android:</span><span class="token tag attr-name" style="color:#00a4db">scheme</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">https</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"></span><br></span><span class="token-line" style="color:#393A34"><span class="token tag" style="color:#00009f">              </span><span class="token tag attr-name namespace" style="color:#00a4db;opacity:0.7">android:</span><span class="token tag attr-name" style="color:#00a4db">host</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">www.myapp.com</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"></span><br></span><span class="token-line" style="color:#393A34"><span class="token tag" style="color:#00009f">              </span><span class="token tag attr-name namespace" style="color:#00a4db;opacity:0.7">android:</span><span class="token tag attr-name" style="color:#00a4db">pathPrefix</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">/products/</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><br></span></code></pre></div></div>
<p>If the app that handles the deep link isn&#x27;t installed, the link will open in a web browser listing the products.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="android-debug-bride">Android Debug Bride<a href="#android-debug-bride" class="hash-link" aria-label="Direct link to Android Debug Bride" title="Direct link to Android Debug Bride">​</a></h3>
<p>Android Debug Bridge (ADB) is a versatile command-line tool that enables communication between a computer and a device. It allows developers to perform tasks like installing and debugging applications, transferring files between the host computer and the device, and accessing the device through a shell.</p>
<p>Here, there are some useful adb commands:</p>
<table><thead><tr><th>Command</th><th>Description</th></tr></thead><tbody><tr><td><code>adb help</code></td><td>List all commands.</td></tr><tr><td><code>adb kill-server</code></td><td>Kills the adb server.</td></tr><tr><td><code>adb devices</code></td><td>Lists connected devices.</td></tr><tr><td><code>adb root</code></td><td>Restarts adbd with root permissions.</td></tr><tr><td><code>adb install &lt;apk&gt;</code></td><td>Install app.</td></tr><tr><td><code>adb push &lt;local&gt; &lt;remote&gt;</code></td><td>Copy file/dir to device.</td></tr><tr><td><code>adb pull &lt;remote&gt; &lt;local&gt;</code></td><td>Copy file/dir from device.</td></tr><tr><td><code>adb logcat [options] [filter] [filter]</code></td><td>View device log.</td></tr><tr><td><code>adb shell</code></td><td>Opens a shell in the device.</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="android-penetration-testing">Android penetration testing<a href="#android-penetration-testing" class="hash-link" aria-label="Direct link to Android penetration testing" title="Direct link to Android penetration testing">​</a></h3>
<ul>
<li>Enumeration and information gathering</li>
</ul>
<p>Gather information about the app and its architecture.
Understand the functionality of the application.
Enumerate any data structure the app uses that is stored in the local storage.</p>
<ul>
<li>Static analysis</li>
</ul>
<p>Understand the manifest file of the application. Review the app&#x27;s components, permissions, and configurations.
Decompile and analyze the application&#x27;s source code to understand the flow and find potential vulnerabilities.
Examine native or third-party libraries, frameworks, and dependencies the app uses.</p>
<ul>
<li>Dynamic analysis</li>
</ul>
<p>Monitor the application&#x27;s behavior during runtime. Enumerate the local storage for files and data structures created after performing various functionalities.
Perform dynamic instrumentation to read the memory of the application during runtime.
Intercept network traffic and test the app for vulnerabilities such as authentication bypass and insecure data transmission.
Check for Server-Side attacks by analyzing API calls and looking for vulnerabilities such as injection and XSS attacks.</p>
<p>Suggested tools:</p>
<ul>
<li><code>adb</code>: command-line tool to communicate with Android devices.</li>
<li><code>JADX</code>: This tool allows us to reverse engineer an application and view its source code through a graphical interface. It provides the user with a Java-like pseudocode that is close enough to the actual code.</li>
<li><code>APKTool</code>: This tool also allows reverse engineering Android applications. It will decompile the source code and decode the resources of the APK file. APKTool also enables us to edit the source code and configuration files, recompile the code, and build the APK file again.</li>
<li><code>Ghidra</code>: Ghidra is often used to analyze the native C++ libraries loaded to the application.</li>
<li><code>Burp Suite</code>: to analyze HTTP communication</li>
<li><code>Frida</code>: A dynamic instrumentation toolkit used by developers, reverse engineers, and security researchers. It enables us to inject snippets of JavaScript or native code into the running processes of Android applications, allowing us to analyze and manipulate them during runtime.</li>
<li><code>Autopsy</code>: Autopsy will help us investigate disk images of Android devices and let us search for files, databases, calls, messages, and logs, using the provided GUI.</li>
</ul>
<p>There&#x27;s also some automated tools:</p>
<ul>
<li><code>MobSF</code>: An automated security testing framework for Android, iOS, and Windows platforms that performs static, dynamic, and malware analysis on mobile applications.</li>
<li><code>Drozer</code>: A comprehensive security and attack framework that allows us to assess the security of Android applications. It simulates various attack vectors and provides multiple tools to analyze, exploit, and debug Android applications.</li>
<li><code>Qark</code>: A static code analysis tool that automates the discovery of security vulnerabilities in Android applications. It can also create Proof-of-Concept deployable APKs and ADB commands to exploit the vulnerabilities it finds.</li>
<li><code>Objection</code>: A runtime mobile exploration toolkit that uses Frida to provide an easy environment for assessing Android and iOS application security. It automates several common tasks, such as bypassing SSL pinning, and users won&#x27;t be needed to create custom scripts whenever they need to exploit common vulnerabilities.</li>
<li><code>Medusa</code>: An extensible and modularized framework that automates processes and techniques practiced during the dynamic analysis of Android Applications. Medusa is based on Frida and can analyze and enumerate an app, attack common entry points, and automate processes like application patching, MITM attack, and more. Medusa can add and remove hooks for Java or Native methods and has more than 90 modules that can be combined.</li>
<li><code>Androbugs</code>: automatically scans Android applications and checks for security issues and vulnerabilities.</li>
</ul></div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/flight-sim/dcs/su25t"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Reference</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/Hacking/HTB Academy/File inclusion"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">File inclusion</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#software-stack" class="table-of-contents__link toc-highlight">Software stack</a></li><li><a href="#rooting" class="table-of-contents__link toc-highlight">Rooting</a></li><li><a href="#import-directories" class="table-of-contents__link toc-highlight">Import directories</a></li><li><a href="#android-security" class="table-of-contents__link toc-highlight">Android Security</a></li><li><a href="#apk-structure" class="table-of-contents__link toc-highlight">APK Structure</a></li><li><a href="#types-of-application" class="table-of-contents__link toc-highlight">Types of application</a></li><li><a href="#android-application-components-and-ipc" class="table-of-contents__link toc-highlight">Android Application Components and IPC</a><ul><li><a href="#activities" class="table-of-contents__link toc-highlight">Activities</a></li><li><a href="#services" class="table-of-contents__link toc-highlight">Services</a></li><li><a href="#broadcast-receivers" class="table-of-contents__link toc-highlight">Broadcast receivers</a></li><li><a href="#content-providers" class="table-of-contents__link toc-highlight">Content Providers</a></li><li><a href="#intents" class="table-of-contents__link toc-highlight">Intents</a></li><li><a href="#binders" class="table-of-contents__link toc-highlight">Binders</a></li><li><a href="#deep-links" class="table-of-contents__link toc-highlight">Deep links</a></li><li><a href="#android-debug-bride" class="table-of-contents__link toc-highlight">Android Debug Bride</a></li><li><a href="#android-penetration-testing" class="table-of-contents__link toc-highlight">Android penetration testing</a></li></ul></li></ul></div></div></div></div></main></div></div></div></div>
</body>
</html>